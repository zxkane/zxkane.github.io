<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Posts on The Road</title><link>https://kane.mx/posts/</link><description>Recent content in Posts on The Road</description><meta name="generator" content="Hugo 0.78.1"/><language>en-us</language><lastBuildDate>Wed, 16 Dec 2020 00:00:00 +0000</lastBuildDate><atom:link href="https://kane.mx/posts/index.xml" rel="self" type="application/rss+xml"/><item><title>Effective AWS CDK for AWS CloudFormation</title><link>https://kane.mx/posts/2020/effective-aws-cdk-for-aws-cloudformation/</link><pubDate>Wed, 16 Dec 2020 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2020/effective-aws-cdk-for-aws-cloudformation/</guid><description>&lt;p>&lt;a href="https://en.wikipedia.org/wiki/Infrastructure_as_code">Infrastructure as Code&lt;/a> is the trend to manage the resources of application. &lt;a href="https://aws.amazon.com/cloudformation/">AWS CloudFormation&lt;/a> is the managed serive offering the IaC capability on AWS &lt;a href="https://aws.amazon.com/blogs/aws/cloudformation-create-your-aws-stack-from-a-recipe/">since 2011&lt;/a>. CloudFormation uses the &lt;a href="https://en.wikipedia.org/wiki/Declarative_programming">declarative language&lt;/a> to manage your AWS resources with the style what you declare what you get.&lt;/p>
&lt;p>However there are cons of CloudFormation as a declarative language,&lt;/p>
&lt;ul>
&lt;li>the readability and maintanence for applications involving lots of resources&lt;/li>
&lt;li>the reuseable of code, &lt;a href="https://aws.amazon.com/blogs/mt/introducing-aws-cloudformation-modules/">CloudFormation modules&lt;/a> released in re:Invent 2020 might help mitgate it&lt;/li>
&lt;/ul>
&lt;p>&lt;a href="https://kane.mx/posts/2019/aws-cdk/">AWS CDK&lt;/a> provides the programming way to define the infra in code by your preferred programming languages, such as Typescript, Javascripte, Python, Java and C#. AWS CDK will synthesis the code to CloudFormation template, then deploying the stack via AWS CloudForamtion service. It benefits the Devops engineers manage the infra on AWS as programming application, having version control, code review, unit testing, integration testing and CI/CD pipelines, the deployment still depends on the mature CloudFormation service to rolling update the resources and rollback when failing.&lt;/p>
&lt;p>For solution development, using CDK indeed improves the productivity then publish the deployment assets as CloudFormation templates.&lt;/p>
&lt;p>Though CDK application can be synthesized to CloudFormation template, there are still some differences blocking the synthesized tempaltes to be deployed across multiple AWS regeions.&lt;/p>
&lt;p>This post will share the tips on how effectively writing AWS CDK application then deploying the application by CloudFormation across multiple regions.&lt;/p>
&lt;h2 id="general">General&lt;/h2>
&lt;h3 id="environment-agnostic-stack">Environment-agnostic stack&lt;/h3>
&lt;p>Donâ€™t specify env with &lt;code>account&lt;/code> and &lt;code>region&lt;/code> like below that will generate account/region hardcode in CloudFormation template.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-ts" data-lang="ts">&lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">MyStack&lt;/span>(&lt;span style="color:#a6e22e">app&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;Stack1&amp;#39;&lt;/span>, {
&lt;span style="color:#a6e22e">env&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;span style="color:#a6e22e">account&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;123456789012&amp;#39;&lt;/span>,
&lt;span style="color:#a6e22e">region&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;us-east-1&amp;#39;&lt;/span>
},
});
&lt;/code>&lt;/pre>&lt;/div>
&lt;h3 id="use-cfnmappingcfncondition-instead-of-if-else-clause">use CfnMapping/CfnCondition instead of if-else clause&lt;/h3>
&lt;p>CloudFormation does not have logistic processing like programming language. Use &lt;code>CfnMapping&lt;/code> or &lt;code>CfnCondition&lt;/code> instead.&lt;/p>
&lt;p>&lt;strong>Note&lt;/strong>: the &lt;code>CfnMapping&lt;/code> does not support default value, you have to list all supported regions like below code snippet,&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-ts" data-lang="ts">&lt;span style="color:#a6e22e">getAwsLoadBalancerControllerRepo() {&lt;/span>
&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">albImageMapping&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">cdk&lt;/span>.&lt;span style="color:#a6e22e">CfnMapping&lt;/span>(&lt;span style="color:#66d9ef">this&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;ALBImageMapping&amp;#39;&lt;/span>, {
&lt;span style="color:#a6e22e">mapping&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;span style="color:#e6db74">&amp;#39;me-south-1&amp;#39;&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;558608220178&amp;#39;&lt;/span>,
},
&lt;span style="color:#e6db74">&amp;#39;eu-south-1&amp;#39;&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;590381155156&amp;#39;&lt;/span>,
},
&lt;span style="color:#e6db74">&amp;#39;ap-northeast-1&amp;#39;&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;602401143452&amp;#39;&lt;/span>,
},
&lt;span style="color:#e6db74">&amp;#39;ap-northeast-2&amp;#39;&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;602401143452&amp;#39;&lt;/span>,
},
...
&lt;span style="color:#e6db74">&amp;#39;ap-east-1&amp;#39;&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;800184023465&amp;#39;&lt;/span>,
},
&lt;span style="color:#e6db74">&amp;#39;af-south-1&amp;#39;&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;877085696533&amp;#39;&lt;/span>,
},
&lt;span style="color:#e6db74">&amp;#39;cn-north-1&amp;#39;&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;918309763551&amp;#39;&lt;/span>,
},
&lt;span style="color:#e6db74">&amp;#39;cn-northwest-1&amp;#39;&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;961992271922&amp;#39;&lt;/span>,
},
}
});
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">albImageMapping&lt;/span>.&lt;span style="color:#a6e22e">findInMap&lt;/span>(&lt;span style="color:#a6e22e">cdk&lt;/span>.&lt;span style="color:#a6e22e">Aws&lt;/span>.&lt;span style="color:#a6e22e">REGION&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;2&amp;#39;&lt;/span>)&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">.dkr.ecr.&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">cdk&lt;/span>.&lt;span style="color:#a6e22e">Aws&lt;/span>.&lt;span style="color:#a6e22e">REGION&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">.&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">cdk&lt;/span>.&lt;span style="color:#a6e22e">Aws&lt;/span>.&lt;span style="color:#a6e22e">URL_SUFFIX&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">/amazon/aws-load-balancer-controller`&lt;/span>;
}
&lt;/code>&lt;/pre>&lt;/div>
&lt;h2 id="never-use-stackregion">never use Stack.region&lt;/h2>
&lt;p>&lt;strong>Donâ€™t&lt;/strong> rely on &lt;code>stack.region&lt;/code> to do the logistic for China regions. Use additional &lt;code>context&lt;/code> parameter or &lt;code>CfnMapping&lt;/code> like below snippet,&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-ts" data-lang="ts">&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">partitionMapping&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">cdk&lt;/span>.&lt;span style="color:#a6e22e">CfnMapping&lt;/span>(&lt;span style="color:#66d9ef">this&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;PartitionMapping&amp;#39;&lt;/span>, {
&lt;span style="color:#a6e22e">mapping&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;span style="color:#a6e22e">aws&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;span style="color:#a6e22e">nexus&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;quay.io/travelaudience/docker-nexus&amp;#39;&lt;/span>,
&lt;span style="color:#a6e22e">nexusProxy&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;quay.io/travelaudience/docker-nexus-proxy&amp;#39;&lt;/span>,
},
&lt;span style="color:#e6db74">&amp;#39;aws-cn&amp;#39;&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;span style="color:#a6e22e">nexus&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;048912060910.dkr.ecr.cn-northwest-1.amazonaws.com.cn/quay/travelaudience/docker-nexus&amp;#39;&lt;/span>,
&lt;span style="color:#a6e22e">nexusProxy&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;048912060910.dkr.ecr.cn-northwest-1.amazonaws.com.cn/quay/travelaudience/docker-nexus-proxy&amp;#39;&lt;/span>,
},
}
});
&lt;span style="color:#a6e22e">partitionMapping&lt;/span>.&lt;span style="color:#a6e22e">findInMap&lt;/span>(&lt;span style="color:#a6e22e">cdk&lt;/span>.&lt;span style="color:#a6e22e">Aws&lt;/span>.&lt;span style="color:#a6e22e">PARTITION&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;nexus&amp;#39;&lt;/span>);
&lt;/code>&lt;/pre>&lt;/div>
&lt;p>Use &lt;strong>core.Aws.region&lt;/strong> token refered to the region which region of the stack is deployed.&lt;/p>
&lt;h3 id="explicitly-add-dependencies-on-resources-to-control-the-creationdeletion-order-of-resources">explicitly add dependencies on resources to control the creation/deletion order of resources&lt;/h3>
&lt;p>For example, when deploying a solution with creating a new VPC with NAT gateway, then deploying EMR cluster in private subnets of VPC. The EMR cluster might fail on creation due to network issue. Itâ€™s caused by the NAT gateway is not ready when initializing the EMR cluster, you have to manually create the dependencies among EMR cluster and NAT gateway.&lt;/p>
&lt;h2 id="eks-moduleaws-cdkaws-eks">EKS module(@aws-cdk/aws-eks)&lt;/h2>
&lt;h3 id="specify-kubectl-layer-when-creating-eks-cluster">specify kubectl layer when creating EKS cluster&lt;/h3>
&lt;p>EKS uses a lambda layer to run &lt;code>kubectl&lt;/code>/&lt;code>helm&lt;/code> cli as custom resource, the &lt;code>@aws-cdk/aws-eks&lt;/code> module depends on the &lt;code>Stack.region&lt;/code> to check the region to be deployed in synthesizing phase. It violates the principle of Environment-agnostic stack! Use below workaround to create the EKS cluster,&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-ts" data-lang="ts">&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">partitionMapping&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">cdk&lt;/span>.&lt;span style="color:#a6e22e">CfnMapping&lt;/span>(&lt;span style="color:#66d9ef">this&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;PartitionMapping&amp;#39;&lt;/span>, {
&lt;span style="color:#a6e22e">mapping&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;span style="color:#a6e22e">aws&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;span style="color:#75715e">// see https://github.com/aws/aws-cdk/blob/60c782fe173449ebf912f509de7db6df89985915/packages/%40aws-cdk/aws-eks/lib/kubectl-layer.ts#L6
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#a6e22e">kubectlLayerAppid&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;arn:aws:serverlessrepo:us-east-1:903779448426:applications/lambda-layer-kubectl&amp;#39;&lt;/span>,
},
&lt;span style="color:#e6db74">&amp;#39;aws-cn&amp;#39;&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;span style="color:#a6e22e">kubectlLayerAppid&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;arn:aws-cn:serverlessrepo:cn-north-1:487369736442:applications/lambda-layer-kubectl&amp;#39;&lt;/span>,
},
}
});
&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">kubectlLayer&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">eks&lt;/span>.&lt;span style="color:#a6e22e">KubectlLayer&lt;/span>(&lt;span style="color:#66d9ef">this&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;KubeLayer&amp;#39;&lt;/span>, {
&lt;span style="color:#a6e22e">applicationId&lt;/span>: &lt;span style="color:#66d9ef">partitionMapping.findInMap&lt;/span>(&lt;span style="color:#a6e22e">cdk&lt;/span>.&lt;span style="color:#a6e22e">Aws&lt;/span>.&lt;span style="color:#a6e22e">PARTITION&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;kubectlLayerAppid&amp;#39;&lt;/span>),
});
&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">cluster&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">eks&lt;/span>.&lt;span style="color:#a6e22e">Cluster&lt;/span>(&lt;span style="color:#66d9ef">this&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;MyK8SCluster&amp;#39;&lt;/span>, {
&lt;span style="color:#a6e22e">vpc&lt;/span>,
&lt;span style="color:#a6e22e">defaultCapacity&lt;/span>: &lt;span style="color:#66d9ef">0&lt;/span>,
&lt;span style="color:#a6e22e">kubectlEnabled&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;span style="color:#a6e22e">mastersRole&lt;/span>: &lt;span style="color:#66d9ef">clusterAdmin&lt;/span>,
&lt;span style="color:#a6e22e">version&lt;/span>: &lt;span style="color:#66d9ef">eks.KubernetesVersion.V1_16&lt;/span>,
&lt;span style="color:#a6e22e">coreDnsComputeType&lt;/span>: &lt;span style="color:#66d9ef">eks.CoreDnsComputeType.EC2&lt;/span>,
&lt;span style="color:#a6e22e">kubectlLayer&lt;/span>,
});
&lt;/code>&lt;/pre>&lt;/div>
&lt;p>If you&amp;rsquo;re interested on this issue, &lt;a href="https://github.com/aws/aws-cdk/issues/12018">see cdk issue for detail&lt;/a>.&lt;/p>
&lt;h3 id="manage-the-lifecycle-of-helm-chart-deployment">manage the lifecycle of helm chart deployment&lt;/h3>
&lt;p>The k8s helm chart might create AWS resources out of CloudFormation scope. You have to manage the lifecycle of those resources by yourself.&lt;/p>
&lt;p>For example, there is an EKS cluster with AWS load balancer controller, then you deploy a helm chart with ingress that will create ALB/NLB by the chart, you must clean those load balancers in deletion of the chart. Also the uninstallation of Helm chart is asynchronous, you have to watch the deletion of resource completing before continuing to clean other resources.&lt;/p>
&lt;h2 id="the-end">THE END&lt;/h2>
&lt;blockquote>
&lt;p>The tips will be updated when something new is found or the one is deprecated after CDK is updated.&lt;/p>
&lt;p>HAPPY CDK ğŸ˜†&lt;/p>
&lt;/blockquote></description></item><item><title>äºšé©¬é€Šçš„éƒ¨ç½²æœ€ä½³å®è·µ</title><link>https://kane.mx/posts/2020/the-best-practise-of-deployment-at-amazon/</link><pubDate>Sat, 28 Nov 2020 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2020/the-best-practise-of-deployment-at-amazon/</guid><description>&lt;p>è¿‘æœŸ&lt;a href="https://aws.amazon.com/builders-library/">Amazon Builders Library&lt;/a>å‘å¸ƒäº†æ•°ç¯‡æ–‡ç« ä»‹ç»äºšé©¬é€Šå¦‚ä½•å®è·µæŒç»­éƒ¨ç½²ï¼ŒåŒæ—¶åˆ†äº«äº†äºšé©¬é€Šåœ¨éƒ¨ç½²æ–¹é¢çš„æœ€ä½³å®è·µã€‚&lt;/p>
&lt;p>è¿™é‡Œå°†è¿™ä¸‰ç¯‡æ–‡ç« æ ¸å¿ƒå†…å®¹åšä¸ªæ¦‚è¿°ï¼Œæ–¹ä¾¿å¤§å®¶æŒ‰éœ€ç»†è¯»ã€‚&lt;/p>
&lt;h3 id="going-faster-with-continuous-deliverygoing-faster-with-cd">&lt;a href="https://aws.amazon.com/builders-library/going-faster-with-continuous-delivery/?did=ba_card&amp;amp;trk=ba_card">Going faster with continuous delivery&lt;/a>&lt;/h3>
&lt;p>è¿™ç¯‡æ–‡ç« å…ˆæ˜¯åˆ†äº«äº†äºšé©¬é€ŠæŒç»­æ”¹è¿›å’Œè½¯ä»¶è‡ªåŠ¨åŒ–çš„æ–‡åŒ–(Amazonianéšæ—¶éƒ½æƒ¦è®°ç€çš„&lt;a href="https://aws.amazon.com/careers/culture/">é¢†å¯¼åŠ›å‡†åˆ™&lt;/a>)ï¼Œç„¶åä»‹ç»äº†äºšé©¬é€Šå†…éƒ¨çš„æŒç»­éƒ¨ç½²å·¥å…·Pipelinesã€‚ä»ä¸€ä¸ªè¯•ç‚¹å·¥å…·è¿›åŒ–ä¸ºäºšé©¬é€Šæ ‡å‡†ã€ä¸€è‡´ä¸”ç®€æ´çš„å‘å¸ƒå·¥å…·ã€‚å¹¶ä¸”å°†æ„å»ºå’Œå‘å¸ƒè½¯ä»¶çš„æœ€ä½³å®è·µæ£€æŸ¥ä¹Ÿèå…¥åˆ°Pipelinesä¸­ã€‚&lt;/p>
&lt;p>æ¥ä¸‹æ¥æ˜¯åˆ†äº«å¦‚ä½•å‡å°æ•…éšœå½±å“åˆ°å®¢æˆ·çš„é£é™©ã€‚æœ‰è¿‡è½¯ä»¶å¼€å‘ç»éªŒçš„éƒ½çŸ¥é“ï¼Œè½¯ä»¶å˜æ›´å¼•å…¥æ•…éšœæ˜¯ä¸å¯é¿å…çš„ï¼Œå¦‚ä½•å°†æ•…éšœå¯¹å®¢æˆ·çš„å½±å“æ§åˆ¶åˆ°æœ€å°æ˜¯éå¸¸é‡è¦çš„ã€‚è¯¥æ–‡ä»ä¸‹é¢å‡ ä¸ªæ–¹é¢ç»™å‡ºäº†å»ºè®®ï¼Œ&lt;/p>
&lt;ul>
&lt;li>&lt;strong>éƒ¨ç½²å«ç”Ÿ&lt;/strong>ï¼Œå¦‚å¯¹æ–°éƒ¨ç½²ç¨‹åºçš„å¥åº·æ£€æŸ¥&lt;/li>
&lt;li>&lt;strong>ä¸Šç”Ÿäº§ç³»ç»Ÿä¹‹å‰çš„æµ‹è¯•&lt;/strong>ï¼Œè‡ªåŠ¨åŒ–å•å…ƒã€é›†æˆã€é¢„ç”Ÿäº§æµ‹è¯•&lt;/li>
&lt;li>&lt;strong>ç”Ÿäº§ç³»ç»Ÿä¸Šçš„éªŒè¯&lt;/strong>ï¼Œåˆ†æ‰¹çš„éƒ¨ç½²ï¼Œæ§åˆ¶æ•…éšœå½±å“åŠå¾„&lt;/li>
&lt;li>&lt;strong>æ§åˆ¶ä½•æ—¶å‘å¸ƒè½¯ä»¶&lt;/strong>&lt;/li>
&lt;/ul>
&lt;p>æœ€åä½œè€…ä»‹ç»äº†äºšé©¬é€Šå¦‚ä½•å¿«é€Ÿæ‰§è¡Œä¸šåŠ¡åˆ›æ–° &amp;ndash; é€šè¿‡&lt;strong>è‡ªåŠ¨åŒ–ä¸€åˆ‡äº‹æƒ…&lt;/strong>ã€‚&lt;/p>
&lt;h3 id="automating-safe-hands-off-deploymentsautomating-safe-hands-off-deployment">&lt;a href="https://aws.amazon.com/builders-library/automating-safe-hands-off-deployments/?did=ba_card&amp;amp;trk=ba_card">Automating safe, hands-off deployments&lt;/a>&lt;/h3>
&lt;p>è¿™ç¯‡æ–‡ç« å¾ˆå¥½çš„å‘¼åº”äº†&lt;a href="https://aws.amazon.com/builders-library/going-faster-with-continuous-delivery/?did=ba_card&amp;amp;trk=ba_card">Going faster with continuous delivery&lt;/a>ä¸€æ–‡ä¸­å¦‚ä½•é¿å…æ–°çš„éƒ¨ç½²å¯¼è‡´æ•…éšœå½±å“ï¼Œéå¸¸è¯¦ç»†çš„ä»‹ç»äº†äºšé©¬é€Šå…³äºè‡ªåŠ¨åŒ–å®‰å…¨éƒ¨ç½²çš„å®è·µã€‚&lt;/p>
&lt;p>å¯¹äºæŒç»­éƒ¨ç½²ï¼Œ&lt;code>æºç &lt;/code> -&amp;gt; &lt;code>æ„å»º&lt;/code> -&amp;gt; &lt;code>æµ‹è¯•&lt;/code> -&amp;gt; &lt;code>ç”Ÿäº§&lt;/code> è¿™ä¸ªæµç¨‹å¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰ã€‚&lt;/p>
&lt;figure>
&lt;img src="https://d1.awsstatic.com/builderslibrary/architecture-images/1-Four-Pipeline-Phases.b168244d38855d468e594d26f0a5fcc40892a5da.PNG"
alt="4 pipeline phases"/>
&lt;/figure>
&lt;p>ä»ä¸‹å›¾çœ‹ï¼Œäºšé©¬é€Šå¯¹äº&lt;code>æºç &lt;/code>å’Œ&lt;code>æ„å»º&lt;/code>çš„ç†è§£æ˜¯éå¸¸æ·±å…¥å’Œå…¨é¢çš„ã€‚&lt;/p>
&lt;figure>
&lt;img src="https://d1.awsstatic.com/builderslibrary/architecture-images/2-Source-and-Build-Phases.e873d57fa8365a34e6fdb6699b3541caef9a019c.PNG"
alt="source and build"/>
&lt;/figure>
&lt;p>&lt;code>æºç &lt;/code>å¹¶ä¸ä»…ä»…æ˜¯åº”ç”¨ç¨‹åºæºä»£ç ï¼Œè¿˜å¯ä»¥åŒ…æ‹¬è¿ç»´å·¥å…·ä»£ç ã€æµ‹è¯•ä»£ç ã€åŸºç¡€æ¶æ„ä»£ç ã€é™æ€èµ„æºã€ä¾èµ–åº“ã€é…ç½®å’Œæ“ä½œç³»ç»Ÿè¡¥ä¸ã€‚&lt;/p>
&lt;p>&lt;code>ä»£ç å®¡æ ¸&lt;/code>æ˜¯å¿…é¡»çš„ã€‚å¯¹äºå…¨è‡ªåŠ¨çš„æµæ°´çº¿ï¼Œä»£ç å®¡æ ¸æ˜¯æœ€åä¸€é“äººå·¥æ ¸éªŒã€‚ä»£ç å®¡æ ¸ä¸ä»…ä»…æ˜¯å®¡æ ¸ä»£ç çš„æ­£ç¡®æ€§ï¼Œè¿˜åº”è¯¥æ£€æŸ¥ä»£ç æ˜¯å¦åŒ…æ‹¬è¶³å¤Ÿçš„æµ‹è¯•ï¼Œæ˜¯å¦æœ‰å®Œå–„çš„å·¥å…·æ¥ç›‘æµ‹éƒ¨ç½²ä»¥åŠèƒ½å¦å®‰å…¨çš„å›é€€ã€‚&lt;/p>
&lt;p>åŒæ—¶&lt;code>æ„å»º&lt;/code>ä¹Ÿä¸å…‰æ˜¯ç¼–è¯‘æºä»£ç ï¼Œæ‰“åŒ…å¹¶å­˜å‚¨æ„ä»¶ã€‚ä¹ŸåŒ…å«å•å…ƒæµ‹è¯•ï¼Œé™æ€ä»£ç åˆ†æï¼Œä»£ç è¦†ç›–ç‡æ£€æŸ¥ï¼Œä»£ç å®¡æ ¸æ£€æŸ¥ã€‚&lt;/p>
&lt;p>&lt;code>æµ‹è¯•&lt;/code>åœ¨äºšé©¬é€Šæ˜¯ä¸€ä¸ªå¤šé˜¶æ®µçš„é¢„ç”Ÿäº§ç¯å¢ƒï¼Œè¯¦è§ä¸‹å›¾ã€‚&lt;/p>
&lt;figure>
&lt;img src="https://d1.awsstatic.com/builderslibrary/architecture-images/3-Test-Phase.32a876ed20c3d585a9a761c6b07f0c3af1fff21d.PNG"
alt="test deployments in pre-production environments"/>
&lt;/figure>
&lt;p>é›†æˆæµ‹è¯•æ˜¯è‡ªåŠ¨åŒ–çš„æ¨¡æ‹Ÿå®¢æˆ·ä¸€æ ·ä½¿ç”¨æœåŠ¡ï¼Œå®ç°ç«¯åˆ°ç«¯çš„æµ‹è¯•ã€‚éƒ¨ç½²åˆ°ç”Ÿäº§ä¹‹å‰ï¼Œè¿˜éœ€è¦æ‰§è¡Œå‘åå…¼å®¹æ€§æµ‹è¯•ä»¥åŠå€ŸåŠ©è´Ÿè½½å‡è¡¡å®ç°one-boxæµ‹è¯•ã€‚&lt;/p>
&lt;p>AWSæœåŠ¡æ˜¯éƒ¨ç½²åœ¨å…¨çƒå¤šä¸ªåŒºåŸŸå†…çš„å¤šä¸ªå¯ç”¨åŒºï¼Œä¸ºäº†å‡å°‘éƒ¨ç½²æ•…éšœå¯¹å®¢æˆ·çš„å½±å“ï¼Œ&lt;code>ç”Ÿäº§&lt;/code>é€šè¿‡&lt;strong>æ³¢æ¬¡&lt;/strong>éƒ¨ç½²æ¥åˆ†æ‰¹åˆ†é˜¶æ®µçš„å®‰å…¨éƒ¨ç½²ã€‚&lt;/p>
&lt;figure>
&lt;img src="https://d1.awsstatic.com/builderslibrary/architecture-images/5-Prod-Phase.31bac8cfc2ae3c68c5ee1e7332c0e6d7b2385bcf.PNG"
alt="production deployments"/>
&lt;/figure>
&lt;p>é¦–å…ˆéƒ¨ç½²æ˜¯åœ¨å•åŒºåŸŸçš„å•å¯ç”¨åŒºåšone-boxéƒ¨ç½²ï¼Œå¦‚æœå¼•èµ·è´Ÿé¢é—®é¢˜ï¼Œä¼šè‡ªåŠ¨å›é€€å¹¶åœæ­¢ç”Ÿäº§åç»­çš„éƒ¨ç½²ã€‚ç³»ç»ŸæŒ‡æ ‡çš„ç›‘æ§æ˜¯å®ç°è‡ªåŠ¨åŒ–å®‰å…¨éƒ¨ç½²çš„æ ¸å¿ƒï¼Œéœ€è¦é€šè¿‡ç›‘æ§çš„æŒ‡æ ‡æ¥è‡ªåŠ¨è§¦å‘éƒ¨ç½²å›é€€ã€‚&lt;/p>
&lt;p>Bake timeä¹Ÿæ˜¯å®è·µç»éªŒæ€»ç»“å‡ºæ¥çš„ç²¾é«“ã€‚æœ‰æ—¶æ•…éšœä¸æ˜¯åœ¨éƒ¨ç½²åé©¬ä¸Šæ˜¾ç°çš„ï¼Œéœ€è¦æ—¶é—´æ‰ä¼šé€æ¸æ˜¾ç°ã€‚è®¾ç½®åˆç†çš„Bake timeï¼Œèƒ½å¤Ÿè®©æ•…éšœæœ‰è¶³å¤Ÿæ—¶é—´è¢«æš´éœ²å‡ºæ¥ï¼Œä¸è‡³äºç…§æˆå¤§èŒƒå›´å½±å“ã€‚&lt;/p>
&lt;h3 id="ensuring-rollback-safety-during-deploymentsensuring-rollback-safety-during-deployments">&lt;a href="https://aws.amazon.com/builders-library/ensuring-rollback-safety-during-deployments/?did=ba_card&amp;amp;trk=ba_card">Ensuring rollback safety during deployments&lt;/a>&lt;/h3>
&lt;p>å› ä¸ºæ•…éšœæ˜¯ä¸å¯é¿å…çš„ï¼Œéƒ¨ç½²èƒ½å¤Ÿè¢«å®‰å…¨å›é€€æ˜¯éå¸¸å¿…è¦çš„ã€‚è¿™ç¯‡æ–‡ç« å°±è¯¦ç»†ä»‹ç»äº†å¦‚ä½•å®ç°å¯å®‰å…¨å›é€€çš„éƒ¨ç½² &amp;ndash; é€šè¿‡&lt;strong>ä¸¤é˜¶æ®µéƒ¨ç½²çš„æŠ€æœ¯&lt;/strong>ï¼Œä»¥åŠåºåˆ—åŒ–çš„æœ€ä½³å®è·µã€‚&lt;/p>
&lt;figure>
&lt;img src="https://d1.awsstatic.com/legal/builders-library/Screenshots/two-phase-deployment.4322b209195704c61f7a3f311413a76f264afb8b.png"
alt="two-phase deployment technique"/>
&lt;/figure>
&lt;blockquote>
&lt;p>è¿™ä¸‰ç¯‡æ–‡ç« åˆ†åˆ«ä»æœ¯å’Œå™¨çš„è§’åº¦åˆ†äº«äº†äºšé©¬é€Šåœ¨è½¯ä»¶éƒ¨ç½²çš„å®è·µç»éªŒï¼Œå¼€å‘è€…ä»¬å¯ä»¥ç»“åˆè‡ªèº«ä¸šåŠ¡æƒ…å†µé›†æˆé€‚åˆçš„æœ€ä½³å®è·µã€‚&lt;/p>
&lt;/blockquote></description></item><item><title>è·¨è´¦å·è·¨åŒºåŸŸéƒ¨ç½²AWS CDKç¼–æ’çš„åº”ç”¨</title><link>https://kane.mx/posts/2020/deploy-aws-cdk-applications-cross-accounts/</link><pubDate>Wed, 14 Oct 2020 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2020/deploy-aws-cdk-applications-cross-accounts/</guid><description>&lt;p>&lt;a href="https://kane.mx/posts/2019/aws-cdk/">AWS CDK&lt;/a>æ˜¯ç¼–æ’éƒ¨ç½²AWSäº‘ä¸Šèµ„æºæœ€ä½³çš„å·¥å…·ä¹‹ä¸€ã€‚åŸºäºAWS CDKçš„åº”ç”¨åº”è¯¥å¦‚ä½•å®è·µDevOpsæŒç»­é›†æˆå’Œéƒ¨ç½²å‘¢ï¼Ÿ&lt;/p>
&lt;p>é€šå¸¸æˆ‘ä»¬æœ‰ä¸‹é¢å‡ ç§æ–¹æ³•ï¼Œ&lt;/p>
&lt;ol>
&lt;li>ä½¿ç”¨&lt;a href="https://aws.amazon.com/codepipeline/">AWS CodePipeline&lt;/a>æ¥å®ŒæˆDevOps pipelineæ­å»ºã€‚CodePipelineæ˜¯AWS Codeç³»åˆ—æœåŠ¡ä¸­çš„æŒç»­é›†æˆç¼–æ’å·¥å…·ï¼Œå®ƒå¯ä»¥é›†æˆCodeBuildé¡¹ç›®ï¼Œåœ¨CodeBuildé¡¹ç›®buildä¸­å®‰è£…&lt;code>cdk&lt;/code>ï¼Œå¹¶æ‰§è¡Œ&lt;code>cdk deploy&lt;/code>å‘½ä»¤æ¥å®ç°åº”ç”¨éƒ¨ç½²ã€‚&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>è¿™ç§æ–¹æ³•ç®€å•ç›´æ¥çš„å®ç°äº†DevOpséƒ¨ç½²æµæ°´çº¿ã€‚ä½†ç¼ºå°‘stagingï¼Œå°†æœ€æ–°æäº¤ç›´æ¥éƒ¨ç½²åˆ°ç”Ÿäº§æ˜¯ä¸€ç§éå¸¸é«˜é£é™©çš„åšæ³•ã€‚&lt;/p>
&lt;/blockquote>
&lt;ol start="2">
&lt;li>CDKè¿‘æœŸå‘å¸ƒäº†ä½“éªŒæ€§çš„æ–°ç‰¹æ€§&lt;a href="https://aws.amazon.com/blogs/developer/cdk-pipelines-continuous-delivery-for-aws-cdk-applications/">CDK Pipelines&lt;/a>æ¥å°è£…CDKåº”ç”¨æŒç»­éƒ¨ç½²æµæ°´çº¿çš„é…ç½®ã€‚CDK Pipelinesä¹Ÿæ˜¯åŸºäºAWS CodePipelineæœåŠ¡ï¼Œæä¾›å¿«é€Ÿåˆ›å»ºå¯è·¨è´¦å·åŒºåŸŸçš„æŒç»­éƒ¨ç½²æµæ°´çº¿ï¼ŒåŒæ—¶æ”¯æŒéƒ¨ç½²æµæ°´çº¿é¡¹ç›®çš„è‡ªå‡çº§æ›´æ–°ã€‚æ•´ä¸ªæµæ°´çº¿æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ&lt;/li>
&lt;/ol>
&lt;figure>
&lt;img src="https://d2908q01vomqb2.cloudfront.net/0716d9708d321ffb6a00818614779e779925365c/2020/07/02/CDKPipelines_1.png"
alt="workflow of cdk pipelines"/>
&lt;/figure>
&lt;p>CDK Pipelinesæ˜¯éå¸¸é«˜æ•ˆä¸”çµæ´»çš„æŒç»­éƒ¨ç½²æµæ°´çº¿åˆ›å»ºçš„æ–¹å¼ï¼Œä½†ç”±äºæ˜¯ä½“éªŒæ€§ç‰¹æ€§ï¼Œåœ¨ç”Ÿäº§åº”ç”¨ä¸­è¿˜æœ‰ä¸€äº›å±€é™æ€§ã€‚ä¾‹å¦‚ï¼Œ&lt;/p>
&lt;ul>
&lt;li>ä¸æ”¯æŒcontext provideræŸ¥æ‰¾ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ— æ³•æ”¯æŒCDKåº”ç”¨æŸ¥æ‰¾è´¦æˆ·ä¸­å­˜åœ¨çš„VPCï¼ŒR53 HostedZoneç­‰ã€‚&lt;/li>
&lt;li>ç”±äºCDK Pipelineså®é™…æ˜¯ä½¿ç”¨CodePipelineæ¥ç¼–æ’éƒ¨ç½²æµæ°´çº¿ï¼ŒCodePipelineçš„å±€é™æ€§ï¼ŒCDK PipelinesåŒæ ·å­˜åœ¨ã€‚&lt;/li>
&lt;li>CodePipelineåœ¨æŸäº›åˆ†åŒºå’ŒåŒºåŸŸè¿˜ä¸å¯ç”¨ã€‚ä¾‹å¦‚ï¼ŒAWSä¸­å›½åŒºæš‚æ—¶è¿˜æ²¡æœ‰CodePipelineæœåŠ¡ï¼ŒCDK Pipelinesåœ¨AWSä¸­å›½åŒºä¹Ÿå°±æ— æ³•ä½¿ç”¨ã€‚&lt;/li>
&lt;/ul>
&lt;ol start="3">
&lt;li>ä½¿ç”¨&lt;a href="https://aws.amazon.com/step-functions/">AWS Step Functions&lt;/a>æ¥ç¼–æ’CDKåº”ç”¨éƒ¨ç½²çš„æµæ°´çº¿ã€‚åœ¨Step Functionsç¼–è¯‘çš„éƒ¨ç½²æµæ°´çº¿ä¸­ï¼Œå¯ç”¨é€šè¿‡CodeBuildé¡¹ç›®æ¥å®Œæˆ&lt;code>cdk deploy&lt;/code>æ‰§è¡Œåšåˆ°å®Œæ•´çš„æ”¯æŒCDKçš„æ‰€æœ‰åŠŸèƒ½ã€‚åŒæ—¶Step Functionså…·å¤‡æœ€å¤§çš„çµæ´»æ€§æ¥æ”¯æŒæŒç»­éƒ¨ç½²è¿‡ç¨‹ä¸­çš„å„ç§ç¼–æ’éœ€æ±‚ï¼Œä¾‹å¦‚ï¼Œè·¨è´¦æˆ·éƒ¨ç½²åº”ç”¨çš„ä¸åŒstageï¼Œå¼•å…¥äººå·¥å®¡æ‰¹æµç¨‹ï¼Œé€šè¿‡Slackç­‰chatopså·¥å…·æ¥å®Œæˆå®¡æ‰¹ã€‚&lt;/li>
&lt;/ol>
&lt;p>&lt;a href="https://opentuna.cn">Opentuna&lt;/a>é¡¹ç›®å°±å®è·µäº†ç”¨Step Functionsæ¥ç¼–æ’&lt;a href="https://github.com/tuna/opentuna/blob/master/pipeline.md">æŒç»­éƒ¨ç½²æµæ°´çº¿&lt;/a>ã€‚æ•´ä¸ªéƒ¨ç½²æµç¨‹å¦‚ä¸‹å›¾ï¼Œ&lt;/p>
&lt;figure>
&lt;img src="images/opentuna-pipeline.png"
alt="OpenTUNAéƒ¨ç½²æµç¨‹"/>
&lt;/figure>
&lt;p>å¦‚æœå¯¹åŸºäºStep Functionså®ç°çš„CDKåº”ç”¨æŒç»­éƒ¨ç½²æ„Ÿå…´è¶£ï¼Œå¯ä»¥è®¿é—®OpenTUNAé¡¹ç›®å®ç°çš„&lt;a href="https://github.com/tuna/opentuna/blob/master/lib/pipeline-stack.ts">æºç &lt;/a>äº†è§£æ›´å¤šç»†èŠ‚ã€‚&lt;/p></description></item><item><title>Deploy Sonatype Nexus repository OSS on EKS</title><link>https://kane.mx/posts/2020/deploy-sonatype-nexus-oss-on-eks/</link><pubDate>Tue, 16 Jun 2020 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2020/deploy-sonatype-nexus-oss-on-eks/</guid><description>&lt;p>&lt;a href="https://www.sonatype.com/nexus-repository-oss">Sonatype Nexus repository OSS&lt;/a> is an artifact repository that supports most software repositories such as Maven, Pypi, Npmjs, Rubygems, Yum, Apt, Docker registry and etc. In the enterprise Nexus repository is widely used for storing proprietary artifacts and caching the artifacts for speeding up the devops.&lt;/p>
&lt;p>Building a production ready Nexus repository always is a requirement for devops team, it should satisfy below criterias at least,&lt;/p>
&lt;ul>
&lt;li>&lt;strong>artifacts storage management&lt;/strong> It&amp;rsquo;s difficult to predicate the storage usage of artifacts, allocating large volume is not cost optimized.&lt;/li>
&lt;li>&lt;strong>the durability of nexus3 data storage&lt;/strong> We need a way to make sure data storage of nexus when updating Nexus OSS to newer version or recover the service from unhealthy status.&lt;/li>
&lt;li>&lt;strong>self healing capability when the service is down&lt;/strong> A reliable way recovers the Nexus repository OSS when it&amp;rsquo;s unhealth.&lt;/li>
&lt;/ul>
&lt;p>There is a well-architected &lt;a href="https://github.com/aws-samples/nexus-oss-on-aws">solution&lt;/a>(maintained by AWS team) to quickly(~10 minutes) deploy &lt;a href="https://www.sonatype.com/nexus-repository-oss">Nexus OSS&lt;/a> leveraging below capabilities,&lt;/p>
&lt;ul>
&lt;li>Host on EKS cluster using managed EC2 nodes with &lt;a href="https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html">IRSA&lt;/a>&lt;/li>
&lt;li>Expose service via AWS Application load balancer managed by &lt;a href="https://github.com/kubernetes-sigs/aws-load-balancer-controller">AWS load balancer controller&lt;/a>(former ALB Ingress Controller)&lt;/li>
&lt;li>Use dedicated S3 bucket for storing Nexus OSS blobstore with ulimited and on-demand storage&lt;/li>
&lt;li>Use EFS, &lt;a href="https://docs.aws.amazon.com/eks/latest/userguide/efs-csi.html">EFS CSI Driver&lt;/a>, PV and PVC storing nexus data&lt;/li>
&lt;li>Use &lt;a href="https://helm.sh/">Helm&lt;/a> to deploy &lt;a href="https://hub.helm.sh/charts/oteemo/sonatype-nexus">Sonatype Nexus chart&lt;/a>&lt;/li>
&lt;li>&lt;code>Optional&lt;/code> Use &lt;a href="https://github.com/kubernetes-sigs/external-dns">External DNS&lt;/a> to registry the domain record of Nexus repository to Route 53&lt;/li>
&lt;li>&lt;code>Optional&lt;/code> Use AWS Certificate Manager to create SSL certificate of domain name of Nexus repository&lt;/li>
&lt;/ul>
&lt;p>Enjoy itğŸ˜&lt;/p></description></item><item><title>æ— æœåŠ¡å™¨æ¶æ„çš„Dockeré•œåƒæ•°æ®åˆ†æåº”ç”¨</title><link>https://kane.mx/posts/2020/serverless-docker-images-analytics/</link><pubDate>Mon, 04 May 2020 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2020/serverless-docker-images-analytics/</guid><description>&lt;p>è¿‘æœŸå¯¹Dockeré•œåƒåšäº†äº›æ•°æ®åˆ†æï¼Œè¿™é‡Œåˆ†äº«ä¸€ä¸‹åˆ©ç”¨äº‘åŸç”ŸæŠ€æœ¯å¿«é€Ÿä¸”ä½æˆæœ¬çš„å®ç°ä»»æ„æ•°é‡çš„æ•°æ®åˆ†æã€‚&lt;/p>
&lt;p>ä¹‹å‰é€šè¿‡æ–‡ç« ä»‹ç»äº†&lt;a href="https://kane.mx/posts/2020/get-docker-image-size-without-pulling-image/">ä¸ç”¨æ‹‰å–Dockeré•œåƒå°±å¯è·å–é•œåƒçš„å¤§å°&lt;/a>çš„ä¸€ç§æ–¹æ³•ï¼Œé€šè¿‡å…¶ä¸­çš„ç¤ºä¾‹è„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥è·å–åˆ°å¾…åˆ†æçš„åŸå§‹æ•°æ®ã€‚&lt;/p>
&lt;p>æ¯”å¦‚&lt;code>nginx&lt;/code>é•œåƒçš„éƒ¨åˆ†åŸå§‹æ•°æ®(csvæ ¼å¼)å¦‚ä¸‹ï¼Œ&lt;/p>
&lt;div class="highlight">&lt;div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-txt" data-lang="txt">1.18.0-alpine,sha256:676b8117782d9e8c20af8e1b19356f64acc76c981f3a65c66e33a9874877892a,amd64,linux,null,null,&amp;#34;sha256:cbdbe7a5bc2a134ca8ec91be58565ec07d037386d1f1d8385412d224deafca08&amp;#34;,2813316
1.18.0-alpine,sha256:676b8117782d9e8c20af8e1b19356f64acc76c981f3a65c66e33a9874877892a,amd64,linux,null,null,&amp;#34;sha256:6ade829cd166df9b2331da48e3e60342aef9f95e1e45cde8d20e6b01be7e6d9a&amp;#34;,6477096
1.18.0-alpine,sha256:70feed62d5204358ed500463c0953dce6c269a0ebeef147a107422a2c78799a9,arm,linux,v6,null,&amp;#34;sha256:b9e3228833e92f0688e0f87234e75965e62e47cfbb9ca8cc5fa19c2e7cd13f80&amp;#34;,2619936
1.18.0-alpine,sha256:70feed62d5204358ed500463c0953dce6c269a0ebeef147a107422a2c78799a9,arm,linux,v6,null,&amp;#34;sha256:a03f81873d278ad248976b107883f0452d33c6f907ebcdd832a6041f1d33118a&amp;#34;,6080562
1.18.0-alpine,sha256:2ba714ccbdc4c2a7b5a5673ebbc8f28e159cf2687a664d540dcb91d325934f32,arm64,linux,v8,null,&amp;#34;sha256:29e5d40040c18c692ed73df24511071725b74956ca1a61fe6056a651d86a13bd&amp;#34;,2724424
1.18.0-alpine,sha256:2ba714ccbdc4c2a7b5a5673ebbc8f28e159cf2687a664d540dcb91d325934f32,arm64,linux,v8,null,&amp;#34;sha256:806787fcd4f9e2f814506fb53e81b6fb33f9eea04e5b537b31fa5fb601a497ee&amp;#34;,6423816
1.18.0-alpine,sha256:6d6f19360150548bbb568ecd3e1affabbdce0fcc39156e70fbae8a0aa656541a,386,linux,null,null,&amp;#34;sha256:2826c1e79865da7e0da0a993a2a38db61c3911e05b5df617439a86d4deac90fb&amp;#34;,2808418
1.18.0-alpine,sha256:6d6f19360150548bbb568ecd3e1affabbdce0fcc39156e70fbae8a0aa656541a,386,linux,null,null,&amp;#34;sha256:f2ab0e3b0ff04d1695df322540631708c42b0a68925788de2290c9497e44fef3&amp;#34;,6845295
1.18.0-alpine,sha256:c0684c6ee14c7383e4ef1d458edf3535cd62b432eeba6b03ddf0d880633207da,ppc64le,linux,null,null,&amp;#34;sha256:9a8fdc5b698322331ee7eba7dd6f66f3a4e956554db22dd1e834d519415b4f8e&amp;#34;,2821843
1.18.0-alpine,sha256:c0684c6ee14c7383e4ef1d458edf3535cd62b432eeba6b03ddf0d880633207da,ppc64le,linux,null,null,&amp;#34;sha256:30a37aac8b54a38e14e378f5122186373cf233951783587517243e342728a828&amp;#34;,6746511
1.18.0-alpine,sha256:714439fec7e1f55c29b57552213e45c96bbfeefddea2b3b30d7568591966c914,s390x,linux,null,null,&amp;#34;sha256:7184c046fdf17da4c16ca482e5ede36e1f2d41ac8cea9c036e488fd149d6e8e7&amp;#34;,2582859
1.18.0-alpine,sha256:714439fec7e1f55c29b57552213e45c96bbfeefddea2b3b30d7568591966c914,s390x,linux,null,null,&amp;#34;sha256:214dff8a034aad01facf6cf63613ed78e9d23d9a6345f1dee2ad871d6f94b689&amp;#34;,6569410&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>å„åˆ—çš„å«ä¹‰åˆ†åˆ«æ˜¯ï¼Œ&lt;code>é•œåƒtag&lt;/code>, &lt;code>é•œåƒ&lt;/code>&lt;a href="https://docs.docker.com/registry/spec/api/#content-digests">Digest&lt;/a>, &lt;code>é•œåƒå¯¹åº”å¹³å°çš„Architecture&lt;/code>, &lt;code>é•œåƒå¯¹åº”å¹³å°çš„OS&lt;/code>, &lt;code>é•œåƒå¯¹åº”å¹³å°çš„å˜ç§&lt;/code>ï¼ˆä¾‹å¦‚ï¼ŒARMçš„v7, v8ç­‰ï¼‰, &lt;code>é•œåƒå¯¹åº”å¹³å°çš„OSç‰ˆæœ¬&lt;/code>, &lt;code>é•œåƒç»„æˆå±‚çš„&lt;/code>&lt;a href="https://docs.docker.com/registry/spec/api/#content-digests">Digest&lt;/a>, &lt;code>é•œåƒç»„æˆå±‚çš„å¤§å°&lt;/code>ã€‚&lt;/p>
&lt;p>ä¸Šé¢&lt;code>nginx&lt;/code>é•œåƒçš„ç¤ºä¾‹æ•°æ®ï¼Œå‘Šè¯‰æˆ‘ä»¬é•œåƒå&lt;code>nginx&lt;/code>ä¸”tagä¸º&lt;code>1.18.0-alpine&lt;/code>çš„é•œåƒåŒ…å«äº†&lt;code>amd64-linux&lt;/code>, &lt;code>arm-linux-v6&lt;/code>, &lt;code>arm64-linux-v8&lt;/code>, &lt;code>386-linux&lt;/code>, &lt;code>ppc64le-linux&lt;/code>ä»¥åŠ&lt;code>s390x-linux&lt;/code>å…±5ç§Archåˆè®¡6ä¸ªç‰ˆæœ¬çš„é•œåƒã€‚ä¸”æ¯ä¸ªå¹³å°çš„å¯¹åº”é•œåƒåŒ…å«äº†ä¸¤ä¸ªå±‚ä»¥åŠè¿™ä¸¤ä¸ªå±‚çš„å¤§å°ã€‚&lt;/p>
&lt;p>å½“æˆ‘ä»¬æœ‰äº†æˆç™¾æ•°åƒç”šè‡³æµ·é‡é•œåƒçš„åŸå§‹æ•°æ®åï¼Œå¦‚ä½•èƒ½å¿«é€Ÿä¸”ä½æˆæœ¬çš„åˆ†æè¿™äº›æ•°æ®å‘¢ï¼Ÿ&lt;/p>
&lt;p>åœ¨AWSä¸Šï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨&lt;a href="https://aws.amazon.com/big-data/datalakes-and-analytics/">æ•°æ®æ¹–&lt;/a>ç›¸å…³çš„ç³»åˆ—äº§å“æ¥å®ç°ä½æˆæœ¬çš„äº¤äº’å¼åˆ†æã€‚&lt;/p>
&lt;ol>
&lt;li>åœ¨Dockeré•œåƒåˆ†æè¿™ä¸ªåœºæ™¯ä¸‹ï¼Œæˆ‘å·²ç»è·å–åˆ°äº†å¾…åˆ†æé•œåƒçš„å¹³å°ã€å±‚ç­‰æ•°æ®ã€‚æˆ‘å°†è¿™äº›æ•°æ®ä¸Šä¼ åˆ°&lt;a href="https://aws.amazon.com/s3/">Amazon S3&lt;/a>ä½œä¸ºæ•°æ®æ¹–çš„æ•°æ®æºã€‚&lt;/li>
&lt;li>æ¥ä¸‹æ¥ä½¿ç”¨&lt;a href="https://aws.amazon.com/glue/">AWS Glue&lt;/a>ä»¥S3ä¸­çš„æ•°æ®åˆ›å»ºTableå¹¶ä¸”ä»ä¸­æå‰æ•°æ®çš„metadataã€‚åŒæ—¶åšæ•°æ®åˆ†åŒºï¼Œä¸ºæ¥ä¸‹æ¥çš„æŸ¥è¯¢åšæ€§èƒ½å’Œæˆæœ¬ä¼˜åŒ–ã€‚&lt;/li>
&lt;li>æ‰“å¼€&lt;a href="https://aws.amazon.com/athena/">Amazon Athena&lt;/a>ï¼Œæ ¹æ®ä¸šåŠ¡éœ€æ±‚é€šè¿‡SQLè¯­å¥æŸ¥è¯¢åˆ†æDockeré•œåƒæ•°æ®ã€‚&lt;/li>
&lt;/ol>
&lt;p>å°±æ˜¯é€šè¿‡ä»¥ä¸Š3ä¸ªç®€å•æ­¥éª¤ï¼Œæˆ‘å°±å¾—åˆ°äº†ä¸€ä¸ªæ— æœåŠ¡å™¨æ¶æ„çš„Dockeré•œåƒæ•°æ®åˆ†æåº”ç”¨ï¼æ•´ä¸ªåº”ç”¨å®Œå…¨æ˜¯æŒ‰é‡è®¡è´¹çš„ï¼Œä¸»è¦æˆæœ¬åŒ…æ‹¬S3å¯¹è±¡å­˜å‚¨è´¹ç”¨ï¼Œå’ŒAthenaè´¹ç”¨ï¼ˆæ ¹æ®æ¯æ¬¡æŸ¥è¯¢æ‰«ææ•°æ®çš„å¤§å°æ¥è®¡ç®—ï¼‰ã€‚&lt;/p>
&lt;p>ä½¿ç”¨è¯¥åˆ†æåº”ç”¨ï¼Œæˆ‘ç»Ÿè®¡äº†&lt;a href="https://hub.docker.com/search?image_filter=official&amp;amp;type=image">Docker Hubå®˜æ–¹é•œåƒ&lt;/a>ä¸­åŒ…å«å±‚æœ€å¤šçš„10ä¸ªé•œåƒ(åˆ†å¹³å°ç»Ÿè®¡)ï¼Œ
&lt;figure>
&lt;img src="https://kane.mx/posts/2020/serverless-docker-images-analytics/images/top-10-layers-of-official-images.png"
alt="Top 10 layers"/>
&lt;/figure>
&lt;/p>
&lt;p>æœ€åï¼Œå¾—åŠ›äºAWS Infra as Codeçš„å¼ºå¤§èƒ½åŠ›ï¼Œ&lt;a href="https://github.com/zxkane/serverless-docker-images-analytics">æ•´ä¸ªåº”ç”¨&lt;/a>ä¹Ÿæ˜¯é€šè¿‡ä»£ç ç®¡ç†çš„ä¸”å¼€æºçš„ï¼Œæœ‰å…´è¶£çš„è¯»è€…ä¹Ÿå¯ä»¥éƒ¨ç½²è‡ªå·±çš„åˆ†æåº”ç”¨ã€‚&lt;/p></description></item><item><title>Get the size of Docker image without pulling image</title><link>https://kane.mx/posts/2020/get-docker-image-size-without-pulling-image/</link><pubDate>Sat, 02 May 2020 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2020/get-docker-image-size-without-pulling-image/</guid><description>&lt;p>Recently I had a requirement to stats the size of some Docker images. It would be waste if pulling them all firstly then calculating the size of each image. Also you know the docker image consists of some Docker layers that probably are shared by other images. It&amp;rsquo;s hard to get the disk usage if only sum the size of each image.&lt;/p>
&lt;p>Is there any way to get the size of Docker image without pulling it?&lt;/p>
&lt;p>It&amp;rsquo;s definitely &lt;strong>Yes&lt;/strong>. The docker images are hosted by &lt;a href="https://docs.docker.com/registry/spec/api/">Docker Registry&lt;/a>, which is defined by &lt;a href="https://docs.docker.com/registry/spec/api/">a public specification&lt;/a>. The latest V2 of Registry has &lt;a href="https://docs.docker.com/registry/spec/api/#pulling-an-image">API&lt;/a> to fetch the manifest of an image that contains the size of every layer. Looks like it&amp;rsquo;s very cool. Utilitying the manifest API of image will satisfie my requirement!&lt;/p>
&lt;p>One more thing you should note, the v2 of Docker registry still is compatible with &lt;a href="https://docs.docker.com/registry/spec/manifest-v2-1/">schema specification V1&lt;/a>. You have to properly handle with the mixed responses of manifest when you query the manifest of an image.&lt;/p>
&lt;p>I created a &lt;a href="https://gist.github.com/zxkane/23de226fee8806ee0ed8c05136972ce0">simple shell script&lt;/a> gracefully handling either v1 or v2 response of the image manifest, which can calculate the total layers size of a Docker image with specific tag, or the size of all tags of a Docker image.&lt;/p>
&lt;blockquote>
&lt;p>Above script was inspired by &lt;a href="https://ops.tips/blog/inspecting-docker-image-without-pull/">this post&lt;/a>. Hope you enjoy it.&lt;/p>
&lt;/blockquote></description></item><item><title>oh-my-zshæ€§èƒ½è°ƒä¼˜æ€è·¯</title><link>https://kane.mx/posts/2020/zsh-performance-tuning/</link><pubDate>Wed, 22 Apr 2020 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2020/zsh-performance-tuning/</guid><description>&lt;p>&lt;a href="https://zh.wikipedia.org/wiki/Z_shell">Z shell&lt;/a>æ­é…&lt;a href="https://ohmyz.sh/">oh-my-zsh&lt;/a>è‡ªå®šä¹‰é…ç½®å·²æˆä¸ºä¼—å¤šLinux/Macosxç”¨æˆ·çš„æ ‡å‡†terminalé…ç½®ã€‚&lt;/p>
&lt;p>æœ€è¿‘é‡åˆ°åœ¨&lt;code>zsh&lt;/code>ä¸­æ‰§è¡Œä»»æ„å‘½ä»¤éƒ½å˜å¾—ç‰¹åˆ«æ…¢(å“ªæ€•ç®€å•æ‰§è¡Œ&lt;code>ls&lt;/code>ä¹Ÿè¦èŠ±è´¹è‚‰çœ¼å¯è§çš„1ï¼Œ2ç§’é’Ÿ)ï¼Œè¿™é‡Œè®°å½•ä¸‹å¦‚ä½•æ’æŸ¥&lt;a href="https://zh.wikipedia.org/wiki/Z_shell">Z shell&lt;/a>ä¸‹å¯ç”¨&lt;a href="https://ohmyz.sh/">oh-my-zsh&lt;/a>çš„æ€§èƒ½é—®é¢˜ã€‚&lt;/p>
&lt;h3 id="æ€§èƒ½é—®é¢˜ç—‡çŠ¶">æ€§èƒ½é—®é¢˜ç—‡çŠ¶&lt;/h3>
&lt;p>çªç„¶æŸå¤©èµ·åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œéƒ½è‡³å°‘è¦èŠ±è´¹1ï¼Œ2ç§’ï¼ˆè‚‰çœ¼è®¡æ•°ï¼‰ï¼Œè¯¥å‘½ä»¤æ‰ä¼šå®Œæˆæ‰§è¡Œå¹¶é€€å‡ºåˆ°ç»ˆç«¯å¼€å§‹æ¥å—æ–°çš„è¾“å…¥ã€‚&lt;/p>
&lt;p>æˆ‘å½“å‰ä¸»è¦ä½¿ç”¨çš„ç»ˆç«¯æ˜¯&lt;a href="https://www.iterm2.com/">iTerm2&lt;/a>ï¼Œæ‰§è¡Œå‘½ä»¤åï¼Œåœ¨ç»ˆç«¯Tabçš„title barä¸Šèƒ½æ˜¾å¼çš„çœ‹åˆ°&lt;code>git&lt;/code>å‘½ä»¤ä¹Ÿè¢«æ‰§è¡Œäº†ã€‚&lt;/p>
&lt;p>å°è¯•äº†å…¶ä»–çš„shellï¼Œæ¯”å¦‚&lt;code>bash&lt;/code>ï¼Œæ˜¯æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚åŸºæœ¬æ–­å®šé—®é¢˜åŒ&lt;code>zsh&lt;/code>ç›¸å…³ã€‚æ›´å¤šé—®é¢˜æè¿°ä¹ƒè‡³åŠ¨ç”»æˆªå±ï¼Œå¯ä»¥å‚è§&lt;a href="https://github.com/ohmyzsh/ohmyzsh/issues/8833">è¿™ä¸ªissue&lt;/a>ã€‚&lt;/p>
&lt;h3 id="zsh--oh-my-zsh-æ€§èƒ½é—®é¢˜åˆ†æ">zsh + oh-my-zsh æ€§èƒ½é—®é¢˜åˆ†æ&lt;/h3>
&lt;p>&lt;a href="https://ohmyz.sh/">oh-my-zsh&lt;/a>å…¶å®å°±æ˜¯æä¾›&lt;a href="https://zh.wikipedia.org/wiki/Z_shell">zsh&lt;/a>çš„å®šåˆ¶åŒ–é…ç½®ï¼Œä¸»è¦åŒ…æ‹¬Themeä¸»é¢˜å’Œå„ç§è½¯ä»¶çš„æ’ä»¶ã€‚&lt;/p>
&lt;h4 id="oh-my-zsh-æ’ä»¶">oh-my-zsh æ’ä»¶&lt;/h4>
&lt;p>é€šå¸¸&lt;a href="https://ohmyz.sh/">oh-my-zsh&lt;/a>ä¸­å†…ç½®æˆ–ä¸‰æ–¹ç¤¾åŒºæä¾›çš„æ’ä»¶æ˜¯å¯¼è‡´æ€§èƒ½é™ä½ç”šè‡³äº’ç›¸å†²çªçš„ä¸»è¦åŸå› ã€‚æ’æŸ¥æ€è·¯ä¹Ÿå¾ˆç®€å•ï¼Œé€šè¿‡é€ä¸ªç¦ç”¨å·²åŠ è½½çš„æ’ä»¶æ¥æµ‹è¯•æ˜¯å¦å¯ä»¥è§£å†³é—®é¢˜ã€‚&lt;/p>
&lt;p>ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å½“å‰ç”¨æˆ·çš„&lt;code>~/.zshrc&lt;/code>é…ç½®ï¼Œæ‰¾åˆ°&lt;code>plugins&lt;/code>å¼€å¤´çš„é…ç½®è¡Œï¼Œä¾‹å¦‚ï¼Œ&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">plugins&lt;span style="color:#f92672">=(&lt;/span>
git
osx
&lt;span style="color:#75715e">## gradle&lt;/span>
brew
&lt;span style="color:#75715e">## command-not-found&lt;/span>
github
&lt;span style="color:#75715e"># gnu-utils&lt;/span>
&lt;span style="color:#75715e">## mvn&lt;/span>
python
pip
&lt;span style="color:#75715e"># screen&lt;/span>
vi-mode
docker
&lt;span style="color:#75715e">## docker-compose&lt;/span>
node
&lt;span style="color:#75715e">## spring&lt;/span>
mosh
&lt;span style="color:#75715e"># httpie&lt;/span>
&lt;span style="color:#75715e">## sudo&lt;/span>
tmux
&lt;span style="color:#75715e">## kubectl&lt;/span>
&lt;span style="color:#75715e">## helm&lt;/span>
golang
history
history-substring-search
zsh-autosuggestions
zsh-syntax-highlighting
&lt;span style="color:#f92672">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>é€šè¿‡è¡Œé¦–æ·»åŠ &lt;code>#&lt;/code>æ¥ç¦ç”¨&lt;code>oh-my-zsh&lt;/code>æ’ä»¶ï¼Œå¯åŠ¨æ–°çš„ç»ˆç«¯çª—å£æˆ–tabæ¥éªŒè¯æ˜¯å¦è¯¥æ’ä»¶æ˜¯å¼•èµ·é—®é¢˜çš„æ ¹æºã€‚&lt;/p>
&lt;p>åœ¨æˆ‘çš„é…ç½®ä¸­ï¼Œå‡ºç°è¿‡å› ä¸ºå¯ç”¨è¿‡å¤šæ’ä»¶ï¼Œå¯¼è‡´æ–°å»ºç»ˆç«¯éœ€è¦10æ¥ç§’é’Ÿã€‚ä½†å› ä¸ºåˆ›å»ºç»ˆç«¯ä¸æ˜¯ä¸€ä¸ªé«˜é¢‘çš„éœ€æ±‚ï¼Œè¿™ä¸ªæ€§èƒ½é€šå¸¸æ¥è¯´è¿˜æ˜¯å¯ä»¥å¿å—ã€‚&lt;/p>
&lt;h4 id="oh-my-zsh-ä¸»é¢˜">oh-my-zsh ä¸»é¢˜&lt;/h4>
&lt;p>åœ¨æˆ‘çš„è¿™ä¸ªé—®é¢˜ä¸­ï¼Œå³ä½¿å°†æ‰€æœ‰æ’ä»¶éƒ½ç¦ç”¨äº†ï¼Œå‘½ä»¤æ‰§è¡Œåé€€å‡ºé€Ÿåº¦è¿˜æ˜¯æ²¡æœ‰æ”¹å–„ï¼Œ&lt;code>git&lt;/code>å‘½ä»¤ä»ç„¶æœ‰è¢«æ‰§è¡Œã€‚è¿™æ—¶æˆ‘å°è¯•æ›´æ¢ä¸åŒ&lt;code>oh-my-zsh&lt;/code>å†…ç½®ä¸»é¢˜æ¥æ’æŸ¥é—®é¢˜ã€‚ä½†æ˜¯ä½¿ç”¨äº†åŒ…æ‹¬é»˜è®¤ä¸»é¢˜&lt;code>robbyrussell&lt;/code>ï¼Œæç®€ä¸»é¢˜&lt;code>ys&lt;/code>åœ¨å†…çš„å¤šä¸ªä¸»é¢˜éƒ½æ— æ³•è§£å†³è¯¥é—®é¢˜ã€‚&lt;/p>
&lt;p>æœ€åç›´æ¥ç¦æ­¢&lt;code>oh-my-zsh&lt;/code>ä½¿ç”¨ä¸»é¢˜ï¼Œé—®é¢˜æ²¡æœ‰äº†ï¼&lt;/p>
&lt;p>ç„¶è€Œ&lt;code>oh-my-zsh&lt;/code>ä¸»é¢˜æ˜¯å¯¹zshçš„æå¤§å¢å¼ºï¼Œæ”¹å–„äº†é»˜è®¤çš„ç”¨æˆ·ä½“éªŒï¼Œæ²¡æœ‰ä¸»é¢˜æ‰©å±•ä½¿ç”¨èµ·æ¥ä¼šéå¸¸ä¸ä¹ æƒ¯ã€‚&lt;/p>
&lt;h3 id="å°ç»“">å°ç»“&lt;/h3>
&lt;p>æœ€ç»ˆè¯•ç”¨äº†å¦ä¸€ä¸ªç¤¾åŒºç»´æŠ¤çš„çŸ¥å&lt;code>zsh&lt;/code>ä¸»é¢˜&lt;a href="https://github.com/sindresorhus/pure">Pure&lt;/a>ï¼Œæ€§èƒ½é—®é¢˜å¾—åˆ°äº†è§£å†³âœŒï¸ åŒæ—¶ä¹Ÿæ»¡è¶³äº†ä¸»é¢˜å¯¹zshè¾“å…¥è¾“å‡ºç”¨æˆ·ä½“éªŒçš„å¢å¼º ğŸ˜Š&lt;/p>
&lt;p>å¸Œæœ›è¿™é‡Œåˆ†äº«çš„&lt;code>oh-my-zsh&lt;/code>æ€§èƒ½çš„è°ƒä¼˜æ€è·¯ï¼Œå¯ä»¥å¸®åŠ©åˆ°æœ‰ç±»ä¼¼éœ€è¦çš„å„ä½ã€‚&lt;/p>
&lt;blockquote>
&lt;p>å°†æ¥ç¤¾åŒºå¯¹è¿™ä¸ª&lt;a href="https://github.com/ohmyzsh/ohmyzsh/issues/8833">é—®é¢˜&lt;/a>å¦‚æœ‰è¿›ä¸€æ­¥çš„åé¦ˆï¼Œå°†ä¼šåšæ›´æ–°ã€‚&lt;/p>
&lt;/blockquote></description></item><item><title>åŸºäºCodeCommitä»£ç ç®¡ç†çš„æ— æœåŠ¡å™¨æ¶æ„Devops</title><link>https://kane.mx/posts/2020/codecommit-devops-model/</link><pubDate>Thu, 26 Mar 2020 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2020/codecommit-devops-model/</guid><description>&lt;p>&lt;a href="https://github.com/">Github&lt;/a>/&lt;a href="https://about.gitlab.com/">Gitlab&lt;/a>å·²ç»æˆä¸ºä¼—å¤šå¼€å‘è€…éå¸¸ç†Ÿæ‚‰çš„ä»£ç åä½œå¹³å°ï¼Œé€šè¿‡ä»–ä»¬å‚ä¸å¼€æºé¡¹ç›®æˆ–å®æ–½ä¼ä¸šå†…éƒ¨é¡¹ç›®åä½œã€‚&lt;/p>
&lt;p>AWSä¹Ÿæä¾›äº†æ‰˜ç®¡çš„ã€åŸºäºGitã€å®‰å…¨ä¸”é«˜å¯ç”¨çš„ä»£ç æœåŠ¡&lt;a href="https://aws.amazon.com/codecommit/">CodeCommit&lt;/a>ã€‚&lt;a href="https://aws.amazon.com/codecommit/">CodeCommit&lt;/a>ä¸»è¦é’ˆå¯¹ä¼ä¸šç”¨æˆ·åœºæ™¯ï¼Œæ‰€ä»¥ä»–å¹¶æ²¡æœ‰ç¤¾äº¤åŠŸèƒ½ä»¥åŠä»£ç ä»“åº“forkåŠŸèƒ½ï¼Œæ˜¯å¦&lt;a href="https://aws.amazon.com/codecommit/">CodeCommit&lt;/a>å°±æ— æ³•å®ç°&lt;a href="https://help.github.com/en/github/collaborating-with-issues-and-pull-requests/about-pull-requests">GithubåŸºäºPull Request&lt;/a>çš„ååŒå·¥ä½œæ¨¡å¼å‘¢ï¼Ÿ&lt;/p>
&lt;p>ç­”æ¡ˆæ˜¯ï¼Œ&lt;a href="https://aws.amazon.com/codecommit/">CodeCommit&lt;/a>å®Œå…¨å¯ä»¥å®ç°&lt;strong>åŸºäºPull Requestçš„ä»£ç åä½œ&lt;/strong>ã€‚ç”±äº&lt;a href="https://git-scm.com/">Git&lt;/a>çš„åˆ†å¸ƒå¼ä»£ç ç®¡ç†ç‰¹æ€§ï¼Œé¦–å…ˆforkä¸Šæ¸¸é¡¹ç›®ä»“åº“ï¼Œå°†ä¿®æ”¹åçš„ä»£ç æäº¤åˆ°forkä»“åº“ï¼Œé€šè¿‡Pull Requestç”³è¯·ä¿®æ”¹è¯·æ±‚åˆå¹¶ã€‚Githubå°†è¿™å¥—åä½œæµç¨‹æ¨å¹¿å¼€æ¥å¹¶è¢«å¼€æºé¡¹ç›®å¹¿æ³›é‡‡ç”¨ã€‚å…¶å®è¿˜æœ‰å¦å¤–çš„Gitä»“åº“ååŒæ–¹å¼æ¥å®Œæˆå¤šäººçš„åä½œå¼€å‘ï¼Œä¾‹å¦‚&lt;a href="https://www.gerritcodereview.com/">Gerrit Code Review&lt;/a>ã€‚ç›®å‰Androidã€Eclipse Foundationä¸‹é¢çš„å„ç§é¡¹ç›®éƒ½åœ¨ä½¿ç”¨Gerritä½œä¸ºååŒå¼€å‘å·¥å…·ã€‚&lt;a href="https://www.gerritcodereview.com/">Gerrit&lt;/a>é€šè¿‡æ§åˆ¶åŒä¸€ä¸ªä»£ç ä»“åº“ä¸­ä¸åŒè§’è‰²çš„ç”¨æˆ·å¯æäº¤ä»£ç åˆ†æ”¯çš„æƒé™æ¥å®ç°ä»£ç è´¡çŒ®ã€Reviewã€æŒç»­é›†æˆä»¥åŠååŒå¼€å‘çš„ã€‚&lt;/p>
&lt;p>&lt;a href="https://aws.amazon.com/codecommit/">CodeCommit&lt;/a>ä½œä¸ºAWSæ‰˜ç®¡çš„æœåŠ¡ï¼ŒåŒIAMè®¤è¯å’Œæˆæƒç®¡ç†åšäº†å¾ˆå¥½çš„é›†æˆã€‚å®Œå…¨å¯ä»¥é€šè¿‡IAM Policyçš„è®¾ç½®ï¼Œä¸ºåŒä¸€ä¸ªä»£ç ä»“åº“ä¸­ä¸åŒç”¨æˆ·è§’è‰²è®¾ç½®ä¸åŒçš„æƒé™ã€‚ä½¿ç”¨ç±»ä¼¼&lt;a href="https://www.gerritcodereview.com/">Gerrit&lt;/a>çš„æƒé™æ§åˆ¶æ€è·¯ï¼Œ&lt;/p>
&lt;ul>
&lt;li>ä»»æ„ä»£ç ä»“åº“&lt;em>åä½œè€…&lt;/em>å¯ä»¥æäº¤ä»£ç åˆ°ç‰¹å®šå«ä¹‰çš„åˆ†æ”¯ï¼Œä¾‹å¦‚ï¼Œ&lt;code>features/*&lt;/code>, &lt;code>bugs/*&lt;/code>ã€‚å¯ä»¥å…è®¸å¤šäººååŒå·¥ä½œåœ¨æŸä¸€ç‰¹å®šåˆ†æ”¯ä¸Šã€‚åä½œè€…åŒæ—¶å¯ä»¥åˆ›å»ºæ–°çš„Pull Requestè¯·æ±‚åˆå¹¶ä»£ç åˆ°ä¸»åˆ†æ”¯ï¼Œä¾‹å¦‚&lt;code>master&lt;/code>æˆ–è€…&lt;code>mainline&lt;/code>ã€‚&lt;/li>
&lt;li>ä»£ç ä»“åº“Master/Owneræœ‰æƒé™åˆå¹¶Pull Requestã€‚&lt;/li>
&lt;li>æ‹’ç»ä»»ä½•äººç›´æ¥æ¨é€ä»£ç åˆ°ä»“åº“ä¸»åˆ†æ”¯ï¼ŒåŒ…æ‹¬ä»“åº“Owner/Adminã€‚&lt;/li>
&lt;li>ç›‘å¬ä»“åº“Pull Requeståˆ›å»ºå’ŒPRæºåˆ†æ”¯æ›´æ–°äº‹ä»¶ï¼Œè‡ªåŠ¨è§¦å‘è¯¥PRå¯¹åº”åˆ†æ”¯çš„automation buildï¼Œç¼–è¯‘ã€æµ‹è¯•ç­‰é€šè¿‡åï¼Œè‡ªåŠ¨ä¸ºPRçš„&lt;code>é€šè¿‡&lt;/code>æŠ•ç¥¨+1ã€‚åä¹‹è‹¥å¤±è´¥ï¼Œåˆ™å–æ¶ˆæŠ•ç¥¨ã€‚&lt;/li>
&lt;li>ä¸ºä»£ç ä»“åº“è®¾ç½®PR Reviewè§„åˆ™ï¼Œè‡³å°‘éœ€è¦æ”¶åˆ°PR automation buildå’Œä»“åº“Master/Owneråˆè®¡ä¸¤ç¥¨&lt;code>é€šè¿‡&lt;/code>æ‰å…è®¸åˆå¹¶ä»£ç ã€‚&lt;/li>
&lt;li>ç›‘å¬ä»£ç ä»“åº“ä¸»åˆ†æ”¯ï¼Œä»»æ„æ–°æäº¤å°†è§¦å‘è‡ªåŠ¨åŒ–å‘å¸ƒBuildã€‚å°†æœ€æ–°å˜æ›´åœ¨æ•´ä¸ªç³»ç»Ÿä¸Šåšé›†æˆã€‚&lt;/li>
&lt;/ul>
&lt;p>æ˜¯ä¸æ˜¯å¾ˆæ£’ï¼å®Œå…¨åšåˆ°äº†Githubã€Github Pull Requestã€Github Action/Travis CIæ•´å¥—devopsååŒå¼€å‘çš„æµç¨‹ã€‚&lt;/p>
&lt;p>åä½œæµç¨‹å¦‚ä¸‹å›¾ï¼Œ
&lt;figure>
&lt;img src="images/codecommit-devops-model.png"
alt="åŸºäºCodeCommitä»£ç ç®¡ç†çš„ååŒæµç¨‹"/>
&lt;/figure>
&lt;/p>
&lt;p>åŒæ—¶ï¼Œä»¥ä¸Šæ•´å¥—åŸºäºCodeCommitä»£ç ç®¡ç†çš„devopså·¥ä½œæµç¨‹å¯ä»¥åˆ©ç”¨CloudFormationå®ç°AWSèµ„æºç¼–æ’ï¼Œå°†Devopsä¾èµ–çš„Infraä½¿ç”¨ä»£ç æ¥åšç®¡ç†ï¼è¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œä¼ä¸šå†…éƒ¨å³ä½¿æœ‰æ•°ç™¾æ•°åƒç”šè‡³æ›´å¤šä»£ç ä»“åº“éƒ½å¯ä»¥ç»Ÿä¸€ç®¡ç†ï¼Œæ–°ä»“åº“çš„ç”³è¯·ä¹Ÿå¯ä»¥é€šè¿‡Infraä»£ç çš„PRï¼Œåœ¨é€šè¿‡å®¡æ‰¹åˆå¹¶åè‡ªåŠ¨ä»AWS provisioningåˆ›å»ºå‡ºç¬¦åˆä¼ä¸šç®¡ç†è¦æ±‚çš„å®‰å…¨ä»£ç ä»“åº“ã€‚å¾ˆé…·å§ğŸ˜†&lt;/p>
&lt;p>&lt;a href="https://github.com/zxkane/cdk-collections/tree/master/codecommit-collaboration-model">è¿™é‡Œ&lt;/a>æœ‰ä¸€å¥—å®Œæ•´çš„åˆ›å»ºä»¥ä¸Šå·¥ä½œæµçš„æ¼”ç¤ºï¼Œæœ‰å…´è¶£çš„è¯»è€…å¯ä»¥åœ¨è‡ªå·±çš„è´¦æˆ·å†…ä½“éªŒã€‚æ•´å¥—æ–¹æ¡ˆå®Œå…¨ä½¿ç”¨çš„æ˜¯AWSæ‰˜ç®¡æœåŠ¡ï¼Œä»…æŒ‰å®é™…ä½¿ç”¨é‡(å¦‚ä½¿ç”¨CodeBuildç¼–è¯‘äº†ä»£ç )è®¡è´¹ã€‚&lt;/p></description></item><item><title>AWSå‘å¸ƒæ›´å¿«ã€æ›´ä¾¿å®œã€æ›´æ˜“ç”¨çš„HTTP APIs</title><link>https://kane.mx/posts/2020/new-http-apis-of-api-gateway/</link><pubDate>Fri, 13 Mar 2020 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2020/new-http-apis-of-api-gateway/</guid><description>&lt;p>AWSåœ¨3æœˆ12æ—¥&lt;a href="https://aws.amazon.com/blogs/compute/building-better-apis-http-apis-now-generally-available/">æ­£å¼å‘å¸ƒäº†æ–°ä¸€ä»£çš„APIç½‘å…³ &amp;ndash; HTTP APIs&lt;/a>ã€‚AWSå‘å¸ƒçš„ç¬¬ä¸€ä»£API GatewayæœåŠ¡å·²ç»å¿«5å¹´äº†ï¼Œé€šè¿‡è¿™äº›å¹´æ¥å¤§è§„æ¨¡æœåŠ¡å®¢æˆ·çš„å¿ƒå¾—ä»¥åŠå®¢æˆ·åé¦ˆï¼Œç”±æ­¤é‡æ–°æ„å»ºäº†æ›´å¿«ï¼ˆç›¸æ¯”ç¬¬ä¸€ä»£ç½‘å…³60%çš„å»¶è¿Ÿå‡å°‘ï¼‰ã€æ›´ä¾¿å®œï¼ˆè‡³å°‘èŠ‚çœ71%çš„è´¹ç”¨ï¼‰ã€æ›´æ˜“ç”¨çš„ç¬¬äºŒä»£ç½‘å…³æœåŠ¡ã€‚&lt;/p>
&lt;p>é™¤äº†æ€§èƒ½ã€è´¹ç”¨ã€æ˜“ç”¨æ€§çš„å¤§å¹…åº¦æ”¹è¿›ä¹‹å¤–ï¼Œåœ¨&lt;a href="https://aws.amazon.com/blogs/compute/building-better-apis-http-apis-now-generally-available/">HTTP APIså‘å¸ƒåšå®¢&lt;/a>ä¸­ç€é‡ä»‹ç»äº†ä»¥ä¸‹æ–°ç‰¹æ€§ï¼Œ&lt;/p>
&lt;ul>
&lt;li>HTTP APIsç½‘å…³å¯åŒç§æœ‰VPCå†…çš„è´Ÿè½½å‡è¡¡(ALB/NLB)ï¼ŒæœåŠ¡å‘ç°(Cloup Map)é›†æˆã€‚æ„å‘³ç€å¯å°†ç›®å‰æœ€æµè¡Œä¸”æ™®éåº”ç”¨çš„å®¹å™¨æœåŠ¡ä½œä¸ºAPIåç«¯&lt;/li>
&lt;li>å¯ä»¥å°†è‡ªå®šä¹‰åŸŸåçš„APIè·¯å¾„æ··åˆæ˜ å°„åˆ°ç¬¬ä¸€ä»£çš„REST APIså’Œæœ€æ–°çš„HTTP APIs&lt;/li>
&lt;li>è¯·æ±‚é™æµçš„æ”¹è¿›ã€‚æ”¯æŒå¯¹ä¸åŒstageä»¥åŠè¯·æ±‚è·¯ç”±åˆ†åˆ«è®¾ç½®ä¸åŒçš„é™æµ&lt;/li>
&lt;li>Stageå˜é‡ã€‚å¯ä»¥å°†Stageå˜é‡ä¼ é€’ç»™APIç½‘å…³åç«¯çš„æœåŠ¡ã€‚åŒæ—¶æ”¯æŒè·¯ç”±åœ¨ä¸åŒçš„stageåŠ¨æ€é›†æˆä¸åŒçš„åç«¯Lambdaå‡½æ•°&lt;/li>
&lt;li>Lambdaé›†æˆæ—¶ä½¿ç”¨Payload version 2.0ã€‚Version 2.0æ ¼å¼æä¾›äº†æ›´å¤šçš„çµæ´»æ€§åŠç®€åŒ–äº†æ•°æ®æ ¼å¼&lt;/li>
&lt;li>æ”¯æŒå¯¼å…¥ Swagger / OpenAPI é…ç½®æ–‡ä»¶&lt;/li>
&lt;/ul>
&lt;p>å¦‚æœå¯¹HTTP APIsæ„Ÿå…´è¶£ï¼Œå¯ä»¥å°è¯•åœ¨è‡ªå·±çš„è´¦æˆ·å†…éƒ¨ç½²&lt;a href="https://github.com/zxkane/cdk-collections/blob/master/batch-demo/README.md#how-to-deploy-batch-demo-app">è¿™ä¸ªç¤ºä¾‹&lt;/a>ã€‚è¿™ä¸ªç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•æŒ‰éœ€ä½¿ç”¨AWS BatchæœåŠ¡è¿›è¡Œæ‰¹é‡ä»»åŠ¡è®¡ç®—ï¼ŒåŒæ—¶å°†ä»»åŠ¡æäº¤å’ŒæŸ¥è¯¢çŠ¶æ€é€šè¿‡HTTPæ¥å£æä¾›å‡ºæ¥ã€‚è¯¥ç¤ºä¾‹æ”¯æŒéƒ¨ç½²æ—¶é€‰ç”¨ä¸åŒçš„AWSæœåŠ¡ï¼ˆALBã€REST APIsæˆ–HTTP APIsï¼‰æ¥æä¾›è¿™äº›APIæ¥å£è®¿é—®ã€‚æ•´ä¸ªç¤ºä¾‹éƒ½æ˜¯åŸºäºæ— æœåŠ¡å™¨æ¶æ„å®ç°çš„ï¼Œä¸è¿›è¡Œæ‰¹é‡è®¡ç®—æ˜¯ä¸äº§ç”Ÿä»»ä½•è´¹ç”¨çš„å“¦ğŸ˜„ã€‚&lt;/p></description></item><item><title>AWS Cloud Debuggingåˆæ¢</title><link>https://kane.mx/posts/2019/aws-cloud-debugging/</link><pubDate>Thu, 26 Dec 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2019/aws-cloud-debugging/</guid><description>&lt;p>åœ¨&lt;a href="https://reinvent.awsevents.com/?nc2=h_ql_re">re:Invent&lt;/a> 2019ä¹‹å‰ï¼Œ&lt;a href="https://aws.amazon.com/getting-started/tools-sdks/?nc2=h_ql_prod_dt_tsdk">AWS Toolkit&lt;/a>å‘å¸ƒäº†&lt;a href="https://aws.amazon.com/about-aws/whats-new/2019/11/announcing-cloud-debugging-beta/?nc1=h_ls">Cloud Debugging beta&lt;/a>åŠŸèƒ½ã€‚è¯¥åŠŸèƒ½æ”¯æŒåœ¨IntelliJ IDEs(IntelliJ, PyCharm, Webstorm, ä»¥åŠ Rider)ä¸­è¿œç¨‹è°ƒè¯• ECS &lt;a href="https://aws.amazon.com/fargate/">Fargate&lt;/a> å®¹å™¨ä¸­æ‰§è¡Œçš„åº”ç”¨ç¨‹åºã€‚&lt;/p>
&lt;p>å¯¹&lt;a href="https://github.com/zxkane/alibabacloud-microservice-demo/tree/cloud-debug">ECS Fargate demo&lt;/a>å¯ç”¨äº†è¿œç¨‹è°ƒè¯•å¹¶è°ƒè¯•æˆåŠŸåï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹è¯¥åŠŸèƒ½çš„ä½¿ç”¨ä½“éªŒå¹¶ä¸”åˆ†äº«ä½“éªŒè¿‡ç¨‹ä¸­æ‰è¿›å»è¿‡çš„ä¸€äº›å‘ã€‚&lt;/p>
&lt;h4 id="è¯•ç”¨ä½“éªŒ">è¯•ç”¨ä½“éªŒ&lt;/h4>
&lt;ul>
&lt;li>é¦–å…ˆï¼Œè¯¥åŠŸèƒ½ä¸é€‚ç”¨äºç”Ÿäº§ç¯å¢ƒã€‚å› ä¸ºå¯¹ECS Fargateç±»å‹çš„Serviceå¯ç”¨&lt;strong>Cloud Debugging&lt;/strong>åŠŸèƒ½ä¼šå°†åŸå§‹çš„&lt;code>ECS Services&lt;/code>æ”¶ç¼©ä¸º&lt;strong>0&lt;/strong>ä¸ªtaskå‰¯æœ¬ï¼ŒåŒæ—¶åˆ›å»ºä¸€ä¸ªæ–°çš„Serviceå¹¶å¯ç”¨æ–°çš„Task Definitionï¼Œæ–°çš„Task Definitionä¸­ä¼šåŠ å…¥&lt;code>Cloud Debug Sidecar&lt;/code>å®¹å™¨æ¥è¾…åŠ©å®ç°è¿œç¨‹è°ƒè¯•ã€‚æ•´ä¸ªè¿‡ç¨‹ä¼šå¯¹ç”Ÿäº§ç¯å¢ƒé€ æˆå˜æ›´ã€‚&lt;/li>
&lt;li>å¦‚æœECSé›†ç¾¤æ˜¯é€šè¿‡CI/CDæŒç»­éƒ¨ç½²ï¼Œå¹¶ä¸”æ˜¯å¤šäººååŒä½¿ç”¨çš„ç¯å¢ƒï¼Œè¯¥åŠŸèƒ½ä¹Ÿä¸é€‚ç”¨ã€‚å› ä¸ºï¼Œå¯¹æŸäº›å®¹å™¨æœåŠ¡å¯ç”¨&lt;code>Cloud Debugging&lt;/code>å°†å¯¼è‡´ä»–äººçš„æŒç»­éƒ¨ç½²å¤±è´¥æˆ–ä¸ç”Ÿæ•ˆã€‚&lt;/li>
&lt;li>å¯ç”¨&lt;code>Cloud Debugging&lt;/code>æ“ä½œæ¯”è¾ƒéº»çƒ¦ï¼Œä¸”å¯ç”¨çŠ¶æ€ä¸‹æ— æ³•æ›´æ–°ECSä¸­éƒ¨ç½²çš„ç‰ˆæœ¬ã€‚éœ€è¦å…ˆåœç”¨&lt;code>Cloud Debugging&lt;/code>ï¼Œéƒ¨ç½²æ–°ç‰ˆæœ¬ä»£ç ï¼Œç„¶åå†æ¬¡å¯ç”¨&lt;code>Cloud Debugging&lt;/code>æ‰èƒ½è°ƒè¯•æ–°ä»£ç ã€‚å°½å¯èƒ½çš„ä¸è¦ä¾èµ–&lt;code>Cloud Debugging&lt;/code>æ¥è°ƒè¯•ç¨‹åºï¼ŒèŠ±åŠŸèƒ½åšå¥½å•å…ƒæµ‹è¯•ï¼Œé›†æˆæµ‹è¯•ä»¥åŠE2Eæµ‹è¯•æ¥é¿å…è°ƒè¯•äº‘ç«¯ç¯å¢ƒã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="è¯•ç”¨ç»éªŒ">è¯•ç”¨ç»éªŒ&lt;/h4>
&lt;ul>
&lt;li>æŒ‰ç…§&lt;a href="https://docs.aws.amazon.com/zh_cn/toolkit-for-jetbrains/latest/userguide/ecs-debug.html#ecs-prereqs">å®˜æ–¹æ–‡æ¡£å¯ç”¨&lt;code>Cloud Debugging&lt;/code>&lt;/a>åï¼Œåˆ›å»º&lt;a href="https://docs.aws.amazon.com/zh_cn/toolkit-for-jetbrains/latest/userguide/edit-configuration-dialog.html#edit-configuration-dialog-ecs">Cloud Debugging Launch Configuration&lt;/a>å¹¶æ‰§è¡Œè°ƒè¯•ï¼Œé‡åˆ°**&lt;code>Retrieve execution role finished exceptionally&lt;/code>**é”™è¯¯ã€‚é”™è¯¯çš„åŸå› æ˜¯ï¼Œæ–‡æ¡£ä¸­æ²¡æœ‰æåˆ°&lt;code>Cloud Debug Sidecar&lt;/code>éœ€è¦&lt;code>logs:CreateLogStream&lt;/code>æƒé™åˆ›å»ºCloudWatch Logs Streamã€‚è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œä¸ºECS Task Execution Roleæ·»åŠ &lt;code>logs:CreateLogStream&lt;/code>æƒé™ã€‚&lt;/li>
&lt;li>åœ¨&lt;a href="https://github.com/aws/aws-toolkit-jetbrains">AWS Toolkit Jetbrains&lt;/a>å½“å‰çš„ç‰ˆæœ¬&lt;em>1.9-193&lt;/em>ä¸æ”¯æŒå¯ç”¨äº†&lt;a href="https://github.com/aws/aws-toolkit-jetbrains/issues/1463">AppMesh&lt;/a>æˆ–&lt;a href="https://github.com/aws/aws-toolkit-jetbrains/issues/1464">X-Ray&lt;/a>çš„Taskã€‚è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œå¯¹éœ€è¦å¯ç”¨&lt;code>Cloud Debugging&lt;/code>çš„Taskæš‚æ—¶ç¦ç”¨App Meshå’ŒX-Rayã€‚&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>&lt;code>Cloud Debugging&lt;/code>æ˜¯ä¸€ä¸ªä¸é”™çš„å¼€å‘å·¥å…·å°è¯•æ€è·¯ï¼Œå¸®åŠ©å¼€å‘è€…æ›´å¥½çš„åšå‡ºCloud Nativeåº”ç”¨ã€‚ä½†æ˜¯è¯¥é¡¹ç›®ä»ç„¶æ˜¯ä¸€ä¸ªæ—©æœŸé¡¹ç›®ï¼Œæœ‰è®¸å¤šé—®é¢˜éœ€è¦ä¿®å¤å’Œæ”¹è¿›ã€‚&lt;/p>
&lt;/blockquote></description></item><item><title>AWS Batchç®€ä»‹</title><link>https://kane.mx/posts/2019/aws-batch/</link><pubDate>Wed, 25 Dec 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2019/aws-batch/</guid><description>&lt;p>&lt;a href="https://aws.amazon.com/batch/">AWS Batch&lt;/a>æ˜¯ä¸€ä¸ªå…¨æ‰˜ç®¡çš„æ‰¹å¤„ç†è°ƒåº¦æœåŠ¡ï¼Œå®ƒå¯ä¸ºç”¨æˆ·ç®¡ç†æ‰€æœ‰åŸºç¡€è®¾æ–½ï¼Œä»è€Œé¿å…äº†é¢„ç½®ã€ç®¡ç†ã€ç›‘æ§å’Œæ‰©å±•æ‰¹å¤„ç†è®¡ç®—ä½œä¸šæ‰€å¸¦æ¥çš„å¤æ‚æ€§ã€‚å½“ç„¶&lt;a href="https://aws.amazon.com/batch/">AWS Batch&lt;/a>å·²ä¸ AWS å¹³å°åŸç”Ÿé›†æˆï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿåˆ©ç”¨ AWS çš„æ‰©å±•ã€è”ç½‘å’Œè®¿é—®ç®¡ç†åŠŸèƒ½ã€‚è®©ç”¨æˆ·è½»æ¾è¿è¡Œèƒ½å¤Ÿå®‰å…¨åœ°ä» AWS æ•°æ®å­˜å‚¨ï¼ˆå¦‚ Amazon S3 å’Œ Amazon DynamoDBï¼‰ä¸­æ£€ç´¢æ•°æ®å¹¶å‘å…¶ä¸­å†™å…¥æ•°æ®çš„ä½œä¸šã€‚&lt;a href="https://aws.amazon.com/batch/">AWS Batch&lt;/a>å¯æ ¹æ®æ‰€æäº¤çš„æ‰¹å¤„ç†ä½œä¸šçš„æ•°é‡å’Œèµ„æºè¦æ±‚é¢„ç½®è®¡ç®—èµ„æºå¹¶ä¼˜åŒ–ä½œä¸šåˆ†é…ã€‚èƒ½å¤Ÿå°†è®¡ç®—èµ„æºåŠ¨æ€æ‰©å±•è‡³è¿è¡Œæ‰¹å¤„ç†ä½œä¸šæ‰€éœ€çš„ä»»ä½•æ•°é‡ï¼Œä»è€Œä¸å¿…å—å›ºå®šå®¹é‡é›†ç¾¤çš„é™åˆ¶ã€‚&lt;a href="https://aws.amazon.com/batch/">AWS Batch&lt;/a>è¿˜å¯ä»¥åˆ©ç”¨ Spot å®ä¾‹ï¼Œä»è€Œè¿›ä¸€æ­¥é™ä½è¿è¡Œæ‰¹å¤„ç†ä½œä¸šäº§ç”Ÿçš„è´¹ç”¨ã€‚&lt;/p>
&lt;p>&lt;a href="https://aws.amazon.com/batch/">AWS Batch&lt;/a>æœåŠ¡æœ¬èº«æ˜¯&lt;strong>å…è´¹&lt;/strong>çš„ï¼Œä»…æ”¶å–å®é™…ä½¿ç”¨çš„ EC2 å®ä¾‹è´¹ç”¨ã€‚&lt;/p>
&lt;p>æˆ‘åˆ›å»ºäº†ä¸€ä¸ª&lt;a href="https://github.com/zxkane/cdk-collections/blob/master/batch-demo/README.md">Batch App demo&lt;/a>æ¥æ¼”ç¤º&lt;a href="https://aws.amazon.com/batch/">AWS Batch&lt;/a>ç›¸å…³ä½¿ç”¨æ–¹æ³•ã€‚è¯¥ç¤ºä¾‹é€šè¿‡ä¸€ä¸ªRestful APIæ¥å£æ¥æäº¤æ‰¹å¤„ç†ä»»åŠ¡ï¼ŒRestful APIé€šè¿‡&lt;a href="https://aws.amazon.com/cn/elasticloadbalancing/">ALB&lt;/a> + &lt;a href="https://aws.amazon.com/cn/lambda/">Lambdaå‡½æ•°&lt;/a>æ¥æš´éœ²æœåŠ¡ã€‚Lambdaå‡½æ•°è¢«è§¦å‘åï¼Œå°†æ–°ä»»åŠ¡è¯·æ±‚å‘é€åˆ°&lt;a href="https://aws.amazon.com/cn/sqs/">SQS&lt;/a>æœåŠ¡ã€‚éšåå¦ä¸€ä¸ªLambdaå°†æ¶ˆè´¹è¿™ä¸ªSQSï¼Œå¹¶å°†è°ƒç”¨&lt;a href="https://aws.amazon.com/batch/">AWS Batch&lt;/a> APIæ¥æäº¤æ–°çš„æ‰¹å¤„ç†ä»»åŠ¡ï¼ŒåŒæ—¶å°†ä»»åŠ¡ä¿¡æ¯å‚¨å­˜åˆ°&lt;a href="https://aws.amazon.com/cn/dynamodb/">DynamoDB&lt;/a>ä¸­ã€‚åŒæ—¶Demoåˆ›å»ºäº†Batchä»»åŠ¡ä¼šä½¿ç”¨åˆ°çš„Docker Imageï¼Œå¹¶ä¸”é¢„å…ˆæäº¤åˆ°&lt;a href="https://aws.amazon.com/cn/ecr/">ECR&lt;/a>ä¸­ã€‚åŒæ—¶Batchä»»åŠ¡å®šä¹‰äº†ä½¿ç”¨çš„EC2å®ä¾‹ç±»å‹(c5ç³»åˆ—å®ä¾‹ï¼Œä¸”åŒ…æ‹¬Spotå’ŒæŒ‰éœ€ä¸¤ç§è®¡è´¹æ–¹å¼çš„å®ä¾‹ï¼Œä¸”ä¼˜å…ˆä½¿ç”¨Spotå®ä¾‹)ï¼Œå®ä¾‹é»˜è®¤ä¼¸ç¼©æ•°é‡ä¸º0(æ²¡æœ‰å¯æ‰§è¡Œä»»åŠ¡æ—¶å°†ä¸­æ­¢å®ä¾‹)ã€‚å¹¶ä¸”æäº¤çš„ä»»åŠ¡åˆ†ä¸ºè®¡ç®—ä»»åŠ¡å’Œç»Ÿè®¡å½’å¹¶ä»»åŠ¡ï¼Œç»Ÿè®¡å½’å¹¶ä»»åŠ¡ä¼šä¾èµ–æ‰€ä»¥è®¡ç®—ä»»åŠ¡æ‰§è¡Œå®Œæ¯•æ‰å¼€å§‹æ‰§è¡Œã€‚æœ€åé€šè¿‡å¦ä¸€Restfulæ¥å£æŸ¥è¯¢è®¡ç®—ä»»åŠ¡çš„æœ€ç»ˆç»“æœï¼Œè¯¥æ¥å£åŒæ ·ä½¿ç”¨&lt;a href="https://aws.amazon.com/cn/elasticloadbalancing/">ALB&lt;/a> + &lt;a href="https://aws.amazon.com/cn/lambda/">Lambdaå‡½æ•°&lt;/a>æ¥å®ç°ã€‚&lt;/p>
&lt;figure>
&lt;img src="https://kane.mx/posts/2019/aws-batch/aws-batch-app-demo.png"
alt="Batch Appæ¶æ„å›¾"/>
&lt;/figure>
&lt;p>Enjoy this &lt;a href="https://github.com/zxkane/cdk-collections/blob/master/batch-demo/README.md">Batch App demo&lt;/a> orchestrated by &lt;a href="https://aws.amazon.com/cn/cdk/">AWS CDK&lt;/a>.&lt;/p></description></item><item><title>å…è´¹é‚®ä»¶è½¬å‘æœåŠ¡</title><link>https://kane.mx/posts/2019/email-forwarding/</link><pubDate>Wed, 18 Dec 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2019/email-forwarding/</guid><description>&lt;p>åœ¨æ‹¥æœ‰åŸŸååï¼Œé€šå¸¸å¸Œæœ›åˆ›å»ºä¸€äº›è‡ªæœ‰åŸŸåä¸‹çš„é‚®ç®±æ¥æ”¶å–ä¸åŒç”¨é€”çš„é‚®ä»¶ï¼ŒåŒæ—¶ä¸å¸Œæœ›ä¸ºè¿™éƒ¨åˆ†åŠŸèƒ½ä»˜è´¹ğŸ˜ƒã€‚ä½¿ç”¨å…è´¹çš„ä¼ä¸šé‚®ç®±(æ¯”å¦‚ç½‘æ˜“ä¼ä¸šé‚®ç®±ã€é˜¿é‡Œäº‘ä¼ä¸šé‚®ç®±)æ˜¯ä¸€ç§é€‰æ‹©ã€‚è¿™æ—¶å°±éœ€è¦é…ç½®é‚®ä»¶åœ°å€å’Œé‚®ä»¶å®¢æˆ·ç«¯æ¥æ”¶å–é‚®ä»¶ï¼Œå¦‚æœæœ‰å¤šä¸ªé‚®ç®±åœ°å€ï¼Œé…ç½®ä¼šç‰¹åˆ«éº»çƒ¦ã€‚æœ‰æ—¶ï¼Œè¿™äº›ä¼ä¸šé‚®ç®±çš„æ”¶ä»¶æœåŠ¡ä¼šè«åå…¶å¦™çš„ä¸¢å¤±ä¸€äº›é‚®ä»¶ã€‚&lt;/p>
&lt;p>è¿™ç§åœºæ™¯ä¸‹ï¼Œ&lt;strong>é‚®ä»¶è½¬å‘æœåŠ¡&lt;/strong>æ˜¯ä¸€ç§éå¸¸å¥½çš„è§£å†³æ–¹æ¡ˆã€‚æ— éœ€æ­å»ºé‚®ä»¶æœåŠ¡å™¨æˆ–ç”³è¯·å…è´¹é‚®ä»¶æœåŠ¡ï¼Œåªéœ€è¦é…ç½®åŸŸåçš„&lt;strong>é‚®ä»¶MX&lt;/strong>è§£æåˆ°è½¬å‘é‚®ä»¶æ”¶å‘ä»¶æœåŠ¡ï¼ŒåŒæ—¶ä½¿ç”¨&lt;strong>DNS TXT&lt;/strong> recordé…ç½®è½¬å‘è§„åˆ™ï¼Œå³å¯å°†æ‰€ä»¥å‘é€çš„è‡ªæœ‰åŸŸåä¸‹çš„é‚®ä»¶è½¬å‘åˆ°å·²æœ‰çš„é‚®ç®±åœ°å€ï¼ğŸ†’&lt;/p>
&lt;p>ç‰¹åˆ«å®‰åˆ©&lt;a href="https://github.com/forwardemail/free-email-forwarding">Forward Email&lt;/a>æœåŠ¡ï¼Œä¸€ä¸ªå…è´¹è€Œä¸”æ˜¯&lt;strong>å¼€æº&lt;/strong>çš„é‚®ä»¶è½¬å‘æœåŠ¡ã€‚&lt;/p>
&lt;p>å¦‚ä¸Šé¢ä»‹ç»çš„ï¼Œåªéœ€è¦ä¸ºåŸŸå&lt;code>mydomain.com&lt;/code>åˆ›å»ºå¦‚ä¸‹3æ¡DNSè§£æè®°å½•ï¼Œ&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>åç§°&lt;/th>
&lt;th>TTL&lt;/th>
&lt;th>è®°å½•ç±»å‹&lt;/th>
&lt;th>ä¼˜å…ˆçº§&lt;/th>
&lt;th>è®°å½•çš„å†…å®¹&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>@ æˆ–è€… ç©ºç™½&lt;/td>
&lt;td>3600&lt;/td>
&lt;td>MX&lt;/td>
&lt;td>10&lt;/td>
&lt;td>mx1.forwardemail.net&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>@ æˆ–è€… ç©ºç™½&lt;/td>
&lt;td>3600&lt;/td>
&lt;td>MX&lt;/td>
&lt;td>20&lt;/td>
&lt;td>mx2.forwardemail.net&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>@ æˆ–è€… ç©ºç™½&lt;/td>
&lt;td>3600&lt;/td>
&lt;td>TXT&lt;/td>
&lt;td>20&lt;/td>
&lt;td>&lt;a href="mailto:forward-email=niftylettuce@gmail.com">forward-email=niftylettuce@gmail.com&lt;/a>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>æ‰€æœ‰å‘å¾€&lt;code>@mydomain.com&lt;/code>çš„é‚®ä»¶å°†è¢«è½¬å‘åˆ°é‚®ç®±&lt;code>niftylettuce@gmail.com&lt;/code>ã€‚âœŒï¸&lt;/p>
&lt;p>æ›´å¤šé…ç½®é€‰é¡¹è¯·æŸ¥çœ‹&lt;a href="https://github.com/forwardemail/free-email-forwarding#how-do-i-get-started-and-set-up-email-forwarding">æ–‡æ¡£&lt;/a>ã€‚&lt;/p></description></item><item><title>å®æˆ˜Aliyun EDASåº”ç”¨è¿ç§»AWS</title><link>https://kane.mx/posts/2019/aliyun-edas-migration-in-action/</link><pubDate>Mon, 02 Dec 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2019/aliyun-edas-migration-in-action/</guid><description>&lt;p>è¿‘æœŸå®è·µäº†å°†é˜¿é‡Œäº‘EDASå¾®æœåŠ¡åº”ç”¨è¿ç§»åˆ°AWSä¸Šï¼Œåœ¨è¿™é‡Œåˆ†äº«ä¸€ä¸‹è¿ç§»æ–¹æ¡ˆã€‚&lt;/p>
&lt;p>è¯¥æ–¹æ¡ˆæ¶‰åŠäº†ä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢ï¼Œ&lt;/p>
&lt;ol>
&lt;li>å¾®æœåŠ¡åº”ç”¨é›†ç¾¤ã€‚åœ¨AWSä¸Šé‡‡ç”¨çš„&lt;a href="https://aws.amazon.com/cn/ecs/">ECS&lt;/a>é›†ç¾¤éƒ¨ç½²å¾®æœåŠ¡åº”ç”¨ï¼Œé€šè¿‡&lt;a href="https://aws.amazon.com/cn/cloud-map/">Cloudmap&lt;/a>å®ç°æœåŠ¡æ³¨å†Œå‘ç°ï¼Œ&lt;a href="https://aws.amazon.com/cn/app-mesh/">App Mesh&lt;/a>å®ç°æœåŠ¡é—´æµé‡æ§åˆ¶ã€‚æ›´åŠ è¯¦å°½çš„å¾®æœåŠ¡è¿ç§»è¦ç‚¹å’Œå¯¹åº”æ–¹æ¡ˆï¼Œè¯¦è§ä¸‹é¢çš„deckã€‚&lt;/li>
&lt;li>Devops pipelineã€‚ä½¿ç”¨æ‰˜ç®¡çš„&lt;a href="https://aws.amazon.com/cn/codepipeline/">CodePipeline&lt;/a>ï¼Œ&lt;a href="https://aws.amazon.com/cn/codebuild/">CodeBuild&lt;/a>å®ç°CI/CDã€‚&lt;/li>
&lt;li>Infra as Codeã€‚åˆ©ç”¨AWSå¼ºå¤§çš„&lt;a href="https://en.wikipedia.org/wiki/Infrastructure_as_code">Infra as Code&lt;/a>èƒ½åŠ›ï¼Œå°†äº‘ä¸Šçš„åŸºç¡€è®¾æ–½å’Œå¾®æœåŠ¡åº”ç”¨ç¼–æ’é€šè¿‡&lt;a href="https://kane.mx/posts/2019/aws-cdk/">CDK&lt;/a>ä»£ç å®ç°ã€‚&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>ä¸‹é¢æ˜¯è¿ç§»æ–¹æ¡ˆçš„deckã€‚å®Œæ•´ä¸”å¯éƒ¨ç½²çš„PoCä»£ç ï¼Œç‚¹&lt;a href="https://github.com/zxkane/alibabacloud-microservice-demo">è¿™é‡Œ&lt;/a>ã€‚&lt;/p>
&lt;/blockquote>
&lt;div class="responsive-wrap">
&lt;iframe src="https://docs.google.com/presentation/d/e/2PACX-1vRrD1lBxjbGsI0xIX8XTzUyJzDqnaqW97d6jGASdatRPYUkciSwxbeCJFQv-gwZLcZ31DFPXQtvmob1/embed?start=false&amp;amp;loop=false&amp;amp;delayms=5000" frameborder="0" width="960" height="569" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true">&lt;/iframe>
&lt;/div></description></item><item><title>AWS RDSæ•°æ®åº“æ—¥å¿—åˆ†æåŠå±•ç¤º</title><link>https://kane.mx/posts/2019/rds-log-analysis/</link><pubDate>Tue, 05 Nov 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2019/rds-log-analysis/</guid><description>&lt;p>æ‰˜ç®¡çš„RDSæ•°æ®åº“å·²ç»æ˜¯äº‘è®¡ç®—æœåŠ¡ä¸­éå¸¸æˆç†Ÿçš„æœåŠ¡ï¼Œç»å¤§éƒ¨åˆ†çš„äº‘è®¡ç®—ç”¨æˆ·ä¼šé‡‡ç”¨RDSæœåŠ¡æ¥æå‡æ•°æ®åº“æœåŠ¡çš„å¯ç”¨æ€§åŒæ—¶å‡å°‘æ•°æ®åº“çš„å„ç±»è¿ç»´äº‹åŠ¡ã€‚&lt;/p>
&lt;p>AWS RDSæœåŠ¡æ”¯æŒå¼€å¯å’ŒæŸ¥è¯¢å„ç±»çš„æ•°æ®åº“æ—¥å¿—ï¼ŒåŒ…æ‹¬å¸¸è§„æ—¥å¿—ã€æ…¢æ—¥å¿—ã€é”™è¯¯æ—¥å¿—å’Œå®¡è®¡æ—¥å¿—ã€‚ä½†RDSæœåŠ¡é»˜è®¤æä¾›çš„æ—¥å¿—æŸ¥çœ‹å·¥å…·ä»…ä»…ç±»ä¼¼æ–‡æœ¬æŸ¥çœ‹å™¨ï¼Œæ— æ³•é’ˆå¯¹æ—¥å¿—æ•°æ®åšç»Ÿè®¡å’ŒæŸ¥çœ‹å†å²æ»šåŠ¨çš„å­˜æ¡£ã€‚&lt;/p>
&lt;p>æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨AWSä¸Šäº‘åŸç”Ÿçš„æœåŠ¡æ­å»ºæ— æœåŠ¡æ¶æ„çš„å®æ—¶æ—¥å¿—åˆ†ææŠ¥è¡¨ç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿçš„å®ç°æ€è·¯æ¥è‡ªäºAWSä¸­å›½çš„&lt;a href="https://aws.amazon.com/cn/blogs/china/cloudwatch-logs-kinesis-firehose-athena-quicksight-amazon-aurora/">ä¸€ç¯‡åšå®¢&lt;/a>ï¼Œè¯¥æ–‡ä»‹ç»äº†ä½¿ç”¨ CloudWatch Logsï¼ŒKinesis Firehoseï¼ŒAthena å’Œ Quicksight å®ç°å®æ—¶åˆ†æ Amazon Aurora æ•°æ®åº“å®¡è®¡æ—¥å¿—ã€‚&lt;/p>
&lt;p>è¿™é‡Œæä¾›äº†ä¸€ä¸ªå®Œæ•´çš„&lt;a href="https://github.com/zxkane/cdk-collections/tree/master/rds-audit-log">AWS CDKåº”ç”¨&lt;/a>å®ç°äº†åšå®¢ä¸­ä»‹ç»çš„æœåŠ¡æ­å»ºæ€è·¯ï¼ŒRDSå®¡è®¡æ—¥å¿—é€šè¿‡ CloudWatch Log -&amp;gt; Kinesis Firehose -&amp;gt; S3 è¿™æ ·ä¸€ä¸ªæ•°æ®ç®¡é“è¢«è¿‡æ»¤ï¼Œè½¬æ¢ï¼Œå‹ç¼©æœ€ç»ˆä¿å­˜åˆ°S3ä¸Šï¼Œå¯è¢«æ— æœåŠ¡åˆ†ææœåŠ¡Athenaä½¿ç”¨ã€‚åŒæ—¶åˆ›å»ºäº†ä¸€ä¸ªLambdaå‡½æ•°æ¨¡æ‹Ÿåº”ç”¨è®¿é—®æ•°æ®åº“ï¼Œå®ƒå‘¨æœŸæ€§çš„è¿æ¥ä¸Šåº”ç”¨ä¸­åˆ›å»ºçš„RDS Auroraæ•°æ®åº“å¹¶æ‰§è¡ŒæŸ¥è¯¢æˆ–å˜æ›´Sqlã€‚åœ¨æ•´ä¸ªåº”ç”¨åœ¨è¢«éƒ¨ç½²æˆåŠŸåæ•°åˆ†é’Ÿï¼ŒåŠå¯é€šè¿‡Athenaæ•°æ®è¡¨æŸ¥è¯¢ç»Ÿè®¡Auroraå®¡è®¡æ—¥å¿—ã€‚Enjoy itğŸ˜†ğŸ˜†&lt;/p></description></item><item><title>ä½¿ç”¨Openswanè¿æ¥AWS VPC</title><link>https://kane.mx/posts/2019/using-openswan-connect-aws-vpn/</link><pubDate>Mon, 16 Sep 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2019/using-openswan-connect-aws-vpn/</guid><description>&lt;p>ä¸šåŠ¡ä¸Šäº‘ä¹‹åï¼Œç»å¸¸ä¹Ÿæœ‰éœ€æ±‚å°†å¤šäº‘ã€æ•°æ®ä¸­å¿ƒæˆ–åŠå…¬å®¤çš„ç§æœ‰ç½‘ç»œåŒäº‘ç«¯çš„ç§æœ‰ç½‘ç»œå»ºç«‹è¿æ¥ã€‚&lt;a href="https://docs.aws.amazon.com/zh_cn/vpn/latest/s2svpn/VPC_VPN.html">AWS Site-to-Site VPN&lt;/a>æ­£æ˜¯AWSæä¾›çš„æ‰˜ç®¡VPNæœåŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¦ä¸€ç«¯çš„ç§æœ‰ç½‘ç»œé€šè¿‡&lt;a href="https://www.openswan.org/">Openswan&lt;/a>åŒAWS VPCç½‘ç»œå»ºç«‹åŸºäºIPSecåè®®çš„å®‰å…¨è¿æ¥ã€‚&lt;/p>
&lt;p>ä¸‹é¢æ˜¯é…ç½®çš„è¯¦ç»†æ­¥éª¤ï¼Œ&lt;/p>
&lt;ol>
&lt;li>å¦‚æœæ˜¯åˆ›å»ºæ•°æ®ä¸­å¿ƒæˆ–åŠå…¬å®¤çš„è¿æ¥ï¼Œæ•°æ®ä¸­å¿ƒæˆ–åŠå…¬å®¤éœ€è¦æœ‰å…¬ç½‘IPã€‚å¦‚æœæ˜¯åœ¨å…¶ä»–å…¬æœ‰äº‘ä¸Šï¼Œéœ€è¦åˆ›å»ºå¸¦å…¬ç½‘IPçš„EC2ï¼Œæˆ–ä½¿ç”¨EIPã€‚
&lt;ol>
&lt;li>å¦‚æœä½¿ç”¨AWS EC2é…ç½®Openswanï¼Œéœ€è¦ç¦ç”¨ EC2 çš„ Source/Destination Checkã€‚&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>åœ¨AWSä¸Šåˆ›å»ºVirtual Private Gateway å’Œ Customer Gateway(æŒ‡å®šå¯¹ç«¯çš„å…¬ç½‘IPä½œä¸ºé™æ€è·¯ç”±)ã€‚&lt;/li>
&lt;li>åœ¨AWSä¸Šåˆ›å»ºSite-to-Site VPNè¿æ¥ï¼Œä½¿ç”¨ç¬¬ä¸€æ­¥å’Œç¬¬äºŒæ­¥åˆ›å»ºçš„Virtual Private Gatewayå’ŒCustomer Gatewayã€‚&lt;/li>
&lt;li>åœ¨å¯¹ç«¯æœºå™¨ä¸Šå®‰è£…&lt;code>openswan&lt;/code>ã€‚
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">sudo yum install openswan&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>ç¼–è¾‘&lt;code>/etc/sysctl.conf&lt;/code>æ–‡ä»¶ï¼Œç¡®ä¿æœ‰ä»¥ä¸‹é…ç½®ï¼Œ
&lt;pre>&lt;code class="language-properties" data-lang="properties">net.ipv4.ip_forward = 1
net.ipv4.conf.default.rp_filter = 0
net.ipv4.conf.default.accept_source_route = 0&lt;/code>&lt;/pre>&lt;/li>
&lt;li>é‡æ–°åŠ è½½sysctlé…ç½®å¹¶é‡å¯networkæœåŠ¡ã€‚
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">sudo sysctl -p
sudo service network restart&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>ç¼–è¾‘&lt;code>/etc/ipsec.conf&lt;/code>ç¡®ä¿&lt;code>include /etc/ipsec.d/*.conf&lt;/code>æ²¡æœ‰è¢«æ³¨é‡Šã€‚&lt;/li>
&lt;li>åˆ›å»º&lt;code>/etc/ipsec.d/aws.conf&lt;/code>æ–‡ä»¶ï¼Œå†…å®¹æ‹·è´æ¥è‡ªç¬¬ä¸‰æ­¥åˆ›å»ºçš„è¿æ¥Openswanå»ºè®®é…ç½®ã€‚&lt;/li>
&lt;li>åˆ›å»º&lt;code>/etc/ipsec.d/aws.secrets&lt;/code>æ–‡ä»¶ï¼Œå†…å®¹æ‹·è´æ¥è‡ªç¬¬ä¸‰æ­¥åˆ›å»ºçš„è¿æ¥Openswané…ç½®ã€‚&lt;/li>
&lt;li>å¯åŠ¨ipsecæœåŠ¡ã€‚
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">&lt;span style="color:#75715e"># Start the ipsec service.&lt;/span>
sudo service ipsec start
&lt;span style="color:#75715e"># Check the logs.&lt;/span>
sudo service ipsec status
sudo ipsec auto --status&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol>
&lt;p>ä»¥ä¸Šé…ç½®åœ¨Amazon Linux, Centos 6.9ä¸ŠéªŒè¯é€šè¿‡ã€‚ä½†æ˜¯åœ¨Amazon Linux 2ã€Centos 7ç­‰è¾ƒæ–°çš„Linuxå‘è¡Œç‰ˆæœ¬ä¸Šï¼Œå¯åŠ¨&lt;code>ipsec&lt;/code>æœåŠ¡é‡åˆ°å¦‚ä¸‹é”™è¯¯ï¼Œ
&lt;pre>&lt;code class="language-log" data-lang="log">Starting Internet Key Exchange (IKE) Protocol Daemon for IPsec...
ERROR: /etc/ipsec.d/aws.conf: 12: keyword auth, invalid value: esp&lt;/code>&lt;/pre>
è§£å†³æ–¹æ³•æ˜¯ï¼Œä» AWS Site-to-Site VPN ä¸‹è½½çš„ Openswan é…ç½®ä¸­åˆ æ‰ä¸æ”¯æŒçš„é…ç½®è¡Œ&lt;code>auth=esp&lt;/code>ã€‚&lt;/p></description></item><item><title>AWS CDKç®€ä»‹</title><link>https://kane.mx/posts/2019/aws-cdk/</link><pubDate>Sun, 08 Sep 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2019/aws-cdk/</guid><description>&lt;p>&lt;a href="https://en.wikipedia.org/wiki/Infrastructure_as_code">Infrastructure as Code&lt;/a>(æ¶æ„å³ä»£ç )ä¸€ç›´æ˜¯è¡¡é‡å…¬æœ‰äº‘æ˜¯å¦æ”¯æŒè‰¯å¥½è¿ç»´èƒ½åŠ›çš„é‡è¦æŒ‡æ ‡ã€‚ä½œä¸ºäº‘è®¡ç®—é¢†å…ˆçš„AWSï¼Œé€šè¿‡æœåŠ¡&lt;a href="https://aws.amazon.com/cn/cloudformation/">CloudFormation&lt;/a>æ¥ç¼–æ’äº‘ç¯å¢ƒä¸­çš„åŸºç¡€è®¾æ–½èµ„æºã€‚ä¸è¿‡ç”±äºCloudFormationæ˜¯ä½¿ç”¨YAML/JSONç¼–å†™çš„å£°æ˜å¼è¯­è¨€ï¼Œä¸å–„äºå¤„ç†é€»è¾‘ï¼Œç¼–å†™ç¹çä¸”ä¸åˆ©äºè°ƒè¯•æ’é”™ï¼Œå¯¹äºæ–°ä¸Šæ‰‹çš„Devopså·¥ç¨‹å¸ˆæ¥è¯´ä¹Ÿæœ‰ä¸å°çš„å­¦ä¹ æ›²çº¿ã€‚ä¸‰æ–¹å¼€æºçš„å·¥å…·&lt;a href="https://en.wikipedia.org/wiki/Terraform_(software)">Terraform&lt;/a>åŒæ ·æ²¡æœ‰å¾ˆå¥½è§£å†³&lt;a href="https://aws.amazon.com/cn/cloudformation/">CloudFormation&lt;/a>å­˜åœ¨çš„è¿™äº›é—®é¢˜ã€‚&lt;/p>
&lt;p>&lt;a href="https://aws.amazon.com/cn/cdk/">AWS CDK&lt;/a>çš„å‡ºç°è§£å†³äº†ç›®å‰&lt;a href="https://aws.amazon.com/cn/cloudformation/">CloudFormation&lt;/a>å­˜åœ¨çš„ç»å¤§éƒ¨åˆ†é—®é¢˜ï¼Œæå¤§çš„æå‡åŸºç¡€è®¾æ–½ç¼–æ’ä»£ç çš„å¼€å‘å’Œç»´æŠ¤æ•ˆç‡ã€‚&lt;/p>
&lt;p>AWS CDKæ˜¯ä¸€ç§å¼€æºè½¯ä»¶å¼€å‘æ¡†æ¶ï¼Œå¼€å‘è€…å¯ä»¥ç”¨è‡ªå·±ä½¿ç”¨ç†Ÿæ‚‰çš„ç¼–ç¨‹è¯­è¨€æ¨¡æ‹Ÿå’Œé¢„ç½®äº‘åº”ç”¨ç¨‹åºèµ„æºï¼Œç›®å‰æ”¯æŒTypescript/Javascriptã€Pythonã€Javaå’Œ.Netã€‚AWS CDKå°†äº‘ä¸­èµ„æºæŠ½è±¡å¯¹è±¡åŒ–ï¼Œé€šè¿‡æå…¶ç®€å•è¯­æ³•æè¿°èµ„æºå¯¹è±¡æˆ–è®¾ç½®å…¶å„ç§å±æ€§(é‡è½½CDKé»˜è®¤å±æ€§è®¾ç½®)æ¥åˆ›å»ºæˆ–æ›´æ–°äº‘ä¸­èµ„æºã€‚&lt;/p>
&lt;p>ä¾‹å¦‚ï¼Œä¸‹é¢ç®€å•å‡ è¡Œå°†åˆ›å»ºä¸€ä¸ªæ–°çš„åä¸º&lt;code>Gameday&lt;/code>çš„VPCç½‘ç»œï¼Œå¹¶ä¸”è·¨äº†ä¸¤ä¸ªå¯ç”¨åŒºåˆ†åˆ«åˆ›å»ºäº†å…¬æœ‰å­ç½‘å’Œç§æœ‰å­ç½‘ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-typescript" data-lang="typescript"> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">vpc&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">ec2&lt;/span>.&lt;span style="color:#a6e22e">Vpc&lt;/span>(&lt;span style="color:#66d9ef">this&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;Gameday&amp;#39;&lt;/span>, {
&lt;span style="color:#a6e22e">cidr&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;10.0.0.0/16&amp;#39;&lt;/span>,
&lt;span style="color:#a6e22e">maxAzs&lt;/span>: &lt;span style="color:#66d9ef">2&lt;/span>,
&lt;span style="color:#a6e22e">subnetConfiguration&lt;/span>&lt;span style="color:#f92672">:&lt;/span> [
{
&lt;span style="color:#a6e22e">cidrMask&lt;/span>: &lt;span style="color:#66d9ef">24&lt;/span>,
&lt;span style="color:#a6e22e">name&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;Public&amp;#39;&lt;/span>,
&lt;span style="color:#a6e22e">subnetType&lt;/span>: &lt;span style="color:#66d9ef">SubnetType.PUBLIC&lt;/span>
},
{
&lt;span style="color:#a6e22e">cidrMask&lt;/span>: &lt;span style="color:#66d9ef">24&lt;/span>,
&lt;span style="color:#a6e22e">name&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;Private&amp;#39;&lt;/span>,
&lt;span style="color:#a6e22e">subnetType&lt;/span>: &lt;span style="color:#66d9ef">SubnetType.PRIVATE&lt;/span>
}
]
});
&lt;/code>&lt;/pre>&lt;/div>
&lt;p>æˆ‘åˆ›å»ºäº†ä¸¤ä¸ªç¤ºä¾‹é¡¹ç›®ä½¿ç”¨äº†&lt;a href="https://aws.amazon.com/cn/cdk/">AWS CDK&lt;/a>å¿«é€Ÿåˆ›å»ºåº”ç”¨ç¯å¢ƒä¸”éƒ¨ç½²åº”ç”¨ï¼Œ&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/zxkane/gameday-cdk">Gameday&lt;/a> ä¸ºä¸€ä¸ªECSä¸Šè¿è¡Œçš„Webåº”ç”¨ç¼–æ’äº†å®Œæ•´çš„ç¯å¢ƒï¼ŒåŒ…æ‹¬VPCã€RDS Auroraã€NAT Gatewayã€å®‰å…¨ç»„ã€ECSé›†ç¾¤ã€ECS Taskå®šä¹‰ã€ALBè´Ÿè½½å‡è¡¡ã€‚&lt;/li>
&lt;li>&lt;a href="https://github.com/zxkane/serverless-domain-redirect">Serverlss Domain Redirect&lt;/a> åŸºäºAWSæ­å»ºäº†æ— æœåŠ¡å™¨æ¶æ„çš„åŸŸåé‡å®šå‘æœåŠ¡ã€‚åŸºäºä¸åŒçš„é…ç½®å‚æ•°ï¼Œæä¾›äº†åŸºäº S3 + CloudFront + Route 53 æˆ–æ˜¯ Lambda + API Gateway + Route 53 ä¸¤ç§è§£å†³æ–¹æ¡ˆã€‚&lt;/li>
&lt;/ul>
&lt;p>æ€»ä½“çš„æ¥è¯´ï¼Œ&lt;a href="https://aws.amazon.com/cn/cdk/">AWS CDK&lt;/a>æ˜¯ä¸€ä¸ªéå¸¸å€¼å¾—é‡‡ç”¨çš„äº‘ä¸­èµ„æºç¼–æ’å’Œç®¡ç†æ–¹å¼ï¼Œé«˜æ•ˆçš„ç®¡ç†äº†AWSä¸Šçš„èµ„æºã€‚&lt;/p>
&lt;p>ç”±äºCDKè¿˜åœ¨ç›¸å¯¹æ—©æœŸï¼Œæˆç†Ÿåº¦è¿˜ä¸æ˜¯é‚£ä¹ˆå®Œç¾ã€‚æˆ‘åœ¨ä½¿ç”¨ä¸­å‘ç°ä¸‹é¢ä¸€äº›å€¼å¾—æ³¨æ„çš„é—®é¢˜ã€‚&lt;/p>
&lt;ol>
&lt;li>CDKç¨‹åºæœ€ç»ˆè¿˜æ˜¯åˆ›å»ºäº†CloudFormationé…ç½®ï¼Œæäº¤åˆ°CloudFormationå®Œæˆèµ„æºå˜æ›´ã€‚æ ¸å¿ƒçš„ç”¨æˆ·ä½“éªŒï¼Œéœ€è¦ä¾èµ–CloudFormationçš„èƒ½åŠ›ã€‚CloudFormationçš„åˆ›å»ºæˆ–å›é€€è¶…æ—¶è¿‡é•¿ï¼Œæ—¶å¸¸å½±å“èµ„æºéƒ¨ç½²ä½“éªŒã€‚å¦å¤–ï¼Œæ¸…ç†èµ„æºçš„æ—¶å€™ï¼Œé‡åˆ°éƒ¨åˆ†èµ„æºæ— æ³•æ¸…ç†ä¸”ç¼ºå°‘æ˜ç¡®æç¤ºã€‚æ¯”å¦‚Auroraé›†ç¾¤ã€‚&lt;/li>
&lt;li>CDKç±»åº“ç¼ºå°‘é…ç½®æ ¡éªŒã€‚è¿™ç±»é”™è¯¯åªèƒ½é€šè¿‡CloudFormationéƒ¨ç½²åï¼Œæ‰ä¼šè¢«èµ„æºæ–¹å‘ç°å¹¶è¿”å›é”™è¯¯ã€‚å¯¼è‡´æ•´ä¸ªåˆ›å»ºçš„å †æ ˆå›é€€ï¼Œè°ƒè¯•å¤§å‹çš„éƒ¨ç½²æ ˆå°†èŠ±è´¹æ¯”è¾ƒé•¿çš„æ—¶é—´ã€‚å»ºè®®å°†æ•´ä¸ªéƒ¨ç½²æ‹†åˆ†ä¸ºå¤šä¸ªå°çš„å †æ ˆï¼Œå‡å°æ¯æ¬¡éƒ¨ç½²æ—¶é—´ï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚&lt;/li>
&lt;li>æ–‡æ¡£è¿˜æ¯”è¾ƒç®€é™‹ã€‚ç¼ºå°‘è¾ƒä¸ºæ·±å…¥çš„ç¤ºä¾‹ã€‚å¢åŠ äº†å¼€å‘äººå‘˜çš„å­¦ä¹ æ›²çº¿ã€‚&lt;/li>
&lt;li>æ–°ç‰ˆæœ¬å‘åå…¼å®¹æ€§ä¸å¤Ÿå¥½ï¼Œæ—¶å¸¸æ–°ç‰ˆæœ¬æœ‰break changesã€‚åœ¨1.0GAä¹‹åå‘å¸ƒçš„ç‰ˆæœ¬break changesç›¸å¯¹å‡å°‘ï¼Œä½†ä»ç„¶æœ‰å‡ºç°ã€‚&lt;/li>
&lt;/ol></description></item><item><title>æ— æœåŠ¡å™¨æ¶æ„çš„åŸŸåé‡å®šå‘æœåŠ¡</title><link>https://kane.mx/posts/effective-cloud-computing/serverless-domain-redirect/</link><pubDate>Tue, 27 Aug 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/effective-cloud-computing/serverless-domain-redirect/</guid><description>&lt;p>ä¸šåŠ¡æ—¶å¸¸æœ‰éœ€æ±‚å°†æŸä¸ªåŸŸå(A)çš„è®¿é—®é‡å®šå‘åˆ°å…¶ä»–åŸŸå(B)ï¼Œå³ä½¿å®ç°è¿™æ ·ä¸€ä¸ªå¾ˆç®€å•çš„éœ€æ±‚é€šå¸¸ä¹Ÿéœ€è¦éƒ¨ç½²WebæœåŠ¡å™¨ï¼ˆä¾‹å¦‚Nginxï¼‰ï¼Œä¸ºåŸŸåAçš„è¯·æ±‚è¿”å›302å“åº”ï¼Œå¹¶æä¾›æ–°çš„Locationåœ°å€é‡å®šå‘åˆ°åŸŸåBã€‚ç°åœ¨åŸºäºäº‘è®¡ç®—æœåŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€äº›æ‰˜ç®¡æœåŠ¡æ¥å®ç°åŒæ ·çš„äº‹æƒ…ï¼Œæ— éœ€ç®¡ç†æœåŠ¡å™¨å’Œç»´æŠ¤åº”ç”¨ï¼ŒåŒæ—¶åšåˆ°æœ€ä½æˆæœ¬å®ç°è¯¥éœ€æ±‚ã€‚&lt;/p>
&lt;p>æ¥ä¸‹æ¥å°†ä»‹ç»å¦‚ä½•åˆ©ç”¨AWSä¸Šçš„æœåŠ¡å®ç°è¯¥éœ€æ±‚ã€‚&lt;/p>
&lt;h3 id="ä½¿ç”¨aws-s3å’Œaws-cloudfrontå®ç°åŸŸåé‡å®šå‘">ä½¿ç”¨AWS S3å’ŒAWS CloudFrontå®ç°åŸŸåé‡å®šå‘&lt;/h3>
&lt;ol>
&lt;li>åˆ›å»ºä¸€ä¸ªæ–°çš„S3 bucketï¼Œä¾‹å¦‚ &lt;code>redirect.domain.com&lt;/code>&lt;/li>
&lt;li>é…ç½®æ–°bucketå±æ€§ï¼Œå¼€å¯é™æ€ç½‘ç«™æ‰˜ç®¡ï¼ŒåŒæ—¶é…ç½®ä¸ºé‡å®šå‘è¯·æ±‚åˆ°æœŸæœ›çš„åŸŸå &lt;code>redirected-host.domain.com&lt;/code>&lt;/li>
&lt;li>åˆ›å»ºæ–°çš„CloudFrontåˆ†å‘ï¼Œè®¾ç½®ç¬¬ä¸€æ­¥åˆ›å»ºçš„S3 bucketä½œä¸º&lt;a href="https://docs.aws.amazon.com/zh_cn/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html">è‡ªå®šä¹‰æºç«™(ä¸å¯ä»¥é…ç½®æºç«™ä¸ºS3 bucket)&lt;/a>ã€‚å¹¶ä¸”é…ç½®ä½¿ç”¨è‡ªå®šä¹‰åŸŸå &lt;code>redirect.domain.com&lt;/code>ã€‚æ³¨æ„ï¼Œé…ç½®è‡ªå®šä¹‰CNameséœ€è¦æä¾›åŸŸåå¯¹åº”çš„SSLè¯ä¹¦ï¼Œå¯ä»¥ä½¿ç”¨AWS Certificate Manageråˆ›å»ºå…è´¹çš„SSL/TLSè¯ä¹¦&lt;/li>
&lt;li>åœ¨åŸŸå&lt;code>domain.com&lt;/code>è§£ææœåŠ¡å•†ä¸ºåŸŸå&lt;code>redirect.domain.com&lt;/code>åˆ›å»ºæ–°çš„è§£æè®°å½•&lt;/li>
&lt;/ol>
&lt;h3 id="ä½¿ç”¨aws-lambdaå’Œapi-gatewayå®ç°åŸŸåé‡å®šå‘">ä½¿ç”¨AWS Lambdaå’ŒAPI Gatewayå®ç°åŸŸåé‡å®šå‘&lt;/h3>
&lt;ol>
&lt;li>åˆ›å»ºä¸€ä¸ªLambdaå‡½æ•°æ¥è¿”å›302è¯·æ±‚æˆ–è€…HTMLé¡µé¢ï¼Œåœ¨é¡µé¢ä¸­é€šè¿‡Javascriptå®ç°é‡å®šå‘é¡µé¢&lt;/li>
&lt;li>ä¸ºè¯¥Lambdaå‡½æ•°åˆ›å»ºAPI Gatewayè§¦å‘å™¨&lt;/li>
&lt;li>ä¸ºè¯¥API Gatewayæ¥å£åˆ›å»ºè‡ªå®šä¹‰åŸŸå&lt;/li>
&lt;li>åœ¨åŸŸå&lt;code>domain.com&lt;/code>è§£ææœåŠ¡å•†ä¸ºåŸŸå&lt;code>redirect.domain.com&lt;/code>åˆ›å»ºæ–°çš„è§£æè®°å½•&lt;/li>
&lt;/ol>
&lt;p>æˆ‘åˆ›å»ºäº†ä¸€ä¸ªåŸºäº&lt;a href="https://aws.amazon.com/cdk/?nc1=h_ls">AWS CDK&lt;/a>çš„&lt;a href="https://github.com/zxkane/serverless-domain-redirect#use-aws-s3-and-cloudfront-for-domain-redirect">Githubé¡¹ç›®&lt;/a>ï¼Œåˆ©ç”¨AWS Infrastructure as Codeçš„å¼ºå¤§èƒ½åŠ›ä¸€é”®éƒ¨ç½²ä»¥ä¸Šä¸¤ç§æ— æœåŠ¡å™¨ç¯å¢ƒï¼Œæœ‰éœ€è¦çš„å¯ä»¥ä½œä¸ºå®ç°å‚è€ƒã€‚&lt;/p></description></item><item><title>Amazon Alexa Androidç‰ˆæœ¬å›½å†…ç™»å½•é—®é¢˜</title><link>https://kane.mx/posts/2019/alexa-login-issue/</link><pubDate>Wed, 14 Aug 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2019/alexa-login-issue/</guid><description>&lt;p>è¿‘æœŸéœ€è¦åšä¸€äº›Alexaä¸Šçš„å¼€å‘ï¼Œåœ¨æ‰‹æœºä¸Šå®‰è£…äº†Amazon Alexaï¼Œä¸€ç›´å¾—åˆ°ä¸‹é¢è¿™æ ·çš„é”™è¯¯æç¤ºè€Œæ— æ³•ç™»å½•ã€‚&lt;/p>
&lt;blockquote>
&lt;p>Connection Timed Out.&lt;/p>
&lt;/blockquote>
&lt;p>å…ˆåå°è¯•äº†ç¿»å¢™ã€æ›´æ”¹è¯­è¨€ç­‰æ–¹æ³•ä»ç„¶ä¸å¯ç™»å½•ã€‚å¹¶ä¸”åœ¨ç½‘ç»œä¸Šä¹Ÿæ²¡æœ‰æ‰¾åˆ°å¯ç”¨çš„æ–¹æ¡ˆï¼Œå†³å®šæŠ“åŒ…ç ”ç©¶ä¸‹ä¸ºä»€ä¹ˆæˆ‘çš„è´¦å·å§‹ç»ˆæ— æ³•ç™»å½•ã€‚&lt;/p>
&lt;p>é€šè¿‡æŠ“å–Alexaç™»å½•æ—¶å‘é€çš„æ•°æ®åŒ…ï¼Œå‘ç°ä»–è®¿é—®äº†amazon.cnç­‰æ•°ä¸ªcnåŸŸåä¸‹çš„ä¸€ç³»åˆ—æœåŠ¡ï¼Œçœ‹æ¥è¿™äº›æœåŠ¡ä¸­éƒ¨åˆ†å·²æ— æ³•æä¾›æ­£å¸¸æœåŠ¡ï¼Œå¯¼è‡´ç™»å½•ä¸€ç›´å‡ºç°ä¸Šé¢çš„é”™è¯¯ã€‚&lt;/p>
&lt;p>Amazon Alexaä½œä¸ºä¸€ä¸ªæœåŠ¡å…¨çƒç”¨æˆ·çš„appï¼Œåº”è¯¥æ˜¯åˆ¤æ–­æ‰‹æœºç”¨æˆ·åœ¨å¤§é™†åœ°åŒºåä½¿ç”¨äº†é…ç½®åœ¨å¤§é™†åœ°åŒºçš„è¿™äº›æœåŠ¡ã€‚&lt;/p>
&lt;p>ä¸´æ—¶è§£å†³æ–¹æ¡ˆçš„æ€è·¯å°±æ˜¯è®¾ç½®ç³»ç»Ÿæˆ–appï¼Œè®©ä»–æ— æ³•è·å–åˆ°æ‰‹æœºçœŸå®æ‰€åœ¨çš„åœ°ç†ä½ç½®ï¼Œé‚£ä¹ˆAlexa appä¼šä½¿ç”¨é»˜è®¤çš„å…¨çƒæœåŠ¡å™¨æ¥è¯·æ±‚æ•°æ®ã€‚&lt;/p>
&lt;p>ä»¥ä¸‹æ˜¯ä¸´æ—¶è§£å†³æ–¹æ¡ˆçš„æ­¥éª¤ï¼Œ&lt;/p>
&lt;ol>
&lt;li>ä»Playå¸‚åœºå®‰è£…Alexa appã€‚å¦‚æœå·²å®‰è£…æ¸…ç©ºappæ•°æ®ã€‚&lt;/li>
&lt;li>ç¦ç”¨app Locationæƒé™(é»˜è®¤å°±æ˜¯ç¦ç”¨çš„)ã€‚&lt;/li>
&lt;li>æ›´æ”¹ç³»ç»Ÿè¯­è¨€ä¸ºè‹±æ–‡ï¼Œè®¾ç½®æ—¶åŒºä¸ºä»»æ„ç¾å›½æ—¶åŒºã€‚&lt;/li>
&lt;li>æ‹”æ‰SIMå¡ï¼Œæˆ–è€…ç¦ç”¨æ‰€æœ‰SIMå¡ã€‚&lt;/li>
&lt;/ol>
&lt;p>æ‰“å¼€Alexa appï¼Œä½¿ç”¨å·²æœ‰æˆ–æ–°æ³¨å†ŒAmazonè´¦å·å³å¯ç™»å½•ã€‚&lt;/p></description></item><item><title>ä½¿ç”¨AWS S3ä½œä¸ºMacOSXæ—¶é—´æœºå™¨(Time Machine)çš„å¤‡ä»½å­˜å‚¨</title><link>https://kane.mx/posts/2019/using-s3-as-device-for-mac-time-machine-backup/</link><pubDate>Sun, 30 Jun 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2019/using-s3-as-device-for-mac-time-machine-backup/</guid><description>&lt;p>ä¸ªäººç”µè„‘æ•°æ®å¤‡ä»½ä¸€ç›´éƒ½æ˜¯ä¸€ä¸ªå¼ºçƒˆçš„éœ€æ±‚ã€‚ä½¿ç”¨ç½‘ç›˜ç­‰äº‘å­˜å‚¨äº§å“å¯ä»¥éƒ¨åˆ†æ»¡è¶³æ•°æ®çš„å¤‡ä»½éœ€æ±‚ï¼Œä»ç„¶æ— æ³•åšåˆ°ä½¿ç”¨ä¾¿åˆ©æ€§å’Œå¾ˆé«˜çš„æ•°æ®å®‰å…¨ä¿éšœã€‚&lt;/p>
&lt;p>MacOSXä¸Šç³»ç»Ÿå†…ç½®äº†å¤‡ä»½è§£å†³æ–¹æ¡ˆ &amp;ndash; &lt;a href="https://support.apple.com/zh-cn/HT201250">æ—¶é—´æœºå™¨(Time Machine)&lt;/a>ã€‚Time Machineæ”¯æŒAirPort Time Capsuleï¼ŒNASå­˜å‚¨æˆ–è€…å¤–ç½®çš„å­˜å‚¨è®¾å¤‡ã€‚ç„¶è€Œè¿™äº›å¤‡ä»½æ–¹æ¡ˆéƒ½ä¾èµ–äºç¡¬ä»¶è®¾å¤‡ï¼Œæœ‰å®¹é‡é™åˆ¶æˆ–ä¸ä¾¿äºç§»åŠ¨ã€‚åœ¨äº‘è®¡ç®—å·²ç»å¤§è¡Œå…¶é“çš„ä»Šå¤©ï¼Œæœ‰æ²¡æœ‰ä½¿ç”¨äº‘è®¡ç®—å‚å•†å¯¹è±¡å­˜å‚¨ä½œä¸ºç›®æ ‡å­˜å‚¨çš„å¤‡ä»½æ–¹æ¡ˆï¼Œä¸ºMacOSXæ•°æ®å¤‡ä»½æä¾›æ— é™å®¹é‡ã€é«˜åº¦çš„å®‰å…¨æ€§çš„äº‘æ–¹æ¡ˆï¼Ÿç»è¿‡ä¸€ç•ªæœç´¢ï¼Œæ—¢æ‰¾åˆ°äº†å¼€æºå…è´¹çš„å·¥å…·&lt;a href="https://restic.net/">Restic&lt;/a>ï¼Œä¹Ÿæœ‰ä»˜è´¹è½¯ä»¶&lt;a href="https://www.arqbackup.com/">Arq&lt;/a>ã€‚æ— è®ºResticè¿˜æ˜¯Arqæä¾›çš„æ˜¯ç‹¬ç«‹çš„ä¸‰æ–¹å·¥å…·æ¥å®ç°å¤‡ä»½åˆ°äº‘ç«¯å­˜å‚¨æˆ–ä»äº‘ç«¯æ¢å¤ï¼Œæœ‰æ²¡æœ‰å°†Time Machineå’Œäº‘ç«¯å‚¨å­˜ç»“åˆåœ¨ä¸€èµ·çš„æ–¹æ¡ˆå‘¢ï¼Ÿ&lt;/p>
&lt;p>TimeMchineæ”¯æŒå°†å¤–ç½®å­˜å‚¨ä½œä¸ºå¤‡ä»½è®¾å¤‡ï¼Œè¿™é‡Œä»‹ç»çš„æ–¹æ³•å°±æ˜¯å°†è¿œç«¯äº‘è®¡ç®—å‚å•†çš„å¯¹è±¡å­˜å‚¨æŒ‚è½½ä¸ºæœ¬åœ°è®¾å¤‡ï¼Œè®¾ç½®Time Machineå°†å®ƒä½œä¸ºç›®æ ‡å¤‡ä»½è®¾å¤‡ï¼Œå®ç°å°†å¤‡ä»½æ”¾åˆ°äº‘å‚å•†çš„å¯¹è±¡å‚¨å­˜ã€‚&lt;/p>
&lt;p>æ¥ä¸‹æ¥æˆ‘å°†ä¸€æ­¥æ­¥æ¼”ç¤ºå¦‚ä½•å°†AWS S3å¯¹è±¡å­˜å‚¨çš„bucketä½œä¸ºTime Machineå¤‡ä»½çš„è®¾å¤‡ã€‚&lt;/p>
&lt;blockquote>
&lt;p>æ­¤æ–¹æ³•é€‚ç”¨äºå°†ä»»æ„äº‘å‚å•†çš„å¯¹è±¡å­˜å‚¨ä½œä¸ºå¤‡ä»½å­˜å‚¨ï¼Œåªè¦è¯¥å‚å•†çš„å¯¹è±¡å­˜å‚¨æ”¯æŒè¢«MacOSXæŒ‚è½½ä¸ºæœ¬åœ°ç£ç›˜ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>æœ‰å¾ˆå¤šæˆç†Ÿçš„æ–¹æ¡ˆå°†AWS S3æŒ‚è½½ä¸ºMacOSXç£ç›˜ï¼Œä¾‹å¦‚&lt;a href="https://amazonaws-china.com/cn/blogs/china/s3fs-amazon-ec2-linux/">S3fs&lt;/a>ã€&lt;a href="https://github.com/kahing/goofys">Goofys&lt;/a>ã€‚æœ¬æ–‡æ¨èçš„æ–¹æ¡ˆæ˜¯&lt;a href="https://juicefs.com">Juicefs&lt;/a>ï¼ŒJuicefsä¸ºå¯¹è±¡å­˜å‚¨çš„å…ƒæ•°æ®æä¾›äº†ç¼“å­˜ï¼Œèƒ½æå¤§çš„ä¼˜åŒ–å¯¹æŒ‚è½½ç£ç›˜çš„listï¼Œgetç­‰æ“ä½œã€‚&lt;/p>
&lt;ol>
&lt;li>é¦–å…ˆæŒ‰ç…§&lt;a href="https://juicefs.com/docs/zh/getting_started.html#system-requirement">Juicefs æ–‡æ¡£&lt;/a>å®‰è£…å¿…è¦çš„ä¾èµ–å’ŒJuicefså®¢æˆ·ç«¯ã€‚æ¥ä¸‹æ¥åœ¨Juicefsæ³¨å†Œå®Œæˆåï¼Œåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿä¿å­˜å¤‡ä»½æ•°æ®ã€‚æ³¨æ„ï¼šè¿™é‡Œçš„bucketåç§°éœ€è¦åŒéšååˆ›å»ºæˆ–å·²æœ‰çš„bucketåç§°ä¸€è‡´ã€‚
&lt;figure>
&lt;img src="https://kane.mx/posts/2019/using-s3-as-device-for-mac-time-machine-backup/images/create-juicefs-fs.png"
alt="åˆ›å»ºJuicefsæ–‡ä»¶ç³»ç»Ÿ"/>
&lt;/figure>
&lt;/li>
&lt;li>åˆ›å»ºæ–°çš„AWS S3 bucket(æˆ–è€…ä½¿ç”¨å·²æœ‰çš„bucket)ï¼ŒåŒæ—¶ä¸ºè¯¥bucketä¸“é—¨åˆ›å»ºç”¨äºJuicefså®¢æˆ·ç«¯ä½¿ç”¨çš„IAMç”¨æˆ·ã€‚å¼ºçƒˆå»ºè®®ä¸è¦ä½¿ç”¨äº‘å¸å·çš„access tokenç”¨äºæŒ‚è½½ï¼Œæœ€ä½³å®è·µæ˜¯ä¸ºä¸åŒçš„ç”¨é€”åˆ›å»ºå•ç‹¬çš„IAMç”¨æˆ·ã€‚æ›´å¤šIAMç”¨æˆ·å®è·µï¼Œè¯·å‚è€ƒæ–‡ç« &lt;a href="https://kane.mx/posts/effective-cloud-computing/iam-best-practice/">IAMæœ€ä½³å®è·µ&lt;/a>ã€‚ä¸‹é¢æ˜¯ä½¿ç”¨AWS CLIåˆ›å»ºæ–°S3 bucketåŠIAMç”¨æˆ·çš„å‚è€ƒå‘½ä»¤ï¼Œ
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#75715e"># åˆ›å»ºS3 bucket&lt;/span>
aws s3 mb s3://my-bucket-for-mac-backup
&lt;span style="color:#75715e"># åˆ›å»ºIAMç”¨æˆ·&lt;/span>
aws iam create-user --user-name juicefs
&lt;span style="color:#75715e"># ä¸ºjuicefsç”¨æˆ·æˆäºˆè¯»å†™å¤‡ä»½S3 bucketæƒé™&lt;/span>
echo &lt;span style="color:#e6db74">&amp;#39;{
&lt;/span>&lt;span style="color:#e6db74"> &amp;#34;UserName&amp;#34;: &amp;#34;juicefs&amp;#34;,
&lt;/span>&lt;span style="color:#e6db74"> &amp;#34;PolicyName&amp;#34;: &amp;#34;mac-backup-bucket-all-permissions&amp;#34;,
&lt;/span>&lt;span style="color:#e6db74"> &amp;#34;PolicyDocument&amp;#34;: &amp;#34;{ \&amp;#34;Version\&amp;#34;: \&amp;#34;2012-10-17\&amp;#34;, \&amp;#34;Statement\&amp;#34;: [ { \&amp;#34;Effect\&amp;#34;: \&amp;#34;Allow\&amp;#34;, \&amp;#34;Action\&amp;#34;: \&amp;#34;s3:*\&amp;#34;, \&amp;#34;Resource\&amp;#34;: [ \&amp;#34;arn:aws-cn:s3:::my-bucket-for-mac-backup/*\&amp;#34;, \&amp;#34;arn:aws-cn:s3:::my-bucket-for-mac-backup\&amp;#34; ] } ] }&amp;#34;
&lt;/span>&lt;span style="color:#e6db74"> 1 {
&lt;/span>&lt;span style="color:#e6db74">}&amp;#39;&lt;/span> &amp;gt; policy.json
aws iam put-user-policy --cli-input-json file://policy.json
&lt;span style="color:#75715e"># ä¸ºjuicefsç”¨æˆ·åˆ›å»ºaccess tokenç”¨äºjuicefså®¢æˆ·ç«¯æŒ‚è½½bucket&lt;/span>
aws iam create-access-key --user-name juicefs
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;AccessKey&amp;#34;&lt;/span>: &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;UserName&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;juicefs&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;AccessKeyId&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;&amp;lt;key id&amp;gt;&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;Status&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;Active&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;SecretAccessKey&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;&amp;lt;access key&amp;gt;&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;CreateDate&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;2019-06-30T15:25:41Z&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>æŒ‰ç…§&lt;a href="https://juicefs.com/docs/zh/getting_started.html#mount-filesystem">Juicefsæ–‡æ¡£æŒ‚è½½&lt;/a>æŒ‚è½½S3 bucketã€‚&lt;/li>
&lt;li>è¿›å…¥æŒ‚è½½åçš„ç›®å½•(å¦‚&lt;code>/jfs&lt;/code>)ï¼Œåˆ›å»º&lt;strong>Sparse Image&lt;/strong>ç”¨äºTime Machineå†™å…¥å¤‡ä»½ã€‚
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">cd /jfs
hdiutil create -size 600g -type SPARSEBUNDLE -fs &lt;span style="color:#e6db74">&amp;#34;HFS+J&amp;#34;&lt;/span> Time Machine.sparsebundle&lt;/code>&lt;/pre>&lt;/div>
ä¸Šé¢å‘½ä»¤å°†åˆ›å»ºä¸€ä¸ªåä¸º&lt;code>TimeMachine&lt;/code>600 GBå¤§å°çš„é•œåƒ(åˆå§‹ä»…å ç”¨æ•°ç™¾MBï¼Œå®é™…æ–‡ä»¶ç£ç›˜ç©ºé—´åªæœ‰å½“æ–‡ä»¶å†™å…¥åæ‰ä¼šå ç”¨)ã€‚æ ¹æ®ä½ çš„éœ€è¦éšæ„è°ƒæ•´é•œåƒå¤§å°ï¼Œé€šå¸¸å»ºè®®è®¾ç½®ä¸ºMacç£ç›˜å¤§å°çš„ä¸¤å€ã€‚
ä¸ç†Ÿæ‚‰å‘½ä»¤è¡Œçš„ç”¨æˆ·ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç£ç›˜å·¥å…·(Disk Utility)åˆ›å»ºã€‚
&lt;figure>
&lt;img src="https://kane.mx/posts/2019/using-s3-as-device-for-mac-time-machine-backup/images/create-sparse-image.png"
alt="åˆ›å»ºSparse Image"/>
&lt;/figure>
&lt;/li>
&lt;li>é€šè¿‡FinderæŒ‚è½½ä¹‹å‰åˆ›å»ºçš„Sparse Image
&lt;figure>
&lt;img src="https://kane.mx/posts/2019/using-s3-as-device-for-mac-time-machine-backup/images/mount-sparse-image.png"
alt="æŒ‚è½½Sparse Image"/>
&lt;/figure>
&lt;/li>
&lt;li>ç°åœ¨æ˜¯é­”æœ¯æ­¥éª¤ï¼Œå‘Šè¯‰Time Machineä½¿ç”¨ä¹‹å‰åˆ›å»ºçš„è™šæ‹Ÿè®¾å¤‡ä½œä¸ºå¤‡ä»½ç£ç›˜ã€‚
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">sudo tmutil setdestination /Volumes/Time MachineDisk&lt;/code>&lt;/pre>&lt;/div>
&lt;figure>
&lt;img src="https://kane.mx/posts/2019/using-s3-as-device-for-mac-time-machine-backup/images/time-machine.png"
alt="Time Machineå¤‡ä»½"/>
&lt;/figure>
&lt;/li>
&lt;/ol>
&lt;p>ç”±äºS3 Bucketç”¨äºå¤‡ä»½æ•°æ®ï¼Œå»ºè®®å¼€å¯S3 æ™ºèƒ½åˆ†å±‚å­˜å‚¨æˆ–è€…IAå‚¨å­˜ï¼Œé™ä½èŠ±è´¹ã€‚åŒæ—¶å¯ä»¥å¯ç”¨S3 KMSåŠ å¯†äº‘ç«¯ä¿å­˜çš„æ•°æ®ï¼Œæå‡æ•°æ®å®‰å…¨æ€§ã€‚&lt;/p></description></item><item><title>Spring Cloud Function -- è·¨Serverlesså¹³å°çš„å‡½æ•°è®¡ç®—æ¡†æ¶</title><link>https://kane.mx/posts/effective-cloud-computing/spring-cloud-function-for-aws/</link><pubDate>Fri, 28 Jun 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/effective-cloud-computing/spring-cloud-function-for-aws/</guid><description>&lt;p>&lt;a href="https://kane.mx/posts/2019/serverless-framework/">åŸºäºserverlessæ¡†æ¶çš„é’‰é’‰å›è°ƒå‡½æ•°&lt;/a>ä¸­ä»‹ç»äº†serverless frameworkï¼Œä¸€æ¬¾æ”¯æŒè·¨äº‘å‚å•†/Serverlesså¹³å°çš„éƒ¨ç½²å·¥å…·ã€‚ä½†æ˜¯å‡½æ•°ä»£ç è¿˜æ˜¯éœ€è¦é’ˆå¯¹ä¸åŒçš„serverlesså¹³å°ä½œå¯¹åº”çš„é€‚é…ã€‚è€Œ&lt;a href="https://spring.io/projects/spring-cloud-function">Spring Clound Function&lt;/a>å°±æ˜¯é’ˆå¯¹è¿™ç§æƒ…å†µä¸“é—¨å¼€å‘çš„è·¨serverlesså¹³å°çš„æ¡†æ¶ï¼Œå®ç°ä¸€å¥—ä»£ç é€šè¿‡ä¸åŒçš„æ‰“åŒ…å®ç°è·¨serverlesså¹³å°ã€‚Spring Clound Functionç›®å‰æ”¯æŒAWS Lambda, Microsoft Azure Functionä»¥åŠApache OpenWhiskã€‚&lt;/p>
&lt;p>è¿™é‡Œæˆ‘ä»¬ç»§ç»­ä½¿ç”¨&lt;a href="https://kane.mx/posts/effective-cloud-computing/serverless-dingtalk-callback/">æ— å‡½æ•°ç‰ˆæœ¬çš„é’‰é’‰å›æ‰å‡½æ•°&lt;/a>æ¥æ¼”ç¤º&lt;a href="https://spring.io/projects/spring-cloud-function">Spring Clound Function&lt;/a> for AWSçš„ä½¿ç”¨ã€‚&lt;/p>
&lt;p>é¦–å…ˆå°†&lt;code>spring cloud function for aws adapter&lt;/code>æ·»åŠ åˆ°é¡¹ç›®ä¾èµ–ï¼Œ&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-kotlin" data-lang="kotlin">implementation(&lt;span style="color:#e6db74">&amp;#34;org.springframework.cloud:spring-cloud-function-adapter-aws:&lt;/span>&lt;span style="color:#e6db74">${springCloudFunctionVersion}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>)&lt;/code>&lt;/pre>&lt;/div>
&lt;p>å…¶æ¬¡åˆ›å»ºå‡½æ•°&lt;code>Handler&lt;/code>ï¼Œå®ç°Spring Cloud Functionè·¨å‡½æ•°è®¡ç®—å®ç°æŠ½è±¡çš„&lt;code>SpringBootRequestHandler&lt;/code>ç±»ï¼Œæˆ–è€…æ˜¯ç»§æ‰¿è‡ªå®ƒçš„triggerç±»ï¼Œä¾‹å¦‚&lt;code>SpringBootApiGatewayRequestHandler&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-kotlin" data-lang="kotlin">&lt;span style="color:#66d9ef">import&lt;/span> org.springframework.cloud.function.adapter.aws.SpringBootApiGatewayRequestHandler
&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">Handler&lt;/span> : SpringBootApiGatewayRequestHandler()&lt;/code>&lt;/pre>&lt;/div>
&lt;p>æ¥ä¸‹æ¥åˆ›å»ºSpring Bootåº”ç”¨ç¨‹åºï¼Œå¹¶å°†serverlesså®ç°å‡½æ•°æ³¨å†Œä¸º&lt;code>Spring Bean&lt;/code>ï¼Œå‡½æ•°çš„å®ç°éƒ¨åˆ†å°±æ˜¯serverlesså‡½æ•°å…·ä½“åšçš„ä¸šåŠ¡é€»è¾‘ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-kotlin" data-lang="kotlin">&lt;span style="color:#a6e22e">@SpringBootApplication&lt;/span>
&lt;span style="color:#66d9ef">open&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">DingtalkCallbackApplication&lt;/span> {
&lt;span style="color:#a6e22e">@Bean&lt;/span>
&lt;span style="color:#66d9ef">open&lt;/span> &lt;span style="color:#66d9ef">fun&lt;/span> &lt;span style="color:#a6e22e">dingtalkCallback&lt;/span>(): Function&amp;lt;Message&amp;lt;EncryptedEvent&amp;gt;, Map&amp;lt;String, String&amp;gt;&amp;gt; {
&lt;span style="color:#66d9ef">val&lt;/span> callback = Callback()
&lt;span style="color:#66d9ef">return&lt;/span> Function {
callback.handleRequest(&lt;span style="color:#66d9ef">it&lt;/span>)
}
}
}
&lt;span style="color:#66d9ef">fun&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>(args: Array&amp;lt;String&amp;gt;) {
SpringApplication.run(DingtalkCallbackApplication&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#66d9ef">class&lt;/span>.java, *args)
}&lt;/code>&lt;/pre>&lt;/div>
&lt;p>æœ€åå°†å‡½æ•°æ‰“åŒ…ä¸ºfat jarï¼ˆå¦‚æœå°†ä¾èµ–æ‰“åŒ…ä¸ºlambda layerï¼Œå¯ä¸ç”¨æ‰“åŒ…ä¸ºfat jarï¼‰ä½œä¸ºlambdaçš„ä»£ç ã€‚&lt;/p>
&lt;p>å‡½æ•°çš„éƒ¨ç½²åŒå…¶ä»–çš„lambdaå‡½æ•°æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œè¿™ä¸ªç¤ºä¾‹ä¸­æ²¿ç”¨äº†ä¹‹å‰çš„SAM/CloudFormationé…ç½®æˆ–è€…&lt;a href="https://serverless.com/">serverless framework&lt;/a>éƒ¨ç½²é…ç½®ã€‚&lt;/p>
&lt;p>å®Œæ•´çš„å¯è¿è¡Œã€éƒ¨ç½²ä»£ç è¯·è®¿é—®&lt;a href="https://github.com/zxkane/dingtalk-callback-on-aws/tree/spring-cloud-function">è¿™ä¸ªåˆ†æ”¯&lt;/a>ã€‚&lt;/p>
&lt;blockquote>
&lt;p>æ€»ä½“æ¥è¯´ï¼Œ&lt;a href="https://spring.io/projects/spring-cloud-function">Spring Clound Function&lt;/a>çš„å®ç°åŸç†å¹¶ä¸å¤æ‚ï¼Œå®šä¹‰ç»Ÿä¸€çš„å‡½æ•°å®ç°å…¥å£ï¼Œé€šè¿‡ä¸åŒserverlesså¹³å°çš„adapterå¯¹æ¥ä¸åŒå¹³å°çš„APIæ¥å£ï¼Œåšåˆ°ç¼–å†™ä¸€æ¬¡å‡½æ•°å®ç°ï¼Œé€šè¿‡æ‰“åŒ…ä¸åŒçš„adapteråšåˆ°è·¨serverlesså¹³å°è¿è¡Œã€‚&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>ä½†ä¸ªäººè®¤ä¸ºç°å®ä¸­è¿™æ ·çš„åœºæ™¯å¹¶ä¸å¤šã€‚å¹¶ä¸”serverlesså‡½æ•°è§¦å‘æ–¹å¼å¾ˆå¤šï¼Œä¾‹å¦‚AWSä¸Šçš„APIGatewayã€Kinesisã€CloudWatchã€IoTç­‰æœåŠ¡ï¼Œä¸è¿™äº›æœåŠ¡å¯¹æ¥æˆ–APIè°ƒç”¨å…¶å®ä¹Ÿäº§ç”Ÿäº†è€¦åˆï¼Œå¹¶ä¸èƒ½ç®€å•çš„è¿ç§»åˆ°ä¸‰æ–¹çš„serverlesså¹³å°å»æ‰§è¡Œã€‚åŒæ—¶ï¼Œå¼€å‘è€…éœ€è¦å¼•å…¥spring/spring boot/spring cloudç›¸å…³çš„ä¾èµ–ï¼Œå¢åŠ äº†ç¨‹åºçš„å¤æ‚åº¦ï¼Œåˆå»¶é•¿äº†lambdaå‡½æ•°clod startéœ€è¦çš„æ—¶é—´ã€‚å¦å¤–ï¼Œå¼€å‘è€…éœ€è¦å­¦ä¹ spring cloud functionç›¸å…³çš„çŸ¥è¯†ï¼Œæ— å½¢ä¸­å¢åŠ äº†å¤æ‚åº¦ã€‚æ€»ä¹‹ä½¿ç”¨spring cloud functionä½œä¸ºå‡½æ•°è®¡ç®—æ¡†æ¶æ”¶ç›Šå¹¶ä¸é«˜ï¼Œæ•´ä¸ªé¡¹ç›®ç»™äººæ„Ÿè§‰æ¯”è¾ƒé¸¡è‚‹ã€‚&lt;/p>
&lt;/blockquote></description></item><item><title>å…¬æœ‰äº‘å¯¹æ¯”</title><link>https://kane.mx/posts/2019/aws-vs-aliyun/</link><pubDate>Wed, 26 Jun 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2019/aws-vs-aliyun/</guid><description>&lt;p>AWSæ˜¯å…¨çƒäº‘è®¡ç®—é¢†åŸŸçš„é¢†è·‘è€…ï¼Œå®ƒåœ¨è®¡ç®—ã€å­˜å‚¨ã€ç½‘ç»œç­‰æ–¹é¢éƒ½åšå‡ºäº†å¾ˆå¤šåˆ›æ–°ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å…¶ä»–äº‘è®¡ç®—å‚å•†å­¦ä¹ åŠæ¨¡ä»¿çš„å¯¹è±¡ã€‚&lt;/p>
&lt;p>é˜¿é‡Œäº‘æ˜¯ç›®å‰å›½å†…å¸‚åœºä»½é¢æœ€å¤§çš„äº‘è®¡ç®—å‚å•†ï¼Œå…¶ä»½é¢&lt;a href="http://www.sohu.com/a/302064020_465914">è¶…è¿‡äº†ç¬¬äºŒè‡³äº”ä½å‚å•†çš„æ€»å’Œ&lt;/a>ï¼Œä»½é¢é¢†å…ˆä¼˜åŠ¿æ¯”AWSåœ¨å…¨çƒè¿˜è¦æ˜¾è‘—ï¼ŒåŒæ—¶&lt;a href="https://www.canalys.com/newsroom/cloud-market-share-q4-2018-and-full-year-2018">å…¨çƒä»½é¢ä¹Ÿè¶…è¿‡IBMæ¥åˆ°ç¬¬å››&lt;/a>ã€‚&lt;/p>
&lt;p>æœ¬æ–‡å°†å¯¹AWSå’Œé˜¿é‡Œäº‘æ ¸å¿ƒæœåŠ¡åšä¸€ä¸ªç®€è¦å¯¹æ¯”ï¼Œä»¥åŠè¿™ä¸¤å®¶å‚å•†å‘å±•æ–¹å‘çš„ä¸€äº›ä¸ªäººè§è§£ã€‚&lt;/p>
&lt;p>äº‘è®¡ç®—ï¼Œå…¶æ ¸å¿ƒæœåŠ¡å°±æ˜¯&lt;strong>è®¡ç®—&lt;/strong>ã€&lt;strong>å­˜å‚¨&lt;/strong>åŠ&lt;strong>ç½‘ç»œ&lt;/strong>ã€‚è¿™äº›åŸºæœ¬èƒ½åŠ›çš„ç¨³å®šæ€§ï¼ŒåŠŸèƒ½å®Œå–„æ€§å†³å®šäº†äº‘è®¡ç®—å‚å•†èƒ½åŠ›çš„ä¸‹é™ã€‚&lt;/p>
&lt;figure>
&lt;img src="https://kane.mx/posts/2019/aws-vs-aliyun/core-service.jpg"
alt="äº‘è®¡ç®—æ ¸å¿ƒæœåŠ¡"/>
&lt;/figure>
&lt;p>é™¤äº†ä¸Šé¢æåˆ°çš„ä¸‰å¤§è®¡ç®—æœºæ ¸å¿ƒç»„ä»¶èƒ½åŠ›ï¼Œä¸‹é¢è¿™äº›èƒ½åŠ›ä¹Ÿæ˜¯äº‘è®¡ç®—ä¸­éå¸¸é‡è¦çš„ç»„æˆéƒ¨åˆ†ï¼Œ&lt;/p>
&lt;figure>
&lt;img src="https://kane.mx/posts/2019/aws-vs-aliyun/critical-capabilities.jpg"
alt="äº‘è®¡ç®—å…³é”®èƒ½åŠ›"/>
&lt;/figure>
&lt;ul>
&lt;li>æŒ‰é‡è®¡è´¹&lt;/li>
&lt;li>èµ„æºç¼–æ’ï¼ˆä¹Ÿå°±æ˜¯å¹³å°ä½œä¸ºä»£ç ï¼‰&lt;/li>
&lt;li>äº‘èµ„æºçš„è®¤è¯åŠæˆæƒ&lt;/li>
&lt;li>API&lt;/li>
&lt;/ul>
&lt;p>åŸºäºä¸Šé¢åˆ—ä¸¾çš„äº‘è®¡ç®—æ ¸å¿ƒæœåŠ¡å’Œå…³é”®èƒ½åŠ›ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å“ªäº›æ–¹é¢æ˜¯AWSçš„å¼ºé¡¹ã€‚&lt;/p>
&lt;figure>
&lt;img src="https://kane.mx/posts/2019/aws-vs-aliyun/aws-pros.jpg"
alt="AWS&amp;#39;s Pros"/>
&lt;/figure>
&lt;p>AWSä½œä¸ºäº‘è®¡ç®—çš„é¢†å†›å‚å•†ï¼Œåœ¨è®¡ç®—ã€å­˜å‚¨ã€ç½‘ç»œè¿™ä¸‰å¤§æ ¸å¿ƒä¸€ç›´åœ¨ä¸åœçš„åˆ›æ–°ä¸­ï¼Œä¸”è¢«å‹å•†åœ¨ä¸åœçš„æ¨¡ä»¿ã€‚è®¡ç®—æ–¹é¢ï¼ŒAWSé¦–å…ˆæ¨å‡ºäº†Lambdaæ— æœåŠ¡å™¨è®¡ç®—å¼•æ“å®ç°æŒ‰é‡ä½¿ç”¨çš„å…¨æ‰˜ç®¡æœåŠ¡ï¼Œç”Ÿäº§å¯ç”¨çš„GPUå®ä¾‹(å•è™šæœºå¯é…ç½®æœ€é«˜64å—GPUå¡ï¼Œè€Œé˜¿é‡Œäº‘é»˜è®¤ä»…å”®å–2å—GPUå¡)ï¼Œ&lt;a href="https://www.infoq.cn/article/2017/11/Nitro-amazon-EC2">åŸºäºNitroæ¶æ„çš„EC2å®ä¾‹&lt;/a>ä¸ºå®¢æˆ·é€ä¸Šäº†å‡æ€§èƒ½é™ä»·çš„å¥½äº‹ã€‚&lt;/p>
&lt;p>S3ä½œä¸ºAWSæœ€æ—©æ¨å‡ºçš„äº‘è®¡ç®—æœåŠ¡ï¼Œä»ç„¶åœ¨ä¸åœçš„åˆ›æ–°æ¼”åŒ–ä¸­ã€‚ç›®å‰S3è¾¾åˆ°äº†11ä¸ª9çš„æŒä¹…æ€§ï¼Œä¸ºæ»¡è¶³å®¢æˆ·ä¸åŒçš„å­˜å‚¨éœ€è¦ï¼Œåˆæ¨å‡ºäº†S3 Glacierã€Glacier Deep Archiveç­‰å­˜å‚¨æ–¹æ¡ˆã€‚æŒç»­æ¨å‡ºäº†Amazon Athena, Redshift, S3 selectç­‰æœåŠ¡åŠå·¥å…·è§£å†³æµ·é‡æ•°æ®çš„å¤§æ•°æ®å¤„ç†ã€‚&lt;/p>
&lt;p>AWSä¸€ç›´å°†PAYG(Pay-As-You-Go)çš„æŒ‰é‡è®¡è´¹æ¨¡å‹è´¯ç©¿åœ¨å„ç§æœåŠ¡ä¸­ã€‚æ— è®ºæ˜¯EC2(åŒ…æ‹¬GPUå®ä¾‹)ï¼ŒELBï¼ŒNATç½‘å…³ç­‰ç­‰éƒ½æä¾›å°æ—¶çº§çš„æŒ‰é‡è®¡è´¹ã€‚é˜¿é‡Œäº‘åœ¨è¿™æ–¹é¢è¿˜æœ‰è¾ƒå¤šçš„æ”¹è¿›ç©ºé—´ï¼Œä¾‹å¦‚GPUå®ä¾‹æœ€å°å”®å–æ—¶é•¿ä¸ºä¸€å‘¨ï¼ŒSLBé¦–å…ˆæŒ‰è§„æ ¼å”®å–ï¼ŒNATç½‘å…³æŒ‰è‡ªç„¶æ—¥è®¡è´¹ã€‚&lt;/p>
&lt;p>IAMä¸ºäº‘ä¸Šçš„èµ„æºæä¾›äº†æœ€ç»†ç²’åº¦çš„æˆæƒç®¡ç†ï¼ŒAWSå„ä¸ªæœåŠ¡ä¸¥æ ¼æŒ‰æœ€ç»†ç²’åº¦æ§åˆ¶æˆæƒï¼Œæ»¡è¶³ä¼ä¸šçš„æƒé™ç®¡ç†ã€‚åœ¨æˆ‘ä½¿ç”¨è¿‡çš„æ•°ä¸ªé˜¿é‡Œäº‘æœåŠ¡ä¸­ï¼Œå¤šæ¬¡é‡åˆ°è¾ƒæ–°çš„æœåŠ¡IAMè®¾è®¡ä¸å‘¨ï¼Œæƒé™ç²’åº¦è¿‡å¤§ï¼Œç”šè‡³åŠŸèƒ½æ— æ³•å·¥ä½œçš„æƒ…å†µä¸‹å°±ä¸Šçº¿å‘å¸ƒäº†ã€‚&lt;/p>
&lt;p>AWS CloudFormationæä¾›äº†äº‘ä¸Šèµ„æºç¼–æ’ç®¡ç†ï¼Œå®ç°äº†èµ„æºçš„ä»£ç åŒ–ï¼Œç‰ˆæœ¬åŒ–(é€šå¸¸ç§°ä¸ºçš„Infrastrucure as Code)ã€‚å°†äº‘ç«¯èµ„æºçš„ç®¡ç†è¿ç»´æå‡åˆ°ä¸€ä¸ªæ–°çš„å±‚æ¬¡ã€‚&lt;/p>
&lt;p>AWSæä¾›äº†ä¸‰ç§æ–¹å¼ç®¡ç†äº‘ä¸Šèµ„æºï¼ŒWeb Console, CLIä»¥åŠAPIã€‚è¿™ä¸‰ç§æ–¹å¼ï¼Œå°½æœ€å¤§åŠªåŠ›æä¾›ä¸€è‡´çš„åŠŸèƒ½ã€‚&lt;/p>
&lt;p>AWSåŒæ—¶æ˜¯ä¸€ä¸ªäº‘è®¡ç®—çš„ç”Ÿæ€ï¼Œå„ç±»ä¸‰æ–¹äº‘æœåŠ¡å‚å•†é€šè¿‡Marketplaceå”®å–å„ç±»SaaSï¼ŒPaaSæœåŠ¡ï¼Œå½¢æˆä¸€ä¸ªäº‘è®¡ç®—ç”¨æˆ·ï¼Œä¸‰æ–¹æœåŠ¡Vendorï¼ŒAWSä¸‰æ–¹å…±èµ¢çš„å±€é¢ã€‚&lt;/p>
&lt;p>æ€»å¾—è¯´æ¥ï¼ŒAWSæŒç»­çš„åœ¨äº‘è®¡ç®—æ ¸å¿ƒæœåŠ¡å’Œå…³é”®æœåŠ¡æŠ•å…¥ï¼Œä¸åœçš„åˆ›æ–°ï¼Œä¿è¯äº†AWSæ•´ä½“æœåŠ¡çš„é¢†å…ˆã€‚&lt;/p>
&lt;p>æ¥ä¸‹æ¥çœ‹çœ‹é˜¿é‡Œäº‘çš„å¼ºé¡¹ã€‚&lt;/p>
&lt;figure>
&lt;img src="https://kane.mx/posts/2019/aws-vs-aliyun/aliyun-pros.jpg"
alt="Aliyun&amp;#39;s Pros"/>
&lt;/figure>
&lt;p>é˜¿é‡Œäº‘åœ¨æä¾›åŸºæœ¬çš„è®¡ç®—ã€å­˜å‚¨ã€ç½‘ç»œå¤–ï¼Œé¢å¤–æä¾›äº†å¾ˆå¤šSaaSæœåŠ¡ï¼Œä¾‹å¦‚ï¼ŒApplication Performance Monitorï¼Œ Performance Testing Service, æ—¥å¿—æœåŠ¡ï¼Œé“¾è·¯è¿½è¸ªæœåŠ¡ï¼Œæ•°æ®åº“ç®¡ç†æœåŠ¡ç­‰ã€‚è¿™äº›æœåŠ¡æ˜¾ç„¶åŒé˜¿é‡Œäº‘æœ‰æ›´å¥½çš„é›†æˆï¼Œå¯¹ç”¨æˆ·æ¥è¯´æä¾›äº†å¼€ç®±å³ç”¨çš„è§£å†³æ–¹æ¡ˆã€‚è€Œè¿™ä¹Ÿæ˜¯ä¸€æŠŠåŒåˆƒå‰‘ï¼Œåˆ©ç”¨å¹³å°æ†ç»‘çš„ä¼˜åŠ¿æŠ¢å åˆä½œå¼€å‘å•†çš„å¸‚åœºï¼Œé•¿æœŸæ¥è¯´åˆ©ç”¨å¹³å°å„æ–­ä¸åˆ©äºåŸºäºé˜¿é‡Œäº‘çš„æŠ€æœ¯æœåŠ¡åˆ›ä¸šã€‚&lt;/p>
&lt;p>æ€»ä¹‹ï¼Œé˜¿é‡Œäº‘åœ¨äº‘è®¡ç®—æ ¸å¿ƒæœåŠ¡ä¸ŠåŒAWSæ¯”è¿˜æœ‰å·®è·ï¼Œä½†ä»–åœ¨PaaS/SaaSæœåŠ¡ä¸Šå‘å±•ä¸é”™ï¼Œæ›´åŠ å®¹æ˜“æä¾›å…¨å¥—åŸºäºé˜¿é‡Œäº‘çš„è§£å†³æ–¹æ¡ˆã€‚ç”±äºé˜¿é‡Œäº‘åœ¨å›½å†…æ•°æ®ä¸­å¿ƒæ•°é‡ä¸Šçš„ä¼˜åŠ¿åŠ ä¸Šä»ä¸‡ç½‘æ”¶è´­çš„BGPèµ„æºï¼Œå…¶æœåŠ¡åœ¨å›½å†…è®¿é—®ç½‘ç»œå»¶è¿Ÿä¼šæ›´ä½ã€‚&lt;/p>
&lt;p>æœ€åï¼Œè°ˆä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„è¯é¢˜ï¼Œæ˜¯å¦éœ€è¦è€ƒè™‘äº‘å‚å•†çš„é”å®šã€‚&lt;/p>
&lt;figure>
&lt;img src="https://kane.mx/posts/2019/aws-vs-aliyun/cloud-lock-in-issue.jpg"
alt="Lock-in"/>
&lt;/figure>
&lt;p>Kubernetesäº‹å®ä¸Šæˆä¸ºå®¹å™¨ç¼–æ’å¹³å°ï¼Œé¦–å…ˆè€ƒè™‘ä½¿ç”¨K8SåŠ&lt;a href="https://landscape.cncf.io/">CNCF landscape&lt;/a>ä¸‹çš„é¡¹ç›®ä½œä¸ºåº”ç”¨è¿è¡Œç¯å¢ƒï¼Œå‡å°‘å¯èƒ½çš„è¿ç§»å’Œå­¦ä¹ æˆæœ¬ã€‚&lt;/p>
&lt;p>å¯¹ä¸åŒç”¨é‡çš„å…¬å¸æ¥è¯´ï¼Œè€ƒè™‘äº‘å‚å•†é”å®šçš„ç»´åº¦å®Œå…¨ä¸ä¸€æ ·ã€‚åˆ›ä¸šå‹å…¬å¸æˆ–ä»åœ¨å¿«é€Ÿå‘å±•ä¸šåŠ¡ä¸­çš„ä¸­å¤§å‹ä¼ä¸šé¦–å…ˆåº”è¯¥é€‰æ‹©å¯é æ€§é«˜ï¼Œè§£å†³æ–¹æ¡ˆå¤šï¼Œæ˜“å­¦ä¹ çš„äº‘å‚å•†ï¼Œå°½å¯èƒ½åˆ©ç”¨äº‘å‚å•†çš„å„ç§æœåŠ¡åšåˆ°å¿«é€Ÿé«˜æ•ˆå¯é çš„æ¨è¿›ä¸šåŠ¡ï¼Œå°†å°½é‡å¤šçš„ç²¾åŠ›ã€äººåŠ›æŠ•å…¥åˆ°ä¸šåŠ¡ç›¸å…³çš„äº‹æƒ…ä¸Šã€‚ä¸šåŠ¡ç¨³å®šçš„å¤§å‹å…¬å¸ï¼Œå¯ä»¥ä½¿ç”¨å¤šæ•°æ®ä¸­å¿ƒå®ç°å…³é”®ä¸šåŠ¡çš„é«˜å¯ç”¨æ€§ï¼Œè·¨äº‘å®Œå…¨ä¸åº”è¯¥ä½œä¸ºé«˜å¯ç”¨çš„å¿…è¦è§£å†³é€”å¾„ã€‚å¦å¤–ï¼Œäº‘å‚å•†ç»å¯¹ä¼šæŠ•å…¥é¢å¤–çš„äººåŠ›ï¼Œä¼˜å…ˆçº§æ”¯æŒä»–ä»¬çš„å¤§å®¢æˆ·ï¼Œç”šè‡³ä¸ºè¿™ç±»å®¢æˆ·è°ƒæ•´äº§å“ç ”å‘ä¼˜å…ˆçº§æˆ–ååŒå®ŒæˆæŸäº›åŠŸèƒ½ï¼Œè¿™æ ·ç»å¯¹æ˜¯ä¸ªåŒèµ¢çš„å±€é¢ï¼ŒNetflixå’ŒAWSçš„äº’ç›¸æˆå°±å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚æ²¡æœ‰ç‰¹åˆ«å¿…è¦çš„åŸå› ï¼Œä¸è¦è½»æ˜“æŠ•å…¥ç²¾åŠ›å°†ä¸šåŠ¡ä»æœåŠ¡å·²ç»å¾ˆç¨³å®šçš„äº‘å‚å•†è¿ç§»åˆ°å¤šäº‘å¹³å°ä¸Šï¼Œé‚£æ ·å¾€å¾€æ˜¯ç™½ç™½è€—è´¹åŠ›æ°”ã€‚&lt;/p>
&lt;blockquote>
&lt;p>ä¸‹é¢æ˜¯slideçš„æœ€æ–°å®Œæ•´ç‰ˆæœ¬ï¼Œ&lt;/p>
&lt;/blockquote>
&lt;div class="responsive-wrap">
&lt;iframe src="https://docs.google.com/presentation/d/e/2PACX-1vSaKV41ItphpZVxL371It7WN55FKQqEdXUTjYgFAA2nQ7IT5AbvNaONldvvLtoG87hB8EG1ASbS0HMY/embed?start=false&amp;amp;loop=false&amp;amp;delayms=5000" frameborder="0" width="960" height="569" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true">&lt;/iframe>
&lt;/div></description></item><item><title>Serverless framework 101</title><link>https://kane.mx/posts/2019/serverless-framework/</link><pubDate>Thu, 16 May 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2019/serverless-framework/</guid><description>&lt;p>&lt;a href="https://serverless.com/">Serverless Framework&lt;/a>æ˜¯ä¸€ä¸ªå¼€æºå‘½ä»¤è¡Œå·¥å…·ã€‚ä»–æä¾›å‡½æ•°è„šæ‰‹æ¶ã€æµç¨‹è‡ªåŠ¨åŒ–ã€æœ€ä½³å®è·µç­‰å¸®åŠ©å¼€å‘ã€éƒ¨ç½²è·¨äº‘å‚å•†çš„æ‰˜ç®¡æ— æœåŠ¡å™¨è®¡ç®—æœåŠ¡(å®˜æ–¹å·²æ”¯æŒaws, Azure, GCP, IBM Cloudç­‰å„ç§å‚å•†çš„æ— æœåŠ¡å™¨è®¡ç®—)ã€‚åŒæ—¶æ”¯æŒä½¿ç”¨æ’ä»¶æ¥æ‰©å±•å„ç§åŠŸèƒ½ï¼Œæ¯”å¦‚æ”¯æŒæ›´å¤šäº‘å‚å•†æ— æœåŠ¡å™¨è®¡ç®—æœåŠ¡ï¼Œä¾‹å¦‚&lt;a href="https://github.com/aliyun/serverless-aliyun-function-compute">é˜¿é‡Œäº‘çš„å‡½æ•°è®¡ç®—&lt;/a>ã€‚&lt;/p>
&lt;p>è¿™é‡Œä½¿ç”¨&lt;a href="https://kane.mx/posts/effective-cloud-computing/serverless-dingtalk-callback/">åŸºäºå‡½æ•°è®¡ç®—çš„é’‰é’‰å›è°ƒå‡½æ•°æ¥å£&lt;/a>ç¤ºä¾‹æ¥æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨&lt;a href="https://serverless.com/">Serverless Framework&lt;/a>å°†ä¸€ä¸ªæ— æœåŠ¡å™¨å‡½æ•°éƒ¨ç½²åˆ°&lt;a href="https://aws.amazon.com/lambda">AWS Lambda&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;a href="https://serverless.com/framework/docs/getting-started/">å®‰è£…servereless&lt;/a>åï¼Œå¯ä»¥é€šè¿‡&lt;code>serverless create&lt;/code>å‘½ä»¤åˆ›å»ºå‡½æ•°è„šæ‰‹æ¶å·¥ç¨‹ï¼Œæˆ–è€…åœ¨å·²æœ‰å·¥ç¨‹çš„ä¸‹åˆ›å»ºserverlessé…ç½®æ–‡ä»¶&lt;code>serverless.yml&lt;/code>ã€‚&lt;/p>
&lt;p>æ¥ä¸‹æ¥å¯ä»¥å‚è€ƒ&lt;a href="https://serverless.com/framework/docs/providers/aws/guide/serverless.yml/">serverless aws reference&lt;/a>é…ç½®ä½ çš„aws lambdaå‡½æ•°åŠéœ€è¦çš„å„ç§èµ„æºã€‚å¦‚æœå·²ç»æœ‰è¿‡ä½¿ç”¨&lt;a href="https://docs.aws.amazon.com/cloudformation/?id=docs_gateway">AWS CloudFormation&lt;/a>æˆ–è€…&lt;a href="https://docs.aws.amazon.com/serverless-application-model/?id=docs_gateway">AWS SAM&lt;/a>ç»éªŒçš„ï¼Œå¯ä»¥å¾ˆå¿«é€‚åº”ç¼–å†™Serverlessé…ç½®ã€‚Serverlessçš„é…ç½®æœ¬è´¨ä¸Šæ˜¯å°†CloudFormation/SAMç›¸å…³çš„æ¦‚å¿µè¿›è¡ŒæŠ½è±¡ï¼Œä¸ºå„ä¸ªäº‘å‚å•†çš„æ— æœåŠ¡å™¨è®¡ç®—æœåŠ¡æä¾›ç»Ÿä¸€çš„å·¥å…·ã€å‘½ä»¤ä»¥åŠæ¦‚å¿µæŠ½è±¡ã€‚åœ¨éƒ¨ç½²aws lambdaæ—¶ï¼Œ&lt;code>serverless&lt;/code>é…ç½®ä¼šè¢«è½¬æ¢ä¸º&lt;code>CloudFormation&lt;/code>é…ç½®ï¼Œé€šè¿‡AWS APIè¿›è¡Œåˆ›å»ºæˆ–å˜æ›´ã€‚&lt;/p>
&lt;p>å¯¹äºDingtalk Callback on AWS Lambda, &lt;code>serverless&lt;/code>é…ç½®å£°æ˜å¦‚ä¸‹ã€‚å…¶ä¸­æŒ‡å®šäº†serviceçš„åŸºæœ¬ä¿¡æ¯ï¼Œå…¨å±€çš„é…ç½®(å¦‚stageã€regionç­‰)ã€äº‘å‚å•†provider(è¿™é‡Œæ˜¯aws)ã€‚å‡½æ•°çš„åŸºæœ¬ä¿¡æ¯ã€æƒé™ã€layerã€è§¦å‘å™¨ï¼Œè‡ªå®šä¹‰layerä»¥åŠå…¶ä»–äº‘å‚å•†èµ„æºï¼Œæ¯”å¦‚Dingtalk callbackè¿™é‡Œç”¨åˆ°çš„DynamoDBã€‚å®Œæ•´çš„serverlessé…ç½®æŸ¥çœ‹&lt;a href="https://github.com/zxkane/dingtalk-callback-on-aws/blob/master/serverless.yml">è¿™é‡Œ&lt;/a>ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="color:#f92672">service&lt;/span>:
&lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">dingtalk-callback&lt;/span>
&lt;span style="color:#f92672">frameworkVersion&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;&amp;gt;=1.0.0 &amp;lt;2.0.0&amp;#34;&lt;/span>
&lt;span style="color:#f92672">provider&lt;/span>:
&lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">aws&lt;/span>
&lt;span style="color:#f92672">runtime&lt;/span>: &lt;span style="color:#ae81ff">java8&lt;/span>
&lt;span style="color:#f92672">stage&lt;/span>: &lt;span style="color:#ae81ff">${opt:stage, &amp;#39;dev&amp;#39;}&lt;/span> &lt;span style="color:#75715e"># Set the default stage used. Default is dev&lt;/span>
&lt;span style="color:#f92672">region&lt;/span>: &lt;span style="color:#ae81ff">${opt:region, &amp;#39;ap-southeast-1&amp;#39;}&lt;/span> &lt;span style="color:#75715e"># Overwrite the default region used. Default is ap-southeast-1&lt;/span>
&lt;span style="color:#f92672">profile&lt;/span>: &lt;span style="color:#ae81ff">${opt:profile, &amp;#39;default&amp;#39;}&lt;/span> &lt;span style="color:#75715e"># The default profile to use with this service&lt;/span>
&lt;span style="color:#f92672">versionFunctions&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span> &lt;span style="color:#75715e"># Optional function versioning&lt;/span>
&lt;span style="color:#f92672">endpointType&lt;/span>: &lt;span style="color:#ae81ff">regional&lt;/span> &lt;span style="color:#75715e"># Optional endpoint configuration for API Gateway REST API. Default is Edge.&lt;/span>
&lt;span style="color:#f92672">functions&lt;/span>:
&lt;span style="color:#f92672">dingtalk-callback&lt;/span>:
&lt;span style="color:#f92672">handler&lt;/span>: &lt;span style="color:#ae81ff">com.github.zxkane.dingtalk.Callback::handleRequest&lt;/span> &lt;span style="color:#75715e"># required, handler set in AWS Lambda&lt;/span>
&lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">${self:provider.stage}-dingtalk-callback&lt;/span> &lt;span style="color:#75715e"># optional, Deployed Lambda name&lt;/span>
&lt;span style="color:#f92672">memorySize&lt;/span>: &lt;span style="color:#ae81ff">384&lt;/span> &lt;span style="color:#75715e"># optional, in MB, default is 1024&lt;/span>
&lt;span style="color:#f92672">timeout&lt;/span>: &lt;span style="color:#ae81ff">15&lt;/span> &lt;span style="color:#75715e"># optional, in seconds, default is 6&lt;/span>
&lt;span style="color:#f92672">environment&lt;/span>: &lt;span style="color:#75715e"># Function level environment variables&lt;/span>
&lt;span style="color:#f92672">PARA_DD_TOKEN&lt;/span>: &lt;span style="color:#ae81ff">DD_TOKEN&lt;/span>
&lt;span style="color:#f92672">TABLE_NAME&lt;/span>: {&lt;span style="color:#f92672">Ref&lt;/span>: &lt;span style="color:#ae81ff">BPMTable}&lt;/span>
&lt;span style="color:#f92672">package&lt;/span>:
&lt;span style="color:#f92672">artifact&lt;/span>: &lt;span style="color:#ae81ff">build/libs/dingtalk-callback-1.0.0-SNAPSHOT.jar&lt;/span>
&lt;span style="color:#f92672">role&lt;/span>: &lt;span style="color:#ae81ff">dingtalkCallbackIAMRole&lt;/span>
&lt;span style="color:#f92672">layers&lt;/span>: &lt;span style="color:#75715e"># An optional list Lambda Layers to use&lt;/span>
- {&lt;span style="color:#f92672">Ref&lt;/span>: &lt;span style="color:#ae81ff">DependenciesLambdaLayer}&lt;/span>
&lt;span style="color:#f92672">events&lt;/span>: &lt;span style="color:#75715e"># The Events that trigger this Function&lt;/span>
- &lt;span style="color:#f92672">http&lt;/span>: &lt;span style="color:#75715e"># This creates an API Gateway HTTP endpoint which can be used to trigger this function. Learn more in &amp;#34;events/apigateway&amp;#34;&lt;/span>
&lt;span style="color:#f92672">path&lt;/span>: &lt;span style="color:#ae81ff">dingtalk&lt;/span> &lt;span style="color:#75715e"># Path for this endpoint&lt;/span>
&lt;span style="color:#f92672">method&lt;/span>: &lt;span style="color:#ae81ff">post&lt;/span> &lt;span style="color:#75715e"># HTTP method for this endpoint&lt;/span>
&lt;span style="color:#f92672">layers&lt;/span>:
&lt;span style="color:#f92672">dependencies&lt;/span>:
&lt;span style="color:#f92672">path&lt;/span>: &lt;span style="color:#ae81ff">build/deps&lt;/span>
&lt;span style="color:#f92672">resources&lt;/span>: &lt;span style="color:#75715e"># CloudFormation template syntax&lt;/span>
&lt;span style="color:#f92672">Resources&lt;/span>:
&lt;span style="color:#f92672">dingtalkCallbackIAMRole&lt;/span>:
&lt;span style="color:#f92672">Type&lt;/span>: &lt;span style="color:#ae81ff">AWS::IAM::Role&lt;/span>
&lt;span style="color:#f92672">Properties&lt;/span>:
&lt;span style="color:#f92672">Policies&lt;/span>:
- &lt;span style="color:#f92672">PolicyName&lt;/span>: &lt;span style="color:#ae81ff">SSMPolicy&lt;/span>
- &lt;span style="color:#f92672">PolicyName&lt;/span>: &lt;span style="color:#ae81ff">DynamoDBPolicy&lt;/span>
&lt;span style="color:#f92672">BPMTable&lt;/span>:
&lt;span style="color:#f92672">Type&lt;/span>: &lt;span style="color:#ae81ff">AWS::DynamoDB::Table&lt;/span>
&lt;span style="color:#f92672">Properties&lt;/span>:
&lt;span style="color:#f92672">TableName&lt;/span>: &lt;span style="color:#ae81ff">bpm_raw_${self:service.name}_${self:provider.stage}&lt;/span>
&lt;span style="color:#f92672">ProvisionedThroughput&lt;/span>:
&lt;span style="color:#f92672">ReadCapacityUnits&lt;/span>: &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#f92672">WriteCapacityUnits&lt;/span>: &lt;span style="color:#ae81ff">1&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;p>å¯¹äºä½¿ç”¨å•ä¸€äº‘å‚å•†æ— æœåŠ¡å™¨è®¡ç®—å¹¶ä¸”å·²ç»ä½¿ç”¨äº†ç±»ä¼¼&lt;a href="https://docs.aws.amazon.com/serverless-application-model/?id=docs_gateway">sam cli&lt;/a>å®ç°æŒç»­é›†æˆã€æŒç»­éƒ¨ç½²çš„ç”¨æˆ·ï¼Œ&lt;a href="https://serverless.com/">Serverless Framework&lt;/a>å¹¶ä¸èƒ½å¸¦æ¥æ›´å¤šç”Ÿäº§åŠ›çš„æå‡ï¼Œåœ¨ç¨³å®šæ€§(å°è£…äº‘å‚å•†çš„åŠŸèƒ½ï¼Œå¢åŠ å¤æ‚åº¦å¾ˆå¯èƒ½å¼•å…¥æ–°çš„é—®é¢˜)æˆ–åŠŸèƒ½çš„åŠæ—¶æ€§ä¸Šå¯èƒ½è¿˜ä¸å¦‚äº‘å‚å•†æä¾›çš„å·¥å…·ã€‚&lt;/p>
&lt;p>å¯¹äºæœ‰å¤šäº‘å‚å•†éƒ¨ç½²æ— æœåŠ¡å™¨å‡½æ•°éœ€æ±‚çš„ç”¨æˆ·ï¼Œä½¿ç”¨äº†&lt;a href="https://serverless.com/">Serverless Framework&lt;/a>&lt;strong>å¹¶ä¸èƒ½&lt;/strong>è½»æ¾çš„å°†æ— æœåŠ¡å™¨å‡½æ•°éƒ¨ç½²åˆ°ä¸åŒäº‘å‚å•†çš„æ‰˜ç®¡æœåŠ¡ä¸Šï¼Œä»–åªæ˜¯å¸®åŠ©æä¾›è·¨äº‘å‚å•†çš„ç»Ÿä¸€å·¥å…·é“¾åŠç›¸ä¼¼çš„æŒç»­é›†æˆã€éƒ¨ç½²ç­‰æœ€ä½³å®è·µæµç¨‹ã€‚ä¾‹å¦‚å°†ä¸€å¥—å‡½æ•°ä»AWSè¿ç§»åˆ°Azureä¸Šï¼Œéœ€è¦é‡æ–°å®ç°Azure providerä¸‹çš„é…ç½®ï¼Œå› ä¸ºäº‘å‚å•†çš„æ‰˜ç®¡æ— æœåŠ¡å™¨æœåŠ¡å’Œå…¶ä»–äº‘èµ„æºéƒ½å­˜åœ¨ç€å¤§é‡å·®å¼‚ã€‚å¦å¤–å‡½æ•°ä»£ç ä¹Ÿéœ€è¦é¢ä¸´æ”¹é€ ï¼Œä¸åŒäº‘å‚å•†çš„è§¦å‘å™¨æ¶ˆæ¯äº‹ä»¶ä¹Ÿéƒ½æœ‰ä¸åŒçš„æ ¼å¼ï¼è¿™é‡Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ç±»ä¼¼&lt;a href="https://spring.io/projects/spring-cloud-function">Spring Cloud Function&lt;/a>è¿™æ ·çš„è§£å†³æ–¹æ¡ˆæ¥å®ç°è·¨äº‘å‚å•†çš„å‡½æ•°ç¼–å†™ã€‚&lt;/p>
&lt;p>æ€»ä¹‹ï¼Œ&lt;a href="https://serverless.com/">Serverless Framework&lt;/a>å¯¹äºè·¨äº‘å‚å•†éƒ¨ç½²åœºæ™¯æœ‰ä¸€å®šç”Ÿäº§æ•ˆç‡çš„æå‡ï¼Œä½†ä»–ç¦»å®Œç¾è§£å†³è·¨äº‘å‚å•†æ— æœåŠ¡å™¨æ‰˜ç®¡æœåŠ¡ï¼ˆå„å‚å•†æœåŠ¡å¤©ç”Ÿä¸å…¼å®¹ï¼‰è¿˜æœ‰å¾ˆè¿œçš„è·ç¦»ï¼Œä¹Ÿè®¸è¿™ä¸ªæ€è·¯å°±æ˜¯èµ°ä¸é€šçš„ğŸ˜•ã€‚&lt;/p></description></item><item><title>AWS Lambda Layerå®è·µ</title><link>https://kane.mx/posts/2019/aws-lambda-layers/</link><pubDate>Tue, 14 May 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2019/aws-lambda-layers/</guid><description>&lt;p>åœ¨&lt;a href="https://kane.mx/posts/effective-cloud-computing/serverless-dingtalk-callback/">åŸºäºå‡½æ•°è®¡ç®—çš„é’‰é’‰å›è°ƒå‡½æ•°æ¥å£&lt;/a>ä¸­ä½¿ç”¨é’‰é’‰å›è°ƒå‡½æ•°æ¡ˆä¾‹å®è·µäº†&lt;a href="https://aws.amazon.com/lambda/">AWS Lambda&lt;/a>æ— æœåŠ¡å‡½æ•°ã€‚è¯¥ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†è‡ªå®šä¹‰çš„å‡½æ•°ä»£ç åŠä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“ï¼ˆæ¯”å¦‚jsonå¤„ç†åº“jackson, é’‰é’‰openapiåŠ å¯†åº“, aws dynamodb clientç­‰ï¼‰æ•´ä½“æ‰“åŒ…ä¸ºä¸€ä¸ªéƒ¨ç½²åŒ…ï¼Œä¸Šä¼ åˆ°lamdbaä»£ç ä»“åº“ç”¨äºå‡½æ•°æ‰§è¡Œã€‚&lt;/p>
&lt;p>ç„¶è€Œå®é™…é¡¹ç›®ä¸­ï¼Œå…¶å®æœ‰å¤§é‡çš„ç›¸å…³å‡½æ•°å¯èƒ½ä¼šå…±äº«è¿™äº›åŸºç¡€ä¾èµ–åº“ã€ä¸‰æ–¹å‡½æ•°åº“(æ¯”å¦‚headless chrome(Puppeteer), pandoc, OCR library &amp;ndash; Tesseractç­‰ç­‰)æˆ–è€…ä½¿ç”¨è‡ªå®šä¹‰runtime(å¦‚å®˜æ–¹æœªæ”¯æŒçš„java11)çš„éœ€æ±‚ã€‚AWS Lambdaåœ¨å»å¹´åº•å‘å¸ƒäº†&lt;a href="https://aws.amazon.com/about-aws/whats-new/2018/11/aws-lambda-now-supports-custom-runtimes-and-layers/">Lambda layersåŠŸèƒ½&lt;/a>æ¥æ»¡è¶³ä¸Šè¿°è¿™äº›å®é™…å¼€å‘ä¸­çš„éœ€æ±‚ã€‚&lt;/p>
&lt;p>æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å°†&lt;a href="https://kane.mx/posts/effective-cloud-computing/serverless-dingtalk-callback/">å‰æ–‡&lt;/a>ä¸­çš„&lt;a href="https://github.com/zxkane/dingtalk-callback-on-aws/blob/267b5f11851148f5a23a834b8b7ecd4d3b247ce7/build.gradle.kts#L71-L91">å‡½æ•°ä¾èµ–&lt;/a>æ”¾ç½®åˆ°ä¸€ä¸ªå•ç‹¬çš„layerä¸­ï¼Œä½œä¸ºä¸åŒå‡½æ•°çš„å…±äº«ä¾èµ–åº“ã€‚&lt;/p>
&lt;p>åœ¨æˆ‘ä»¬çš„æ„å»ºé…ç½®&lt;code>build.gradle&lt;/code>ä¸­ï¼Œå°†&lt;a href="https://github.com/zxkane/dingtalk-callback-on-aws/blob/c6a293ac58b6892278c296daa237453279f50064/build.gradle.kts#L153-L157">å‡½æ•°çš„å…±äº«ä¾èµ–æ‹·è´&lt;/a>åˆ°java runtime&lt;a href="https://docs.aws.amazon.com/lambda/latest/dg/configuration-layers.html#configuration-layers-path">ç‰¹å®šçš„ç›®å½•ç»“æ„&lt;/a>&lt;code>java/lib/&lt;/code>ä¸‹ï¼Œ&lt;/p>
&lt;div class="highlight">&lt;div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">153
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">154
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">155
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">156
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">157
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-gradle" data-lang="gradle">tasks&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#a6e22e">register&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>Copy&lt;span style="color:#f92672">&amp;gt;(&lt;/span>&lt;span style="color:#e6db74">&amp;#34;depsLayer&amp;#34;&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
into&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#e6db74">&amp;#34;$buildDir/deps/java/lib&amp;#34;&lt;/span>&lt;span style="color:#f92672">)&lt;/span>
from&lt;span style="color:#f92672">(&lt;/span>configurations&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#a6e22e">compileClasspath&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#a6e22e">get&lt;/span>&lt;span style="color:#f92672">())&lt;/span>
from&lt;span style="color:#f92672">(&lt;/span>configurations&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#a6e22e">runtimeClasspath&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#a6e22e">get&lt;/span>&lt;span style="color:#f92672">())&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>æ¥ä¸‹æ¥å°†å…±äº«çš„ä¾èµ–åˆ›å»ºä¸ºä¸€ä¸ªlambda layerï¼Œå¹¶ä¸”è®©callbackå‡½æ•°ä¾èµ–è¿™ä¸ªå…±äº«layerï¼Œä¸å†å°†æ‰€æœ‰çš„ä¾èµ–æ‰“åŒ…ä¸ºä¸€ä¸ªå¾ˆå¤§çš„éƒ¨ç½²åŒ…å‡å°æ¯æ¬¡å˜æ›´éœ€è¦å‘å¸ƒçš„åŒ…å¤§å°ã€‚&lt;/p>
&lt;div class="highlight">&lt;div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yaml" data-lang="yaml"> &lt;span style="color:#f92672">DependenciesLayer&lt;/span>:
&lt;span style="color:#f92672">Type&lt;/span>: &lt;span style="color:#ae81ff">AWS::Serverless::LayerVersion&lt;/span>
&lt;span style="color:#f92672">Properties&lt;/span>:
&lt;span style="color:#f92672">LayerName&lt;/span>: &lt;span style="color:#ae81ff">DingTalkDependencies&lt;/span>
&lt;span style="color:#f92672">Description&lt;/span>: &lt;span style="color:#ae81ff">DingTalk Dependencies Layer&lt;/span>
&lt;span style="color:#f92672">ContentUri&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;build/deps&amp;#39;&lt;/span>
&lt;span style="color:#f92672">CompatibleRuntimes&lt;/span>:
- &lt;span style="color:#ae81ff">java8&lt;/span>
&lt;span style="color:#f92672">LicenseInfo&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;Available under the MIT-0 license.&amp;#39;&lt;/span>
&lt;span style="color:#f92672">RetentionPolicy&lt;/span>: &lt;span style="color:#ae81ff">Retain&lt;/span>
&lt;span style="color:#f92672">CallbackFunction&lt;/span>:
&lt;span style="color:#f92672">Type: AWS::Serverless::Function # More info about Function Resource&lt;/span>: &lt;span style="color:#ae81ff">https://github.com/awslabs/serverless-application-model/blob/master/versions/2016-10-31.md#awsserverlessfunction&lt;/span>
&lt;span style="color:#f92672">Properties&lt;/span>:
&lt;span style="color:#f92672">CodeUri&lt;/span>: &lt;span style="color:#ae81ff">build/libs/dingtalk-callback-1.0.0-SNAPSHOT.jar&lt;/span>
&lt;span style="color:#f92672">Handler&lt;/span>: &lt;span style="color:#ae81ff">com.github.zxkane.dingtalk.Callback::handleRequest&lt;/span>
&lt;span style="color:#f92672">Layers&lt;/span>:
- !&lt;span style="color:#ae81ff">Ref DependenciesLayer&lt;/span>
&lt;span style="color:#ae81ff">Policies:&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>åœ¨consoleæŸ¥çœ‹éƒ¨ç½²åçš„å‡½æ•°ï¼Œå¦‚ä¸‹å›¾ï¼Œå¯ä»¥çœ‹åˆ°å‡½æ•°æ–°å¢äº†ä¸€ä¸ªlayerã€‚&lt;/p>
&lt;figure>
&lt;img src="https://kane.mx/posts/2019/aws-lambda-layers/lambda-with-layers.png"
alt="lambda with layers"/>
&lt;/figure>
&lt;p>åŒå…¶ä»–çš„è¯­è¨€ã€æŠ€æœ¯ä¸€æ ·ï¼Œ&lt;a href="https://github.com/mthenw/awesome-layers">Awesome Layers&lt;/a>é¡¹ç›®æ”¶é›†äº†ç›®å‰ä¸€äº›å¸¸ç”¨ä¸”ç»´æŠ¤è¾ƒå¥½çš„layerï¼Œè‡ªåˆ›è½®å­ä¹‹å‰å¯ä»¥å…ˆå‚è€ƒä¸‹ğŸ˜€ã€‚&lt;/p>
&lt;p>ä½¿ç”¨layeråŒæ ·æœ‰ä»¥ä¸‹é™åˆ¶ï¼Œä½¿ç”¨å‰éœ€è¦æ³¨æ„ï¼Œ&lt;/p>
&lt;ul>
&lt;li>ä¾èµ–çš„layeræ•°ä¸èƒ½è¶…è¿‡5ä¸ª&lt;/li>
&lt;li>å‡½æ•°ä»¥åŠä¾èµ–çš„æ‰€æœ‰layersè§£å‹åä¸å¯ä»¥è¶…è¿‡250MB&lt;/li>
&lt;/ul></description></item><item><title>QCon2019åŒ—äº¬ç«™å›é¡¾</title><link>https://kane.mx/posts/2019/2019-qconbeijing-reviews/</link><pubDate>Thu, 09 May 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2019/2019-qconbeijing-reviews/</guid><description>&lt;p>è¿™å‘¨å‚åŠ äº†&lt;a href="https://2019.qconbeijing.com/">QCon 2019åŒ—äº¬ç«™&lt;/a>ï¼Œè¿™é‡Œè®°å½•ä¸‹éƒ¨åˆ†å°è±¡æ·±åˆ»çš„ä¸»é¢˜ä»¥åŠä¸ªäººæ„Ÿå—ã€‚&lt;/p>
&lt;p>QConæ˜¯ç”±InfoQä¸»åŠçš„ç»¼åˆæ€§æŠ€æœ¯ç››ä¼šï¼Œä¸»é¢˜æ¶µç›–äº†å¤§å‰ç«¯ã€é«˜å¯ç”¨æ¶æ„ã€å®¹å™¨æŠ€æœ¯ã€å¤§æ•°æ®ã€æœºå™¨å­¦ä¹ ç­‰å„ç§çƒ­é—¨æŠ€æœ¯ä¸»é¢˜ã€‚å…¶ä¸­ä¹Ÿä¸ä¹&lt;a href="https://2019.qconbeijing.com/track/501">ä¸‹ä¸€ä»£åˆ†å¸ƒå¼åº”ç”¨&lt;/a>ã€&lt;a href="https://2019.qconbeijing.com/track/565">æ··æ²Œå·¥ç¨‹&lt;/a>ç­‰å‰æ²¿æœ‰æ„æ€çš„ä¸»é¢˜ï¼Œåé¢ä¼šè¯¦ç»†ä»‹ç»ç›¸å…³çš„ä¸»é¢˜æ¼”è®²ã€‚&lt;/p>
&lt;h3 id="å·¥ç¨‹æ•ˆç‡æå‡">å·¥ç¨‹æ•ˆç‡æå‡&lt;/h3>
&lt;p>è¿™æ˜¯åœ¨QConç¬¬ä¸€æ—¥ä¸ªäººæ„Ÿå…´è¶£ä¸”éå¸¸æœ‰æ„æ€çš„ä¸€ä¸ª&lt;a href="https://2019.qconbeijing.com/track/499">ç³»åˆ—ä¸»é¢˜&lt;/a>ã€‚æ— è®ºæ˜¯åˆ›ä¸šå…¬å¸ã€ç‹¬è§’å…½ä¼ä¸šè¿˜æ˜¯äº’è”ç½‘å·¨å¤´éƒ½å¸Œæœ›ä¸æ–­æå‡å·¥ç¨‹æ•ˆç‡ï¼Œ3ä¸ªç›¸å…³çš„åˆ†äº«åˆ†åˆ«æ¥è‡ªBATï¼Œå¯è§äº’è”ç½‘å·¨å¤´ä»¬å¯¹å›¢é˜Ÿæ•ˆç‡æå‡çš„æ¸´æœ›å’Œé‡è§†ã€‚&lt;/p>
&lt;h4 id="10å€é€ŸåŸåˆ™å¯¹å·¥ç¨‹ç”Ÿäº§åŠ›å»ºè®¾çš„æ–¹å‘æ€§å½±å“qiaoliang-talk">&lt;a href="https://2019.qconbeijing.com/presentation/1505">10å€é€ŸåŸåˆ™å¯¹å·¥ç¨‹ç”Ÿäº§åŠ›å»ºè®¾çš„æ–¹å‘æ€§å½±å“&lt;/a>&lt;/h4>
&lt;p>è¿™ä¸ªtalkæ¥è‡ªè…¾è®¯çš„é«˜çº§é¡¾é—®ä¹”æ¢ï¼Œè¿™ä½è€å…„å·²ç»è¿ç»­10å¹´åœ¨QConä¸Šåˆ†äº«æŒç»­é›†æˆã€æŒç»­äº¤ä»˜ç­‰å·¥ç¨‹æ•ˆç‡ç›¸å…³çš„ä¸»é¢˜äº†ï¼ä»–çš„æ¼”è®²å§‹äºå¯¹æˆåŠŸä¼ä¸šçš„&lt;strong>ä¸€ä¸‡æ¬¡å®éªŒæ³•åˆ™&lt;/strong>æ–¹æ³•è®ºï¼Œ
&lt;figure>
&lt;img src="https://kane.mx/posts/2019/2019-qconbeijing-images/1%e4%b8%87%e6%ac%a1%e6%b3%95%e5%88%99.jpeg"
alt="1ä¸‡æ¬¡å®éªŒæ³•åˆ™"/>
&lt;/figure>
è€Œå¤§é‡é«˜æ•ˆçš„å®éªŒåŸºäºä¸€ä¸ª&lt;strong>åŒç¯æ¨¡å‹&lt;/strong>çš„å¿«é€ŸéªŒè¯ç¯ã€‚
&lt;figure>
&lt;img src="https://kane.mx/posts/2019/2019-qconbeijing-images/%e5%8f%8c%e7%8e%af%e6%a8%a1%e5%9e%8b.jpeg"
alt="åŒç¯æ¨¡å‹"/>
&lt;/figure>
æœ€ç»ˆå·¥ç¨‹ç”Ÿäº§åŠ›æ˜¯ç”±&lt;strong>å·¥ä½œæµç¨‹&lt;/strong>ã€&lt;strong>æ”¯æ’‘å·¥å…·&lt;/strong>å’Œ&lt;strong>å·¥ç¨‹ç´ å…»&lt;/strong>ä¸‰æ–¹é¢ä¸€èµ·å†³å®šçš„ã€‚
&lt;figure>
&lt;img src="https://kane.mx/posts/2019/2019-qconbeijing-images/%e5%b7%a5%e7%a8%8b%e7%94%9f%e4%ba%a7%e5%8a%9b.jpeg"
alt="å·¥ç¨‹ç”Ÿäº§åŠ›"/>
&lt;/figure>
&lt;/p>
&lt;blockquote>
&lt;p>éå¸¸è®¤å¯å†³å®šå·¥ç¨‹æ•ˆç‡çš„è¿™ä¸‰è¦ç´ ï¼Œä¸ªäººè®¤ä¸º&lt;strong>å·¥ç¨‹ç´ å…»&lt;/strong>æ˜¯å…¶ä»–ä¸¤ä¸ªè¦ç´ çš„åŸºçŸ³ï¼Œ&lt;a href="https://book.douban.com/subject/30356081/">å¥ˆé£æ–‡åŒ–æ‰‹å†Œ&lt;/a>ä¸­å¼€ç¯‡å¼ºè°ƒçš„åªæ‹›è˜&lt;strong>æˆå¹´äºº&lt;/strong>å°±æ˜¯å¾ˆå¥½çš„è¯ é‡Šã€‚&lt;/p>
&lt;/blockquote>
&lt;h4 id="ç™¾åº¦å·¥ç¨‹èƒ½åŠ›æå‡ä¹‹é“baidu-talk">&lt;a href="https://2019.qconbeijing.com/presentation/1487">ç™¾åº¦å·¥ç¨‹èƒ½åŠ›æå‡ä¹‹é“&lt;/a>&lt;/h4>
&lt;p>è¿™ä¸ªåˆ†äº«æ¥è‡ªç™¾åº¦ç ”å‘æ•ˆèƒ½éƒ¨é—¨çš„äº§å“ç»ç†ï¼Œä»&lt;strong>äºº&lt;/strong>ã€&lt;strong>æŠ€&lt;/strong>ã€&lt;strong>æ³•&lt;/strong>ä¸‰æ–¹é¢å¼ºè°ƒå·¥ç¨‹èƒ½åŠ›æå‡çš„ç­–ç•¥æ¨¡å‹ã€‚å…¶å®è¿™ä¸ªæ¨¡å‹å°±æ˜¯å¯¹åº”ç€ä¸Šé¢&lt;a href="#10å€é€ŸåŸåˆ™å¯¹å·¥ç¨‹ç”Ÿäº§åŠ›å»ºè®¾çš„æ–¹å‘æ€§å½±å“-qiaoliang-talk">ä¹”æ¢åˆ†äº«çš„å·¥ç¨‹ç”Ÿäº§åŠ›ä¸‰è¦ç´ &lt;/a>ã€‚
&lt;figure>
&lt;img src="https://kane.mx/posts/2019/2019-qconbeijing-images/%e6%8f%90%e5%8d%87%e5%b7%a5%e7%a8%8b%e8%83%bd%e5%8a%9b%e7%ad%96%e7%95%a5.jpeg"
alt="æå‡å·¥ç¨‹èƒ½åŠ›çš„ç­–ç•¥"/>
&lt;/figure>
å…³äºå¯¹å·¥ç¨‹å¸ˆçš„åŸ¹å…»å’ŒæŠ€æœ¯è§„èŒƒï¼Œç™¾åº¦å‘å¸ƒäº†&amp;quot;ç™¾åº¦å·¥ç¨‹å¸ˆæ‰‹å†Œ&amp;quot;ï¼Œæ®è¯´å¯ä»¥ä»ç½‘ç»œä¸Šä¸‹è½½åˆ°ã€‚å¤§é‡å·¥å…·çš„ç»†èŠ‚åˆ†äº«æ¶‰åŠçš„éƒ½æ˜¯ç™¾åº¦å†…éƒ¨å·¥å…·ï¼Œä¸è¿‡å·¥å…·é’ˆå¯¹çš„æ€è·¯è¿˜æ˜¯å¯ä»¥å€Ÿé‰´çš„ã€‚&lt;/p>
&lt;h4 id="èœé¸Ÿé›†å›¢ç ”å‘æ•ˆèƒ½å˜é©å®è·µcainiao-talk">&lt;a href="https://2019.qconbeijing.com/presentation/1439">èœé¸Ÿé›†å›¢ç ”å‘æ•ˆèƒ½å˜é©å®è·µ&lt;/a>&lt;/h4>
&lt;p>è¿™ä¸ªåˆ†äº«æ¥è‡ªé˜¿é‡Œç³»çš„èœé¸Ÿé›†å›¢ï¼Œç‰¹åˆ«å¼ºè°ƒæ•°æ®åŒ–é©±åŠ¨çš„ç ”å‘æ•ˆèƒ½æå‡ï¼Œé‡Œé¢å¾ˆæœ‰æ„æ€çš„ä¸€ç‚¹æ˜¯å»ºç«‹æˆæœ¬æ¨¡å‹æ¥è¯„ä¼°æ•ˆèƒ½çš„å¥½åã€‚&lt;/p>
&lt;blockquote>
&lt;p>ä½œä¸ºæ•ˆèƒ½éƒ¨é—¨è´Ÿè´£äººï¼Œæœ‰æ•°æ®ç‰¹åˆ«æ˜¯æˆæœ¬æ•°æ®ï¼Œè®©é«˜å±‚ç®¡ç†è€…buy-inä½ çš„æƒ³æ³•ï¼Œè¿™åº”è¯¥æ˜¯ä¸ªéå¸¸å¥½çš„è§’åº¦ã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="é«˜å¯ç”¨æ¶æ„">é«˜å¯ç”¨æ¶æ„&lt;/h3>
&lt;h4 id="å£°æ˜å¼è‡ªæ„ˆç³»ç»Ÿé«˜å¯ç”¨åˆ†å¸ƒå¼ç³»ç»Ÿçš„è®¾è®¡ä¹‹é“declarative-system-talk">&lt;a href="https://2019.qconbeijing.com/presentation/1511">å£°æ˜å¼è‡ªæ„ˆç³»ç»Ÿâ€”â€”é«˜å¯ç”¨åˆ†å¸ƒå¼ç³»ç»Ÿçš„è®¾è®¡ä¹‹é“&lt;/a>&lt;/h4>
&lt;p>è¿™ä¸ªåˆ†äº«æ¯”è¾ƒç†è®ºåŒ–çš„ä»‹ç»å£°æ˜å¼çš„ã€å¯è‡ªæ„ˆçš„åˆ†å¸ƒå¼ç³»ç»ŸåŸç†å’Œå®è·µï¼Œå…¶å®ä¸šç•Œå·²ç»æœ‰ä¸ªéå¸¸å¥½çš„å‚è€ƒå®ç° &amp;ndash; å°±æ˜¯&lt;a href="https://kubernetes.io">Kubernetes&lt;/a> ğŸ˜ƒã€‚&lt;/p>
&lt;h4 id="è¶…å¤§è§„æ¨¡é«˜å¯ç”¨æ€§äº‘ç«¯ç³»ç»Ÿæ„å»ºä¹‹ç¦…caichao-talk">&lt;a href="https://2019.qconbeijing.com/presentation/1437">è¶…å¤§è§„æ¨¡é«˜å¯ç”¨æ€§äº‘ç«¯ç³»ç»Ÿæ„å»ºä¹‹ç¦…&lt;/a>&lt;/h4>
&lt;p>è¿™æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„å·¥ç¨‹å®è·µåˆ†äº«ï¼Œåˆ—ä¸¾äº†å¤§é‡å¤§è§„æ¨¡äº‘åŸç”Ÿåº”ç”¨ä¸€å®šä¼šé¢ä¸´çš„æŒ‘æˆ˜ï¼Œä»¥åŠç®€å•åˆå®ç”¨çš„è§£å†³æ–¹æ³•ã€‚æ¯ä¸€ä¸ªäº‘åŸç”Ÿåº”ç”¨å¼€å‘è€…éƒ½åº”è¯¥çœ‹çœ‹è¿™ä¸ª&lt;a href="https://static001.geekbang.org/con/38/pdf/2428705636/file/%E8%B6%85%E5%A4%A7%E8%A7%84%E6%A8%A1%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7%E4%BA%91%E7%AB%AF%E7%B3%BB%E7%BB%9F%E6%9E%84%E5%BB%BA%E4%B9%8B%E7%A6%85-%E8%94%A1%E8%B6%85.pdf">slide&lt;/a>ï¼Œå­¦ä¹ å‰äººå®è·µçš„ç»éªŒã€‚å¦å¤–ä¸ºè®²æ¼”è€…è”¡è¶…åšä¸ªæ¨å¹¿ï¼Œå¯¹Goè¯­è¨€æœ‰å…´è¶£çš„åŒå­¦ï¼Œå¯ä»¥è€ƒè™‘å­¦ä¹ è”¡è¶…çš„æå®¢æ—¶é—´è¯¾ç¨‹&lt;a href="https://time.geekbang.org/course/intro/160">Goè¯­è¨€ä»å…¥é—¨åˆ°å®æˆ˜&lt;/a>ã€‚&lt;/p>
&lt;h3 id="è¿ç»´æ¶æ„">è¿ç»´æ¶æ„&lt;/h3>
&lt;h4 id="kubernetes-æ—¥å¿—å¹³å°å»ºè®¾æœ€ä½³å®è·µaliyun-sls-talk">&lt;a href="https://2019.qconbeijing.com/presentation/1448">Kubernetes æ—¥å¿—å¹³å°å»ºè®¾æœ€ä½³å®è·µ&lt;/a>&lt;/h4>
&lt;p>è¿™ä¸ªåˆ†äº«ä»‹ç»äº†Kubernetesä¸Šæ—¥å¿—æ–¹æ¡ˆçš„è§£å†³æ€è·¯ï¼ŒåŠå®ƒçš„å®è·µ &amp;ndash; é˜¿é‡Œäº‘çš„æ—¥å¿—æœåŠ¡ã€‚å¯¹äºå¾ˆå¤šæœ‰åŸºç¡€æœåŠ¡å»ºè®¾çš„å›¢é˜Ÿå¯ä»¥ä½œä¸ºå¾ˆå¥½çš„å‚è€ƒæ–¹æ¡ˆã€‚å¯¹äºå·²ç»æ‰˜ç®¡åœ¨é˜¿é‡Œäº‘ä¸Šçš„åº”ç”¨ï¼Œå»ºè®®å°±ä¸è¦é‡å¤å»ºè®¾ä½ç«¯çš„è½®å­äº†ï¼Œé˜¿é‡Œäº‘æ—¥å¿—æœåŠ¡åº”è¯¥åšä¸ºå›¢é˜Ÿçš„é¦–é€‰ã€‚ä¸è®ºåœ¨æ€§èƒ½åŒå…¶ä»–äº‘æ‰˜ç®¡æœåŠ¡é›†æˆä¸Šï¼Œéƒ½è¿œè¿œå¥½äºè‡ªå»ºçš„æ–¹æ¡ˆã€‚&lt;/p>
&lt;h4 id="å¤šäº‘ç®¡ä¸‹çš„è‡ªåŠ¨åŒ–è¿ç»´æ¶æ„multi-clouds-talk">&lt;a href="https://2019.qconbeijing.com/presentation/1653">å¤šäº‘ç®¡ä¸‹çš„è‡ªåŠ¨åŒ–è¿ç»´æ¶æ„&lt;/a>&lt;/h4>
&lt;p>å¤šäº‘æ˜¯ç°åœ¨ä¸€äº›å‚å•†åŠ›æ¨çš„è¯é¢˜ï¼Œä¸ªäººè®¤ä¸ºæ˜¯å¸‚åœºæ’åé åçš„æ€»è¦æ‰¾äº›æ–¹æ³•æ¥æå‡è‡ªå·±äº§å“çš„ç«äº‰åŠ›ğŸ˜ã€‚åˆ†äº«è€…ä¼ä¸šåšäº†ä¸€å¥—opså¹³å°æ¥ç®¡ç†å¤šäº‘çš„èµ„æºï¼Œä»–ä»¬é€šè¿‡adapteræ–¹å¼æ¥å°†ä¸åŒäº‘å‚å•†çš„å·®å¼‚å’Œèµ„æºè¿›è¡Œäº†æŠ½è±¡ã€‚è¿™å…¶ä¸­æ¶‰åŠå¤§é‡å¤„ç†äº§å“é—´å·®å¼‚æ€§å’Œè¢«åŠ¨é€‚é…çš„å·¥ä½œï¼Œä¸ªäººä¸å¤ªè®¤åŒè¿™ç§æ–¹å¼ã€‚å¹¶ä¸”ä¸¢æ‰äº†infra as codeè¿™ç±»é‡è¦çš„ç‰¹æ€§ï¼Œå¯¹äºæœ‰è¿™ç§éœ€æ±‚çš„å¤§å‹ä¼ä¸šæ¥è¯´ä¸æ˜¯ä¸€ä¸ªå®Œç¾çš„æ–¹æ¡ˆã€‚&lt;/p>
&lt;h3 id="æ··æ²Œå·¥ç¨‹chaos-engineering-themes">&lt;a href="https://2019.qconbeijing.com/track/565">æ··æ²Œå·¥ç¨‹&lt;/a>&lt;/h3>
&lt;p>æ··æ²Œå·¥ç¨‹è¿™ä¸ªè¯é¢˜éå¸¸æœ‰æ„æ€ï¼ŒåŒæ—¶ä¹Ÿæ˜¯è¾ƒæ–°çš„ä¸€ç§å®è·µå·¥ç¨‹ã€‚ä»æœ€æ—©çš„æå‡ºã€ç³»ç»Ÿå®è·µåˆ°ç°åœ¨è¿˜ä¸åˆ°10å¹´æ—¶é—´ã€‚æ¥è‡ªé˜¿é‡Œå·´å·´çš„&lt;a href="https://2019.qconbeijing.com/presentation/1479">äº‘åŸç”Ÿæ¶æ„ä¸‹çš„æ··æ²Œå·¥ç¨‹å®è·µ&lt;/a>å’ŒAWSçš„&lt;a href="https://2019.qconbeijing.com/presentation/1741">AWS äº‘ä¸Šæ··æ²Œå·¥ç¨‹å®è·µä¹‹å¯¹ç…§å®éªŒè®¾è®¡å’Œå®æ–½&lt;/a>ä¸¤ä¸ªåˆ†äº«ä»‹ç»äº†ä»æ··æ²Œå·¥ç¨‹çš„èµ·æºåˆ°å¦‚ä½•å…¨æ–¹ä½çš„å®è·µç”¨äºæå‡äº‘åŸç”Ÿåº”ç”¨çš„&amp;quot;éŸ§æ€§&amp;quot;ï¼Œéå¸¸å€¼å¾—å­¦ä¹ ã€‚&lt;a href="#è¶…å¤§è§„æ¨¡é«˜å¯ç”¨æ€§äº‘ç«¯ç³»ç»Ÿæ„å»ºä¹‹ç¦…-caichao-talk">è”¡è¶…çš„è¶…å¤§è§„æ¨¡é«˜å¯ç”¨æ€§äº‘ç«¯ç³»ç»Ÿæ„å»º&lt;/a>ä¹Ÿæåˆ°äº†ä½¿ç”¨æ··æ²Œå·¥ç¨‹æ¥æå‡ç³»ç»Ÿçš„é«˜å¯ç”¨æ€§ï¼Œåœ¨äº‘åŸç”Ÿåº”ç”¨è¶Šæ¥è¶Šæ™®åŠçš„æƒ…å†µä¸‹ï¼Œè¢«åŠ¨çš„è®¾è®¡é«˜å¯ç”¨ç³»ç»Ÿè‚¯å®šä¸å¦‚ä¸»åŠ¨(ç”šè‡³æŒç»­çš„è‡ªåŠ¨åŒ–)å¯æ§çš„æ³¨å…¥æ··ä¹±æ¥é€æ¸æå‡ç³»ç»Ÿçš„é«˜å¯ç”¨æ€§ã€‚ç›®å‰chaos engineeringçš„å·¥å…·/å¹³å°æ”¯æŒè¿˜ä¸å¤ªå®Œå–„ï¼Œè¿™ä¸ªæ–¹å‘çœ‹èµ·æ¥æ˜¯æŠ€æœ¯åˆ›ä¸šå¾ˆå¥½çš„åˆ‡å…¥ç‚¹ğŸ˜ã€‚æœ€ååˆ‡è®°ä¸€ç‚¹ï¼Œ&lt;strong>æ··æ²Œå·¥ç¨‹æœ€ç»ˆä¸€å®šè¦åœ¨ç”Ÿäº§ç³»ç»Ÿä¸Šå®æ–½&lt;/strong>ã€‚
&lt;figure>
&lt;img src="https://kane.mx/posts/2019/2019-qconbeijing-images/%e6%b7%b7%e5%8a%a8%e5%b7%a5%e7%a8%8b%e5%ae%9e%e8%b7%b5.jpeg"
alt="æ··åŠ¨å·¥ç¨‹å®è·µ"/>
&lt;/figure>
&lt;/p>
&lt;h3 id="ä¸‹ä¸€ä»£åˆ†å¸ƒå¼åº”ç”¨next-gen-ha-system">&lt;a href="https://2019.qconbeijing.com/track/501">ä¸‹ä¸€ä»£åˆ†å¸ƒå¼åº”ç”¨&lt;/a>&lt;/h3>
&lt;p>è¿™ä¸ªä¸»é¢˜è™½è¯´å‘½åä¸ºä¸‹ä¸€ä»£åˆ†å¸ƒå¼åº”ç”¨ï¼Œä¸»è¦åˆ†äº«çš„å¤§å¤šæ˜¯æœåŠ¡é—´æµé‡æ²»ç†é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯Service Meshä¸‹å®è·µç»éªŒã€‚å…¶ä¸­æ¥è‡ªé˜¿é‡Œæäº‘çš„&lt;a href="https://2019.qconbeijing.com/presentation/1501">åˆ†å¸ƒå¼åº”ç”¨çš„æœªæ¥â€”â€”Distributionless&lt;/a>ç‰¹åˆ«å€¼å¾—ä¸€æã€‚è¿™ä¸ªåˆ†äº«å¹¶æ²¡æœ‰å®é™…çš„æ¡ˆä¾‹æˆ–ç»éªŒåˆ†äº«ï¼Œä»–é‡ç‚¹åˆ†äº«çš„æ˜¯å¯¹äºCloud Nativeæœ¬è´¨å’Œè¶‹åŠ¿çš„çœ‹æ³•ï¼Œè¿™äº›è§‚ç‚¹æˆ‘ä¸ªäººç‰¹åˆ«è®¤åŒ(&lt;code>å¥½åƒæ‰¾åˆ°çŸ¥éŸ³ä¼¼çš„ğŸ˜€&lt;/code>)ï¼å®Œæ•´çš„slide&lt;a href="https://static001.geekbang.org/con/38/pdf/3913410004/file/%E5%88%86%E5%B8%83%E5%BC%8F%E5%BA%94%E7%94%A8%E7%9A%84%E6%9C%AA%E6%9D%A5%E2%80%94%E2%80%94Distributionless-%E6%9D%8E%E4%BA%91.pdf">è¿™é‡Œä¸‹è½½&lt;/a>ã€‚
&lt;figure>
&lt;img src="https://kane.mx/posts/2019/2019-qconbeijing-images/CloudNative%e6%9c%ac%e8%b4%a8.jpeg"
alt="CloudNativeçš„æœ¬è´¨"/>
&lt;/figure>
&lt;figure>
&lt;img src="https://kane.mx/posts/2019/2019-qconbeijing-images/CloudNative%e7%9a%84%e8%b6%8b%e5%8a%bf.jpeg"
alt="CloudNativeçš„è¶‹åŠ¿"/>
&lt;/figure>
&lt;figure>
&lt;img src="https://kane.mx/posts/2019/2019-qconbeijing-images/%e4%b8%8eCloudNative%e5%90%8c%e8%a1%8c.jpeg"
alt="ä¸CloudNativeåŒè¡Œ"/>
&lt;/figure>
&lt;/p>
&lt;h3 id="ç”¨æˆ·å¢é•¿">ç”¨æˆ·å¢é•¿&lt;/h3>
&lt;p>æ¥è‡ªäº‘æµ‹çš„é™ˆå† è¯šåœ¨&lt;a href="https://2019.qconbeijing.com/presentation/1650">æ™ºèƒ½ä¼˜åŒ– &amp;amp; A/B æµ‹è¯• - å®éªŒé©±åŠ¨ç”¨æˆ·å¢é•¿çš„ç†è®ºä¸æŠ€æœ¯å®è·µ&lt;/a>åˆ†äº«äº†A/Bæµ‹è¯•å®éªŒå¯¹ç”¨æˆ·å¢é•¿çš„ç†è®ºåŠå®è·µï¼Œé¡ºä¾¿ä¹Ÿæ¨å¹¿äº†ä»–å®¶äº‘æµ‹çš„A/Bæµ‹è¯•SaaSæœåŠ¡ã€‚å¬åœˆå†…çš„æœ‹å‹åˆ†äº«ï¼Œäº‘æµ‹çš„A/Bæµ‹è¯•æœåŠ¡ç¡®å®æ¯”è¾ƒç®€å•å¥½ç”¨ï¼Œæ–¹ä¾¿äº§å“åå°åˆ›å»ºæµ‹è¯•å¹¶åˆ†æç»“æœï¼Œå¯¹å¢é•¿æœ‰éœ€æ±‚çš„å°ä¼™ä¼´å¯ä»¥è€ƒè™‘ä½“éªŒä¸‹ï¼Œå‡å°‘ä¸å¿…è¦çš„é‡å¤å»ºè®¾è½®å­ã€‚&lt;/p></description></item><item><title>Spring Cloud or Cloud Native</title><link>https://kane.mx/posts/effective-cloud-computing/spring-cloud-or-cloud-native/</link><pubDate>Mon, 29 Apr 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/effective-cloud-computing/spring-cloud-or-cloud-native/</guid><description>&lt;p>åŸºäºJavaçš„&lt;a href="https://spring.io/projects/spring-cloud">Spring Cloud&lt;/a>æ˜¯ç”±Javaæœ€å¤§å¼€æºç”Ÿæ€&lt;a href="https://spring.io/">Spring&lt;/a>ç¤¾åŒºæ¨å‡ºçš„Out-of-Boxåˆ†å¸ƒå¼&lt;a href="https://en.wikipedia.org/wiki/Microservices">å¾®æœåŠ¡&lt;/a>è§£å†³æ–¹æ¡ˆï¼Œ&lt;a href="https://github.com/spring-projects/spring-cloud/wiki/Spring-Cloud-Angel-Release-Notes/6e0e1ba3d510d4a30b95c1468007b22f2427fa25">è‡ª2016å¹´å‘å¸ƒ&lt;/a>èµ·å°±è¢«ä¼—å¤šå¼€å‘è€…çœ‹å¥½ã€‚Javaä½œä¸ºå¹¿ä¸ºæµè¡Œçš„æœåŠ¡ç«¯ç¼–ç¨‹è¯­è¨€ï¼Œ&lt;a href="https://spring.io/projects/spring-cloud">Spring Cloud&lt;/a>ä¹Ÿå°±è¶Šæ¥è¶Šå¤šçš„è¢«ç”¨äºå¾®æœåŠ¡å¼€å‘ã€‚&lt;/p>
&lt;p>&lt;a href="https://spring.io/projects/spring-cloud">Spring Cloud&lt;/a>é›†æˆäº†&lt;a href="https://netflix.github.io/">Netflix OSS&lt;/a>å¼€æºé¡¹ç›®å®ç°äº†å¾ˆå¤šåŠŸèƒ½(æˆ–ä½œä¸ºå®ç°ä¹‹ä¸€)ï¼ŒåŒ…æ‹¬æœåŠ¡æ²»ç†ã€ç½‘å…³è·¯ç”±ã€å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ã€æœåŠ¡é—´è°ƒç”¨ã€æ–­è·¯å™¨ç­‰ã€‚&lt;a href="https://spring.io/projects/spring-cloud-netflix">Spring Cloud Netflix&lt;/a>å°†å¾ˆå¤šç”Ÿäº§çº§åˆ«å¾®æœåŠ¡èƒ½åŠ›å¼€ç®±å³ç”¨çš„å¸¦åˆ°äº†Spring Cloudæ¶æ„ä¸‹çš„å¾®æœåŠ¡ä¸­ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿçš„æ„å»ºæ»¡è¶³&lt;a href="https://12factor.net/">12è¦ç´ &lt;/a>çš„åº”ç”¨ã€‚&lt;/p>
&lt;p>åœ¨å»å¹´åº•å‘å¸ƒçš„&lt;a href="https://spring.io/blog/2018/12/12/spring-cloud-greenwich-rc1-available-now#spring-cloud-netflix-projects-entering-maintenance-mode">Spring Cloud Greenwichç‰ˆæœ¬&lt;/a>ä¸­å®£å¸ƒ&lt;a href="https://spring.io/projects/spring-cloud-netflix">Spring Cloud Netflix&lt;/a>ä¸­é‡è¦çš„ç»„ä»¶&lt;a href="https://github.com/Netflix/Hystrix#hystrix-status">Hystrix&lt;/a>ã€&lt;a href="https://github.com/Netflix/ribbon#project-status-on-maintenance">Ribbon&lt;/a>ã€&lt;code>Zuul 1&lt;/code>ç­‰ç”±äºä¸Šæ¸¸å¼€æºé¡¹ç›®è¿›å…¥ç»´æŠ¤çŠ¶æ€ï¼Œå¯¹åº”çš„Spring Cloud Netflixé¡¹ç›®ä¹Ÿè¿›å…¥åˆ°ç»´æŠ¤çŠ¶æ€ã€‚è¿™äº›é¡¹ç›®å°†&lt;strong>ä¸å†é€‚åˆ&lt;/strong>ç”¨äºé•¿æœŸç»´æŠ¤çš„äº§å“ä¸­ï¼&lt;/p>
&lt;p>åŒæ—¶éšç€è¿‘å¹´äº‘è®¡ç®—çš„å‘å±•ï¼Œç‰¹åˆ«æ˜¯&lt;a href="https://kubernetes.io/">Kubernetes&lt;/a>æˆä¸ºå®¹å™¨ç¼–æ’å¹³å°çš„äº‹å®æ ‡å‡†ï¼ŒåŠ ä¸Š&lt;a href="https://www.nginx.com/blog/what-is-a-service-mesh/">Service Mesh(æœåŠ¡ç½‘æ ¼)&lt;/a>å¯¹å¾®æœåŠ¡çš„æœåŠ¡æ²»ç†å’Œæµé‡æ§åˆ¶ï¼Œä¸º&lt;a href="https://www.redhat.com/en/topics/cloud-native-apps">äº‘åŸç”Ÿåº”ç”¨&lt;/a>æä¾›äº†æ›´ä¸ºç°ä»£ã€å¹³å°æ— å…³çš„è§£å†³æ–¹æ¡ˆã€‚&lt;/p>
&lt;p>è®©æˆ‘ä»¬é€ä¸€çœ‹çœ‹åœ¨&lt;a href="https://kubernetes.io/">Kubernetes&lt;/a>åŠ ä¸ŠSerivce Mesh(ä¾‹å¦‚&lt;a href="https://istio.io/">Istio&lt;/a>)å¦‚ä½•å®ç°å¾®æœåŠ¡çš„æœåŠ¡å‘ç°ã€è·¯ç”±ã€é“¾è·¯è¿½è¸ªã€æ–­è·¯å™¨ç­‰åŠŸèƒ½ã€‚&lt;/p>
&lt;h3 id="é…ç½®ä¸­å¿ƒ">é…ç½®ä¸­å¿ƒ&lt;/h3>
&lt;p>&lt;a href="https://spring.io/projects/spring-cloud-config">Spring Cloud Config&lt;/a>é»˜è®¤æä¾›äº†å¤šç§é…ç½®ç®¡ç†åç«¯ï¼Œä¾‹å¦‚&lt;code>Git&lt;/code>ã€&lt;code>Vault&lt;/code>ã€&lt;code>JDBC Backend&lt;/code>ç­‰ã€‚åŒæ—¶ä¹Ÿæœ‰å¾ˆå¤šå¼€æºæ–¹æ¡ˆå¯ä»¥ä½œä¸ºæ›¿æ¢æ–¹æ¡ˆï¼Œæ¯”å¦‚&lt;a href="https://github.com/alibaba/nacos">Alibaba Nacos&lt;/a>ã€‚&lt;/p>
&lt;p>ä½œä¸ºéƒ¨ç½²åœ¨&lt;a href="https://kubernetes.io/">Kubernetes&lt;/a>ä¸­çš„åº”ç”¨ï¼Œæœ€ä½³å®è·µæ˜¯å¹³è¡¡&lt;a href="https://kubernetes.io/docs/user-guide/configmap/">Configmap&lt;/a>å’Œ&lt;a href="https://spring.io/projects/spring-cloud-config">Spring Cloud Config&lt;/a>ã€‚å°†æ¶‰åŠç¨‹åºåŠŸèƒ½çš„é…ç½®æ”¾ç½®åœ¨&lt;a href="https://kubernetes.io/docs/user-guide/configmap/">Configmap&lt;/a>å’ŒSecretï¼ŒéšåŒå¾®æœåŠ¡çš„å‘å¸ƒä¸€èµ·åšç‰ˆæœ¬ç®¡ç†ï¼Œå¯ä»¥åšåˆ°&lt;strong>éšç€åº”ç”¨å›é€€çš„æ—¶å€™åŒæ—¶å›é€€åˆ°å†å²å¯¹åº”çš„é…ç½®ç‰ˆæœ¬&lt;/strong>ï¼Œè€Œä¸ä¼šå› ä¸ºå†å²ç‰ˆæœ¬çš„ä»£ç è¢«æœ€æ–°ç‰ˆæœ¬çš„é…ç½®æ‰€ä¸­æ–­ã€‚&lt;a href="https://github.com/spring-cloud/spring-cloud-kubernetes">Spring Cloud Kuberentes&lt;/a>é¡¹ç›®å¾ˆå¥½çš„æ”¯æŒäº†Spring Cloudåº”ç”¨ä»&lt;a href="https://github.com/spring-cloud/spring-cloud-kubernetes#kubernetes-propertysource-implementations">Configmap&lt;/a>å’Œ&lt;a href="https://github.com/spring-cloud/spring-cloud-kubernetes#secrets-propertysource">Secret&lt;/a>ä¸­è¯»å–é…ç½®é¡¹ã€‚è€Œæ¶‰åŠä¸šåŠ¡çš„é…ç½®é€‰é¡¹ï¼Œå°†å¯ä»¥è€ƒè™‘æ”¾åˆ°Spring Cloud Configåç«¯å®ç°ç»Ÿä¸€ç®¡ç†ã€‚å¦‚æœåº”ç”¨æ˜¯éƒ¨ç½²åœ¨é˜¿é‡Œäº‘ï¼Œä½¿ç”¨é˜¿é‡Œäº‘æ‰˜ç®¡çš„é…ç½®æœåŠ¡å’Œ&lt;a href="https://github.com/alibaba/nacos">Spring Cloud Config &amp;ndash; Nacos&lt;/a>å°†æ˜¯å¾ˆå¥½çš„é€‰æ‹©ã€‚&lt;/p>
&lt;h3 id="æœåŠ¡å‘ç°">æœåŠ¡å‘ç°&lt;/h3>
&lt;p>&lt;a href="https://kubernetes.io/docs/concepts/services-networking/service/#discovering-services">Kubernetes Services&lt;/a>æä¾›äº†é›†ç¾¤å†…åŸç”Ÿçš„æœåŠ¡å‘ç°èƒ½åŠ›ï¼Œæ˜¯&lt;a href="https://spring.io/projects/spring-cloud-netflix">Eureka&lt;/a>æˆ–&lt;a href="https://spring.io/projects/spring-cloud-zookeeper">Spring Cloud Zookeeper&lt;/a>ç­‰æœåŠ¡å‘ç°æœåŠ¡çš„å¾ˆå¥½æ›¿ä»£å“ã€‚åŸºäºK8S Servicesçš„æœåŠ¡å‘ç°ï¼Œå¾ˆå®¹æ˜“é€šè¿‡Service Meshèƒ½åŠ›å®ç°é™æµã€A/Bæµ‹è¯•ã€é‡‘ä¸é›€å‘å¸ƒã€æ–­è·¯å™¨ã€chaosæ³¨å…¥ç­‰æœåŠ¡æ²»ç†èƒ½åŠ›ã€‚åŒæ—¶å¯¹å¾®æœåŠ¡åº”ç”¨æ¥è¯´ï¼Œä¸ç”¨åœ¨åº”ç”¨ç«¯æ·»åŠ å¯¹åº”ä¸‰æ–¹åº“æ¥å®ç°æœåŠ¡æ³¨å†ŒåŠå‘ç°ï¼Œå‡å°‘äº†åº”ç”¨ç«¯å¼€å‘éœ€æ±‚ã€‚&lt;/p>
&lt;h3 id="å„ç§æµé‡æ²»ç†åœºæ™¯">å„ç§æµé‡æ²»ç†åœºæ™¯&lt;/h3>
&lt;p>åº”ç”¨è¢«æœåŠ¡åŒ–åï¼Œä¸€å®šä¼šé¢ä¸´æµé‡æ²»ç†çš„é—®é¢˜ã€‚å¯¹äºå„ç§æœåŠ¡é—´å¦‚ä½•å®ç°é™æµã€A/Bæµ‹è¯•ã€é‡‘ä¸é›€å‘å¸ƒã€æ–­è·¯å™¨ã€chaosæ³¨å…¥æµ‹è¯•ã€é“¾æ¥è¿½è¸ªç­‰ï¼Œè¿™å…¶å®æ˜¯ä¸€ç±»é€šç”¨çš„é—®é¢˜ã€‚&lt;/p>
&lt;p>&lt;a href="https://spring.io/projects/spring-cloud">Spring Cloud&lt;/a>æä¾›çš„æ˜¯ä¸€ç§å®¢æˆ·ç«¯è§£å†³æ€è·¯ï¼Œéœ€è¦æ¯ä¸ªåº”ç”¨å¼•å…¥å¯¹åº”åŠŸèƒ½çš„librariesçš„æ”¯æŒã€‚å³ä½¿é€šè¿‡&lt;a href="https://www.baeldung.com/spring-boot-starters">spring boot starter&lt;/a>æä¾›äº†è¿‘ä¼¼å¼€ç®±å³ç”¨çš„èƒ½åŠ›ï¼Œä½†æ˜¯æ¯ä¸ªåº”ç”¨ä»ç„¶éœ€è¦è‡ªè¡Œæ·»åŠ å¯¹åº”çš„èƒ½åŠ›ï¼Œç‰ˆæœ¬æ›´æ–°ã€å®‰å…¨æ¼æ´fixç­‰åœºæ™¯éƒ½éœ€è¦æ‰‹åŠ¨å‡çº§ã€æµ‹è¯•ã€æ‰“åŒ…ã€éƒ¨ç½²ã€‚åœ¨å¼‚æ„ç¼–ç¨‹è¯­è¨€å®ç°çš„å¾®æœåŠ¡æ¶æ„ä¸‹ï¼Œæœªå¿…æ¯ç§ç¼–ç¨‹æ¡†æ¶éƒ½èƒ½æä¾›å¾ˆå¥½çš„å¯¹åº”èƒ½åŠ›æ”¯æŒã€‚é™¤éæœ‰ç‰¹åˆ«çš„æœåŠ¡æ²»ç†ç­–ç•¥ï¼Œä¸æ¨èåœ¨å¾®æœåŠ¡è‡ªèº«æ¥å®ç°æœåŠ¡æµé‡çš„æ§åˆ¶ã€‚&lt;/p>
&lt;p>Service Mesh(ä¾‹å¦‚&lt;a href="https://istio.io/">Istio&lt;/a>æˆ–&lt;a href="https://linkerd.io/">Linkerd&lt;/a>)ä»æ•´ä¸ªæœåŠ¡æ²»ç†å±‚é¢å¯¹ä¸Šè¿°éœ€æ±‚æä¾›äº†ç»Ÿä¸€çš„è§£å†³æ–¹æ¡ˆï¼Œè€Œä¸éœ€è¦å¾®æœåŠ¡åšè‡ªèº«çš„å‡çº§æˆ–æ”¹åŠ¨ã€‚åœ¨åŸºäºKuberenteséƒ¨ç½²è¿è¡Œçš„å¾®æœåŠ¡åº”ç”¨ï¼ŒService Meshæä¾›äº†ç»Ÿä¸€çš„æœåŠ¡æ²»ç†æ–¹æ¡ˆï¼Œå°†ç”¨æˆ·ä»ä¸åŒçš„å¾®æœåŠ¡ä¸­è‡ªèº«ç»´æŠ¤æœåŠ¡æ²»ç†åŠŸèƒ½ä¸­è§£æ”¾å‡ºæ¥ï¼Œä»å¹³å°å±‚é¢æä¾›æ›´åŠ ç»Ÿä¸€ä¸€è‡´çš„è§£å†³æ–¹æ¡ˆã€‚&lt;/p>
&lt;p>åœ¨å»å¹´çš„SpringOne Platform 2018ä¸Šä¹Ÿæœ‰ä¸€ä¸ªTopic &lt;a href="https://youtu.be/AMJQO9zs2eo">A Tale of Two Frameworks: Spring Cloud and Istio&lt;/a> æ¢è®¨ä»€ä¹ˆåœºæ™¯åº”è¯¥ä½¿ç”¨Service Meshï¼Œä»€ä¹ˆæ—¶å€™ä½¿ç”¨Spring CloudæœåŠ¡æ²»ç†ç»„ä»¶ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥çœ‹ä¸€çœ‹ã€‚&lt;/p>
&lt;div class="youtube container">
&lt;iframe class="youtube" type="text/html"
src="https://www.youtube.com/embed/AMJQO9zs2eo"
allowfullscreen frameborder="0">
&lt;/iframe>
&lt;/div></description></item><item><title>ä¸ºKubernetesä¸­ä»»æ„åº”ç”¨æ·»åŠ åŸºäºoauth2çš„è®¤è¯ä¿æŠ¤ (ä¸‹)</title><link>https://kane.mx/posts/effective-cloud-computing/oauth2-proxy-on-kubernetes/part2/</link><pubDate>Mon, 08 Apr 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/effective-cloud-computing/oauth2-proxy-on-kubernetes/part2/</guid><description>&lt;p>æœ¬æ–‡æ˜¯&lt;a href="https://kane.mx/posts/effective-cloud-computing/oauth2-proxy-on-kubernetes/part1/">ä¸ºKubernetesä¸­ä»»æ„åº”ç”¨æ·»åŠ åŸºäºoauth2çš„è®¤è¯ä¿æŠ¤&lt;/a>çš„ä¸‹ç¯‡ï¼Œå°†å›¾æ–‡è¯¦è§£å¦‚ä½•ä½¿ç”¨åŸºäº&lt;a href="https://open-doc.dingtalk.com/microapp/serverapi2/kymkv6">é’‰é’‰è®¤è¯&lt;/a>çš„&lt;a href="https://github.com/bitly/oauth2_proxy">oauth2 proxy&lt;/a>ä¸ºè‡ªèº«æœ¬æ²¡æœ‰è®¤è¯æˆæƒåŠŸèƒ½çš„Webç«™ç‚¹å®ç°è®¤è¯åŠæˆæƒã€‚&lt;/p>
&lt;blockquote>
&lt;p>ç¤ºä¾‹æ˜¯ä½¿ç”¨çš„&lt;a href="https://aws.amazon.com/eks/?nc1=f_ls">AWS EKS&lt;/a>æœåŠ¡ä½œä¸ºK8Sç¯å¢ƒã€‚é‰´äºK8Sçš„åº”ç”¨è¿è¡Œæ—¶å±æ€§ï¼Œè¯¥ç¤ºä¾‹ä¹Ÿå¯ä»¥éƒ¨ç½²åœ¨å…¶ä»–äº‘å‚å•†æ‰˜ç®¡çš„K8Sã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="ç¤ºä¾‹æ¨¡å—ç®€ä»‹">ç¤ºä¾‹æ¨¡å—ç®€ä»‹&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://github.com/kubernetes/ingress-nginx">Nginx Ingress Controller&lt;/a>ä¸ºK8Sé›†ç¾¤å†…Webåº”ç”¨æä¾›åå‘ä»£ç†ï¼Œä»¥åŠæ”¯æŒå¤–éƒ¨è®¤è¯ã€‚&lt;/li>
&lt;li>ç®€å•çš„Webç«™ç‚¹ï¼ŒåŸºäº&lt;a href="https://hub.docker.com/_/nginx">Nginx dockerå®¹å™¨&lt;/a>ã€‚è¯¥ç«™ç‚¹é»˜è®¤æ²¡æœ‰è®¤è¯åŠæˆæƒåŠŸèƒ½ï¼Œä½¿ç”¨å¤–éƒ¨&lt;a href="https://open-doc.dingtalk.com/microapp/serverapi2/kymkv6">é’‰é’‰&lt;/a>åº”ç”¨ä½œä¸ºè®¤è¯åŠæˆæƒã€‚&lt;/li>
&lt;li>&lt;a href="https://github.com/zxkane/oauth2_proxy">OAuth2 Proxy on Dingtalk&lt;/a>æä¾›åŸºäº&lt;a href="https://open-doc.dingtalk.com/microapp/serverapi2/kymkv6">é’‰é’‰&lt;/a>åº”ç”¨çš„æ‰«ç è®¤è¯åŠæˆæƒï¼Œåªæœ‰è®¤è¯ä¸”æˆæƒçš„ç”¨æˆ·æ‰å¯ä»¥è®¿é—®ä¸Šé¢çš„Webç«™ç‚¹ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="é»˜è®¤è®¾å®š">é»˜è®¤è®¾å®š&lt;/h3>
&lt;ul>
&lt;li>Webç«™ç‚¹åŸŸå&lt;code>web.kane.mx&lt;/code>&lt;/li>
&lt;li>è®¤è¯æœåŠ¡åŸŸå&lt;code>oauth.kane.mx&lt;/code>&lt;/li>
&lt;/ul>
&lt;h3 id="å‡†å¤‡aws-eksaws-eksç¯å¢ƒ">å‡†å¤‡&lt;a href="https://aws.amazon.com/eks/?nc1=f_ls">AWS EKS&lt;/a>ç¯å¢ƒ&lt;/h3>
&lt;ol>
&lt;li>&lt;a href="https://docs.aws.amazon.com/eks/latest/userguide/create-cluster.html">åˆ›å»ºEKSé›†ç¾¤&lt;/a>ã€‚ç”±äº&lt;a href="https://github.com/kubernetes/ingress-nginx">Nginx Ingress&lt;/a>æœåŠ¡æ˜¯LoadBalancerç±»å‹ï¼ŒEKSåˆ›å»ºNLBæˆ–ELBå¯¹åº”çš„targetsæ—¶éœ€è¦targetséƒ¨ç½²åœ¨public VPC subnetsï¼Œæ‰€ä»¥ä¸ºäº†ç®€åŒ–éƒ¨ç½²EKSé›†ç¾¤çš„VPC subnetséƒ½é€‰æ‹©public subnetã€‚æ–°å»ºçš„EKSé›†ç¾¤å…è®¸å…¬å¼€è®¿é—®ã€‚&lt;/li>
&lt;li>&lt;a href="https://docs.aws.amazon.com/eks/latest/userguide/managing-auth.html">æœ¬åœ°å®‰è£…é…ç½®kubectl, aws-iam-authenticator&lt;/a>ç”¨äºè¿œç¨‹ç®¡ç†é›†ç¾¤ã€‚&lt;/li>
&lt;li>&lt;a href="https://docs.aws.amazon.com/eks/latest/userguide/launch-workers.html">ä¸ºé›†ç¾¤æ·»åŠ workerèŠ‚ç‚¹&lt;/a>ã€‚&lt;/li>
&lt;li>&lt;a href="https://docs.aws.amazon.com/eks/latest/userguide/helm.html">é…ç½®Helméƒ¨ç½²ç¯å¢ƒ&lt;/a>ã€‚&lt;/li>
&lt;/ol>
&lt;h3 id="é’‰é’‰åº”ç”¨å‡†å¤‡">é’‰é’‰åº”ç”¨å‡†å¤‡&lt;/h3>
&lt;ol>
&lt;li>ä¸ºä¼ä¸šæˆ–ç»„ç»‡å¼€é€š&lt;a href="https://open-dev.dingtalk.com/#/index">é’‰é’‰å¼€å‘å¹³å°&lt;/a>&lt;/li>
&lt;li>åˆ›å»ºä¸€ä¸ªæ–°çš„&lt;a href="https://open-dev.dingtalk.com/#/loginAndShareApp">ç§»åŠ¨åº”ç”¨&lt;/a>ã€‚å›è°ƒåŸŸåå¡«å†™&lt;code>&amp;lt;http or https&amp;gt;/&amp;lt;è®¤è¯æœåŠ¡åŸŸå&amp;gt;/oauth2/callback&lt;/code>ã€‚è®°å½•ä¸‹æ¥åº”ç”¨çš„&lt;code>appId&lt;/code>å’Œ&lt;code>appSecret&lt;/code>ã€‚&lt;/li>
&lt;li>åˆ›å»ºä¸€ä¸ª&lt;a href="https://open-dev.dingtalk.com/#/create-bench/self">ä¼ä¸šå†…éƒ¨å·¥ä½œå°åº”ç”¨&lt;/a>ã€‚åœ°å€å¯ä»¥éšæ„è®¾ç½®ã€‚æœåŠ¡å™¨å‡ºå£IPè®¾ç½®ä¸º&lt;code>EKSé›†ç¾¤ä¸­å·¥ä½œèŠ‚ç‚¹çš„å…¬ç½‘IP&lt;/code>æˆ–è€…&lt;code>NAT EIP&lt;/code>ï¼Œå–å†³äºå·¥ä½œèŠ‚ç‚¹å¦‚ä½•è®¿é—®Internetã€‚å¹¶è®°å½•ä¸‹æ¥åº”ç”¨&lt;code>appKey&lt;/code>å’Œ&lt;code>appSecret&lt;/code>ã€‚&lt;/li>
&lt;/ol>
&lt;h3 id="éƒ¨ç½²ç¤ºä¾‹åº”ç”¨">éƒ¨ç½²ç¤ºä¾‹åº”ç”¨&lt;/h3>
&lt;ol>
&lt;li>å…‹éš†&lt;a href="https://github.com/zxkane/hands-on-dingtalk-oauth2-proxy">ç¤ºä¾‹&lt;/a>éƒ¨ç½²è„šæœ¬ã€‚&lt;/li>
&lt;li>æ›¿æ¢&lt;code>values.yaml&lt;/code>ä¸­çš„&lt;code>dingtalk_corpid&lt;/code>ä¸ºå·¥ä½œå°åº”ç”¨çš„&lt;code>appKey&lt;/code>ï¼Œ &lt;code>dingtalk_corpsecret&lt;/code>ä¸ºå·¥ä½œå°åº”ç”¨çš„&lt;code>appSecret&lt;/code>ã€‚
ç”±äºç¤¾åŒºç»´æŠ¤çš„&lt;a href="https://github.com/helm/charts/tree/master/stable/oauth2-proxy">oauth2-proxy charts&lt;/a>å¹¶ä¸æ”¯æŒdingtalkæ‰©å±•çš„SECRET ENVï¼Œæ‰€ä»¥å°†å¯†é’¥é…ç½®åˆ°äº†&lt;code>configmap&lt;/code>ä¸­ã€‚ç”¨äºç”Ÿäº§ç¯å¢ƒçš„è¯ï¼Œå»ºè®®æŒ‰&lt;a href="https://github.com/pilipa-cn/charts/commit/7ac0f67acc71577275f743bdcf9a870bd65361b0">è¿™ä¸ªcommit&lt;/a>ä½¿ç”¨&lt;code>secret&lt;/code>ä¿å­˜åº”ç”¨secretã€‚
&lt;div class="highlight">&lt;div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="color:#f92672">oauth2-proxy&lt;/span>:
&lt;span style="color:#f92672">config&lt;/span>:
&lt;span style="color:#f92672">clientID&lt;/span>: &lt;span style="color:#ae81ff">aaa&lt;/span>
&lt;span style="color:#f92672">clientSecret&lt;/span>: &lt;span style="color:#ae81ff">bbb&lt;/span>
&lt;span style="color:#f92672">cookieSecret&lt;/span>: &lt;span style="color:#ae81ff">ccc&lt;/span>
&lt;span style="color:#f92672">configFile&lt;/span>: |+&lt;span style="color:#e6db74">
&lt;/span>&lt;span style="color:#e6db74"> email_domains = [ &amp;#34;*&amp;#34; ]
&lt;/span>&lt;span style="color:#e6db74"> cookie_domain = &amp;#34;kane.mx&amp;#34;
&lt;/span>&lt;span style="color:#e6db74"> cookie_secure = false
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="color:#e6db74"> dingtalk_corpid = &amp;#34;&amp;lt;appkey of dingtalk app&amp;gt;&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="color:#e6db74"> dingtalk_corpsecret = &amp;#34;&amp;lt;appsecret of dingtalk app&amp;gt;&amp;#34;&lt;/span> &lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
å¦‚æœä»…å¸Œæœ›ä¼ä¸šéƒ¨åˆ†éƒ¨é—¨çš„å‘˜å·¥å¯ä»¥è·å¾—æˆæƒï¼Œåœ¨ä¸Šé¢&lt;code>configFile&lt;/code>é…ç½®ä¸‹æ·»åŠ å¦‚ä¸‹é…ç½®ï¼Œ
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="color:#ae81ff">dingtalk_departments = [&amp;#34;xxå…¬å¸/äº§å“æŠ€æœ¯ä¸­å¿ƒ&amp;#34;,&amp;#34;xxå…¬å¸/éƒ¨é—¨2/å­éƒ¨é—¨3&amp;#34;]&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>æ›¿æ¢éƒ¨ç½²åº”ç”¨çš„åŸŸåä¸ºä½ çš„åŸŸåã€‚&lt;/li>
&lt;li>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…Helméƒ¨ç½²ä¾èµ–ã€‚
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">helm dep up&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤éƒ¨ç½²nginx ingress controller, webåº”ç”¨ä»¥åŠoauth2 proxy
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">helm upgrade --install -f values.yaml --set oauth2-proxy.config.clientID&lt;span style="color:#f92672">=&lt;/span>&amp;lt;ç§»åŠ¨åº”ç”¨appid&amp;gt;,oauth2-proxy.config.clientSecret&lt;span style="color:#f92672">=&lt;/span>&amp;lt;ç§»åŠ¨åº”ç”¨appsecret&amp;gt; site-with-auth --wait ./&lt;/code>&lt;/pre>&lt;/div>
å¦‚æœé›†ç¾¤ä¸­å·²ç»éƒ¨ç½²äº†&lt;code>Nginx Ingress Controller&lt;/code>ï¼Œä¿®æ”¹&lt;code>values.yaml&lt;/code>å¦‚ä¸‹å°†å¿½ç•¥éƒ¨ç½²Nginx ingressï¼Œ
&lt;div class="highlight">&lt;div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
&lt;/span>&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="color:#f92672">affinity&lt;/span>: {}
&lt;span style="color:#f92672">nginx-ingress&lt;/span>:
&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">enabled&lt;/span>: &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span> &lt;span style="color:#f92672">controller&lt;/span>:
&lt;span style="color:#f92672">ingressClass&lt;/span>: &lt;span style="color:#ae81ff">nginx&lt;/span>
&lt;span style="color:#ae81ff">config:&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>éƒ¨ç½²æˆåŠŸåï¼Œè·å–&lt;code>ELB&lt;/code>åœ°å€ã€‚
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-zsh" data-lang="zsh">kubectl get svc -o jsonpath&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;{ $.status.loadBalancer.ingress[*].hostname }&amp;#39;&lt;/span> &amp;lt;deployment name&amp;gt;-nginx-ingress-controller;echo
a3afe672259c511e98e2a0a0d88fda3e-xx.elb.ap-southeast-1.amazonaws.com&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol>
&lt;h3 id="éƒ¨ç½²æˆåŠŸåé…ç½®">éƒ¨ç½²æˆåŠŸåé…ç½®&lt;/h3>
&lt;p>å°†ç«™ç‚¹å’ŒoauthæœåŠ¡åŸŸåè§£æåˆ°ä¸Šé¢éƒ¨ç½²åˆ›å»ºçš„ELBä¸Šã€‚&lt;/p>
&lt;h3 id="æµ‹è¯•">æµ‹è¯•&lt;/h3>
&lt;p>è®¿é—®Webç«™ç‚¹(å¦‚æœ¬ç¤ºä¾‹ä¸­çš„&lt;code>http://web.kane.mx&lt;/code>)ï¼Œæœªæˆæƒçš„æƒ…å†µä¸‹ï¼Œè°ƒè½¬åˆ°é’‰é’‰åº”ç”¨æ‰«ç ç™»å½•ç•Œé¢ã€‚ä½¿ç”¨ç»„ç»‡å†…æˆå‘˜çš„é’‰é’‰æ‰«ç æˆæƒåï¼Œå°†è·³è½¬å›Webç«™ç‚¹åº”ç”¨ï¼Œå¯ä»¥æ­£å¸¸æµè§ˆè¯¥åŸŸåä¸‹çš„é¡µé¢ã€‚&lt;/p></description></item><item><title>åŸºäºå‡½æ•°è®¡ç®—çš„é’‰é’‰å›è°ƒå‡½æ•°æ¥å£</title><link>https://kane.mx/posts/effective-cloud-computing/serverless-dingtalk-callback/</link><pubDate>Tue, 02 Apr 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/effective-cloud-computing/serverless-dingtalk-callback/</guid><description>&lt;p>ç”±äºä¼ä¸šå†…éƒ¨ç®¡ç†çš„éœ€è¦ï¼Œç”¨åˆ°äº†&lt;a href="https://open-doc.dingtalk.com/microapp/serverapi2/lo5n6i">é’‰é’‰çš„ä¸šåŠ¡äº‹ä»¶å›è°ƒ&lt;/a>èƒ½åŠ›ï¼Œæ­£å¥½å°†è¿™ä¸ªè½»é‡çº§çš„æ¥å£ä½¿ç”¨&lt;a href="https://kane.mx/posts/effective-cloud-computing/serverless-computing-101/">æ— æœåŠ¡å™¨æŠ€æœ¯&lt;/a>æ¥å®ç°éƒ¨ç½²ï¼Œä»¥åº”å¯¹æµé‡æ— è§„å¾‹ä¸‹çš„åŠ¨æ€æ‰©å±•ä¼¸ç¼©ã€æŒ‰éœ€ä½¿ç”¨ã€æŒ‰é‡è®¡è´¹ç­‰éœ€æ±‚ã€‚&lt;/p>
&lt;h3 id="é˜¿é‡Œäº‘å‡½æ•°è®¡ç®—ç‰ˆæœ¬">é˜¿é‡Œäº‘å‡½æ•°è®¡ç®—ç‰ˆæœ¬&lt;/h3>
&lt;p>ç”±äºå…¬å¸ç³»ç»Ÿéƒ¨ç½²åœ¨é˜¿é‡Œäº‘ï¼Œé¦–å…ˆé€‰æ‹©ä½¿ç”¨&lt;a href="https://www.aliyun.com/product/fc">é˜¿é‡Œäº‘å‡½æ•°è®¡ç®—&lt;/a>æ¥å®ç°åŠéƒ¨ç½²ã€‚è¯¥æ¥å£ä½¿ç”¨äº†JVMä¸Šè¯­è¨€Kotlinå¼€å‘ï¼Œè™½ç„¶é˜¿é‡Œäº‘å‡½æ•°è®¡ç®—å®˜æ–¹æ”¯æŒçš„&lt;a href="https://help.aliyun.com/document_detail/74712.html">å¼€å‘è¯­è¨€æœ‰Javaä½†æ²¡æœ‰Kotlin&lt;/a>ã€‚å…¶å®æ— è®ºJavaæˆ–Kotlinæœ€ç»ˆéƒ¨ç½²æ–‡ä»¶éƒ½æ˜¯Java Classå­—èŠ‚ç ï¼ŒåŠ ä¸ŠKotlinä¸Javaè‰¯å¥½çš„äº’æ“ä½œæ€§ï¼Œå®æµ‹å‡½æ•°è®¡ç®—å¯ä»¥å®Œç¾æ”¯æŒKotlinå¼€å‘(ä¸ªäººè®¤ä¸ºä»»æ„JVMä¸Šçš„å¼€å‘è¯­è¨€éƒ½æ˜¯æ”¯æŒçš„)ã€‚&lt;/p>
&lt;p>åŒæ—¶è¯¥å‡½æ•°ä½¿ç”¨äº†&lt;a href="https://www.aliyun.com/product/ots">è¡¨æ ¼å­˜å‚¨&lt;/a>æ¥æŒä¹…åŒ–å›è°ƒäº‹ä»¶ã€‚è¡¨æ ¼å­˜å‚¨æ˜¯ä¸ªæŒ‰é‡è®¡è´¹çš„åˆ†å¸ƒå¼å­˜å‚¨ï¼Œæœ‰å…´è¶£çš„å¯ä»¥è‡ªè¡ŒæŸ¥é˜…æ–‡æ¡£äº†è§£æ›´å¤šã€‚&lt;/p>
&lt;p>è¯¥å‡½æ•°é€šè¿‡&lt;a href="https://www.aliyun.com/product/apigateway">APIç½‘å…³&lt;/a>å’Œ&lt;a href="https://help.aliyun.com/document_detail/100092.html">è¡¨æ ¼å­˜å‚¨è§¦å‘å™¨&lt;/a>æ¥è§¦å‘ã€‚è®¿é—®æ—¥å¿—å’Œæ‰§è¡Œæ—¥å¿—è¢«å­˜å‚¨åœ¨&lt;a href="https://www.aliyun.com/product/sls">æ—¥å¿—æœåŠ¡&lt;/a>ä¸­ã€‚&lt;/p>
&lt;p>å‡½æ•°çš„æœ¬åœ°æµ‹è¯•å’Œçº¿ä¸Šéƒ¨ç½²ï¼Œä½¿ç”¨äº†å‡½æ•°è®¡ç®—æä¾›çš„å‘½ä»¤è¡Œå·¥å…·&lt;a href="https://help.aliyun.com/document_detail/64204.html">Fun&lt;/a>ã€‚åŸºäº&lt;a href="https://github.com/aliyun/fun/blob/master/docs/specs/2018-04-03-zh-cn.md?spm=a2c4g.11186623.2.24.717428femnY0Et&amp;amp;file=2018-04-03-zh-cn.md">Funå®šä¹‰çš„é˜¿é‡Œäº‘Serverlessæ¨¡å‹&lt;/a>å®ç°äº†å¯¹å‡½æ•°ä»¬ä½¿ç”¨èµ„æºçš„å£°æ˜å’Œç¼–æ’ï¼Œé›†æˆ&lt;a href="https://about.gitlab.com/product/continuous-integration/">Gitlab CI&lt;/a>å®ç°äº†&lt;a href="https://github.com/zxkane/dingtalk-callback-on-aliyunfc/blob/master/.gitlab-ci.yml">å‡½æ•°çš„CI/CDè‡ªåŠ¨åŒ–å‘å¸ƒæµç¨‹&lt;/a>ã€‚&lt;/p>
&lt;p>ä¸æ¶‰åŠå…¬å¸ä¸šåŠ¡çš„ä»£ç å·²&lt;a href="https://github.com/zxkane/dingtalk-callback-on-aliyunfc">å¼€æºåœ¨Github&lt;/a>ï¼Œæœ‰å…´è¶£çš„å¯ä»¥ä½œä¸ºå‚è€ƒã€‚&lt;/p>
&lt;p>ç›®å‰&lt;a href="https://help.aliyun.com/document_detail/54301.html">å‡½æ•°è®¡ç®—&lt;/a>å’Œ&lt;a href="https://help.aliyun.com/document_detail/52733.html">è¡¨æ ¼å­˜å‚¨&lt;/a>æœ‰å„è‡ªçš„å…è´¹é…é¢ï¼Œåœ¨ä¸šåŠ¡é‡ä¸å¤§çš„æƒ…å†µä¸‹ï¼Œè¯¥æœåŠ¡å®Œå…¨å…è´¹ã€‚&lt;/p>
&lt;h3 id="aws-lambdaç‰ˆæœ¬">AWS Lambdaç‰ˆæœ¬&lt;/h3>
&lt;p>&lt;a href="https://aws.amazon.com/lambda/">AWS Lambda&lt;/a>æ˜¯ç›®å‰å…¨çƒä½¿ç”¨æœ€ä¸ºå¹¿æ³›çš„serverlessæœåŠ¡ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å‡½æ•°è®¡ç®—å‘å±•æ–¹å‘çš„å¼•é¢†è€…ã€‚&lt;/p>
&lt;p>ç”±äºä¸€äº›ä¸ªäººåŸå› ï¼Œç¬”è€…æœ€è¿‘æ¥è§¦äº†éƒ¨åˆ†AWSæœåŠ¡ï¼ŒåŒæ—¶å°è¯•å°†é’‰é’‰å›è°ƒå‡½æ•°ç§»æ¤åˆ°äº†&lt;a href="https://aws.amazon.com/lambda/">AWS Lambda&lt;/a>ä¸Šã€‚é˜¿é‡Œäº‘ä¸Šä½¿ç”¨çš„äº‘æœåŠ¡æ”¹ä¸ºç”±AWSä¸Šå¯¹åº”æœåŠ¡æ¥å®ç°ï¼Œä¾‹å¦‚å­˜å‚¨ä½¿ç”¨äº†&lt;a href="https://aws.amazon.com/dynamodb/">DynamoDB&lt;/a>ï¼Œæ—¥å¿—ä½¿ç”¨&lt;a href="https://aws.amazon.com/cloudwatch/">CloudWatch&lt;/a>æ”¶é›†å’ŒæŸ¥è¯¢ã€‚&lt;/p>
&lt;p>æœ¬åœ°æµ‹è¯•å’Œéƒ¨ç½²å·¥å…·ï¼Œä½¿ç”¨çš„æ˜¯&lt;a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/what-is-sam.html">SAM CLI&lt;/a>ï¼ŒæŒç»­é›†æˆå’ŒæŒç»­éƒ¨ç½²ä½¿ç”¨çš„æ˜¯&lt;a href="https://aws.amazon.com/codebuild/">AWS CodeBuild&lt;/a>å’Œ&lt;a href="https://aws.amazon.com/codepipeline/">AWS CodePipeline&lt;/a>ã€‚æ­¤å¤–AWSé€šè¿‡&lt;a href="https://aws.amazon.com/cloudformation/">AWS CloudFormation&lt;/a>æä¾›ä¸€ç§éå¸¸å¼ºå¤§çš„èƒ½åŠ›ï¼Œå¯ä»¥å°†AWSä¸Šçš„å„ç§èµ„æºé€šè¿‡é…ç½®å£°æ˜çš„æ–¹å¼æ¥ç®¡ç†(ä¹Ÿå°±æ˜¯ç°åœ¨éå¸¸çƒ­é—¨çš„ä¸€ä¸ªæ¦‚å¿µ&amp;ndash;&lt;a href="https://en.wikipedia.org/wiki/Infrastructure_as_code">Infrastructure as Code&lt;/a>)ã€‚&lt;a href="https://aws.amazon.com/cloudformation/">AWS CloudFormation&lt;/a>ä¼šä¸ºæ¯æ¬¡ä¸€ä¸ªæˆ–å¤šä¸ªèµ„æºçš„å˜æ›´ç”ŸæˆChangeSetï¼Œæä¾›æŸ¥çœ‹å¯¹æ¯”ã€ç‰ˆæœ¬ç®¡ç†ã€é‡åˆ°å˜æ›´é”™è¯¯æ•´ä½“å›é€€ç­‰èƒ½åŠ›ã€‚æ‰€ä»¥ï¼ŒAWSç‰ˆæœ¬ä¹Ÿå°†è¯¥é¡¹ç›®çš„CI/CDéƒ¨ç½²ç”¨åˆ°çš„&lt;a href="https://aws.amazon.com/codebuild/">AWS CodeBuild&lt;/a>ã€&lt;a href="https://aws.amazon.com/codepipeline/">AWS CodePipeline&lt;/a>ã€&lt;a href="https://aws.amazon.com/dynamodb/">Amazon DynamoDB&lt;/a>ç­‰èµ„æºé€šè¿‡CloudFormationçš„é…ç½®ç®¡ç†èµ·æ¥ã€‚&lt;/p>
&lt;p>é…ç½®ä»£ç æ®µå¦‚ä¸‹ï¼Œ
&lt;div class="highlight">&lt;div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">81
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">82
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">83
&lt;/span>&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">84
&lt;/span>&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">85
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">86
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">87
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">88
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">89
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">90
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">91
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">92
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">93
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">94
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">95
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">96
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">97
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">98
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">99
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="color:#f92672">Description&lt;/span>: &lt;span style="color:#ae81ff">Create a CodePipeline to include Github source, CodeBuild and Lambda deployment.&lt;/span>
&lt;span style="color:#f92672">Parameters&lt;/span>:
&lt;span style="color:#f92672">AppBaseName&lt;/span>:
&lt;span style="color:#f92672">Type&lt;/span>: &lt;span style="color:#ae81ff">String&lt;/span>
&lt;span style="color:#f92672">Description&lt;/span>: &lt;span style="color:#ae81ff">App base name&lt;/span>
&lt;span style="color:#f92672">Default&lt;/span>: &lt;span style="color:#ae81ff">dingtalk-callback&lt;/span>
&lt;span style="color:#f92672">ArtifactStoreS3Location&lt;/span>:
&lt;span style="color:#f92672">Type&lt;/span>: &lt;span style="color:#ae81ff">String&lt;/span>
&lt;span style="color:#f92672">Description&lt;/span>: &lt;span style="color:#ae81ff">Name of the S3 bucket to store CodePipeline artificat.&lt;/span>
&lt;span style="color:#f92672">BranchName&lt;/span>:
&lt;span style="color:#f92672">Description&lt;/span>: &lt;span style="color:#ae81ff">GitHub branch name&lt;/span>
&lt;span style="color:#f92672">Type&lt;/span>: &lt;span style="color:#ae81ff">String&lt;/span>
&lt;span style="color:#f92672">Default&lt;/span>: &lt;span style="color:#ae81ff">master&lt;/span>
&lt;span style="color:#f92672">RepositoryName&lt;/span>:
&lt;span style="color:#f92672">Description&lt;/span>: &lt;span style="color:#ae81ff">GitHub repository name&lt;/span>
&lt;span style="color:#f92672">Type&lt;/span>: &lt;span style="color:#ae81ff">String&lt;/span>
&lt;span style="color:#f92672">Default&lt;/span>: &lt;span style="color:#ae81ff">dingtalk-callback-on-aws&lt;/span>
&lt;span style="color:#f92672">GitHubOAuthToken&lt;/span>:
&lt;span style="color:#f92672">Type&lt;/span>: &lt;span style="color:#ae81ff">String&lt;/span>
&lt;span style="color:#f92672">NoEcho&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>
&lt;span style="color:#f92672">Resources&lt;/span>:
&lt;span style="color:#f92672">BuildDingtalkProject&lt;/span>:
&lt;span style="color:#f92672">Type&lt;/span>: &lt;span style="color:#ae81ff">AWS::CodeBuild::Project&lt;/span>
&lt;span style="color:#f92672">Properties&lt;/span>:
&lt;span style="color:#f92672">Name&lt;/span>:
&lt;span style="color:#f92672">Fn::Sub&lt;/span>: &lt;span style="color:#ae81ff">${AppBaseName}-build-${AWS::StackName}&lt;/span>
&lt;span style="color:#f92672">Description&lt;/span>: &lt;span style="color:#ae81ff">Build, test, package dingtalk callback project&lt;/span>
&lt;span style="color:#f92672">ServiceRole&lt;/span>:
&lt;span style="color:#f92672">Fn::GetAtt&lt;/span>: [ &lt;span style="color:#ae81ff">CodeBuildRole, Arn ]&lt;/span>
&lt;span style="color:#f92672">Artifacts&lt;/span>:
&lt;span style="color:#f92672">Type&lt;/span>: &lt;span style="color:#ae81ff">S3&lt;/span>
&lt;span style="color:#f92672">Location&lt;/span>:
&lt;span style="color:#f92672">Ref&lt;/span>: &lt;span style="color:#ae81ff">ArtifactStoreS3Location&lt;/span>
&lt;span style="color:#f92672">Name&lt;/span>:
&lt;span style="color:#f92672">Fn::Sub&lt;/span>: &lt;span style="color:#ae81ff">${AppBaseName}-build-${AWS::StackName}&lt;/span>
&lt;span style="color:#f92672">NamespaceType&lt;/span>: &lt;span style="color:#ae81ff">BUILD_ID&lt;/span>
&lt;span style="color:#f92672">Path&lt;/span>:
&lt;span style="color:#f92672">Fn::Sub&lt;/span>: &lt;span style="color:#ae81ff">${AppBaseName}/artifacts&lt;/span>
&lt;span style="color:#f92672">Packaging&lt;/span>: &lt;span style="color:#ae81ff">NONE&lt;/span>
&lt;span style="color:#f92672">OverrideArtifactName&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>
&lt;span style="color:#f92672">EncryptionDisabled&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>
&lt;span style="color:#f92672">Environment&lt;/span>:
&lt;span style="color:#f92672">Type&lt;/span>: &lt;span style="color:#ae81ff">LINUX_CONTAINER&lt;/span>
&lt;span style="color:#f92672">ComputeType&lt;/span>: &lt;span style="color:#ae81ff">BUILD_GENERAL1_SMALL&lt;/span>
&lt;span style="color:#f92672">Image&lt;/span>: &lt;span style="color:#ae81ff">aws/codebuild/java:openjdk-11&lt;/span>
&lt;span style="color:#f92672">PrivilegedMode&lt;/span>: &lt;span style="color:#66d9ef">false&lt;/span>
&lt;span style="color:#f92672">ImagePullCredentialsType&lt;/span>: &lt;span style="color:#ae81ff">CODEBUILD&lt;/span>
&lt;span style="color:#f92672">EnvironmentVariables&lt;/span>:
- &lt;span style="color:#f92672">Name&lt;/span>: &lt;span style="color:#ae81ff">s3_bucket&lt;/span>
&lt;span style="color:#f92672">Value&lt;/span>:
&lt;span style="color:#f92672">Ref&lt;/span>: &lt;span style="color:#ae81ff">ArtifactStoreS3Location&lt;/span>
&lt;span style="color:#f92672">Source&lt;/span>:
&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">DingtalkCallbackPipeline&lt;/span>:
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">Type&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;AWS::CodePipeline::Pipeline&amp;#39;&lt;/span>
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">Properties&lt;/span>:
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">Name&lt;/span>:
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">Fn::Sub&lt;/span>: &lt;span style="color:#ae81ff">${AppBaseName}-pipeline-${AWS::StackName}&lt;/span>
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">RoleArn&lt;/span>:
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">Fn::GetAtt&lt;/span>: [ &lt;span style="color:#ae81ff">CodePipelineRole, Arn ]&lt;/span>
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">Stages&lt;/span>:
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> - &lt;span style="color:#f92672">Name&lt;/span>: &lt;span style="color:#ae81ff">Source&lt;/span>
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">Actions&lt;/span>:
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> - &lt;span style="color:#f92672">Name&lt;/span>: &lt;span style="color:#ae81ff">SourceAction&lt;/span>
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">ActionTypeId&lt;/span>:
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">Category&lt;/span>: &lt;span style="color:#ae81ff">Source&lt;/span>
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">Owner&lt;/span>: &lt;span style="color:#ae81ff">ThirdParty&lt;/span>
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">Version&lt;/span>: &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">Provider&lt;/span>: &lt;span style="color:#ae81ff">GitHub&lt;/span>
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">OutputArtifacts&lt;/span>:
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> - &lt;span style="color:#f92672">Name&lt;/span>:
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">Fn::Sub&lt;/span>: &lt;span style="color:#ae81ff">${AppBaseName}-source-changed&lt;/span>
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">Configuration&lt;/span>:
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">Owner&lt;/span>: !&lt;span style="color:#ae81ff">Ref GitHubOwner&lt;/span>
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">Repo&lt;/span>: !&lt;span style="color:#ae81ff">Ref RepositoryName&lt;/span>
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">Branch&lt;/span>: !&lt;span style="color:#ae81ff">Ref BranchName&lt;/span>
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">OAuthToken&lt;/span>: !&lt;span style="color:#ae81ff">Ref GitHubOAuthToken&lt;/span>
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">PollForSourceChanges&lt;/span>: &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">RunOrder&lt;/span>: &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> - &lt;span style="color:#f92672">Name&lt;/span>: &lt;span style="color:#ae81ff">Build&lt;/span>
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> &lt;span style="color:#f92672">Actions&lt;/span>:
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3c3d38"> - &lt;span style="color:#f92672">Name&lt;/span>: &lt;span style="color:#ae81ff">Build_Test_Package&lt;/span>
&lt;/span> &lt;span style="color:#f92672">InputArtifacts&lt;/span>:
- &lt;span style="color:#f92672">Name&lt;/span>:
&lt;span style="color:#f92672">Fn::Sub&lt;/span>: &lt;span style="color:#ae81ff">${AppBaseName}-source-changed&lt;/span>
&lt;span style="color:#f92672">ActionTypeId&lt;/span>:
&lt;span style="color:#f92672">Category&lt;/span>: &lt;span style="color:#ae81ff">Build&lt;/span>
&lt;span style="color:#f92672">Owner&lt;/span>: &lt;span style="color:#ae81ff">AWS&lt;/span>
&lt;span style="color:#f92672">Version&lt;/span>: &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#f92672">Provider&lt;/span>: &lt;span style="color:#ae81ff">CodeBuild&lt;/span>
&lt;span style="color:#f92672">OutputArtifacts&lt;/span>:
- &lt;span style="color:#f92672">Name&lt;/span>:
&lt;span style="color:#f92672">Fn::Sub&lt;/span>: &lt;span style="color:#ae81ff">${AppBaseName}-packaged-yml&lt;/span>
&lt;span style="color:#f92672">Configuration&lt;/span>:
&lt;span style="color:#f92672">ProjectName&lt;/span>:
&lt;span style="color:#f92672">Ref&lt;/span>: &lt;span style="color:#ae81ff">BuildDingtalkProject&lt;/span>
&lt;span style="color:#f92672">RunOrder&lt;/span>: &lt;span style="color:#ae81ff">1&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;p>AWSç‰ˆæœ¬å®Œæ•´çš„ä»£ç ã€CloudFormationé…ç½®ä»¥åŠéƒ¨ç½²æ–‡æ¡£å¯ä»¥é€šè¿‡&lt;a href="https://github.com/zxkane/dingtalk-callback-on-aws">è¿™é‡Œ&lt;/a>æŸ¥çœ‹ã€‚&lt;/p></description></item><item><title>æ— æœåŠ¡å™¨è®¡ç®—101</title><link>https://kane.mx/posts/effective-cloud-computing/serverless-computing-101/</link><pubDate>Mon, 01 Apr 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/effective-cloud-computing/serverless-computing-101/</guid><description>&lt;p>&lt;a href="https://en.wikipedia.org/wiki/Serverless_computing">Serverless Computing(æ— æœåŠ¡å™¨è®¡ç®—)&lt;/a>æ˜¯ç›®å‰æœ€è¢«çœ‹å¥½çš„äº‘ç«¯è®¡ç®—æ‰§è¡Œæ¨¡å‹ã€‚å…¶æœ€å¤§çš„å¥½å¤„æ˜¯æä¾›åˆ†å¸ƒå¼å¼¹æ€§å¯ä¼¸ç¼©çš„è®¡ç®—æ‰§è¡Œç¯å¢ƒï¼Œä»…ä¸ºå®é™…ä½¿ç”¨èµ„æºä»˜è´¹ï¼Œå¹¶ä¸”å°†åº”ç”¨ç»´æŠ¤è€…ä»å¸¸è§„çš„è¿ç»´äº‹åŠ¡ä¸­è§£æ”¾å‡ºæ¥ï¼Œæ›´åˆ©äºä¸“æ³¨åˆ°å…·ä½“çš„ä¸šåŠ¡ä¸Šã€‚&lt;/p>
&lt;p>åœ¨ä¸»æµçš„åº”ç”¨éƒ¨ç½²æ–¹å¼ä¸‹ï¼Œæ— è®ºæ˜¯ä½¿ç”¨&lt;a href="https://aws.amazon.com/cn/ec2">äº‘ä¸»æœº&lt;/a>è¿˜æ˜¯&lt;a href="https://kane.mx/posts/effective-cloud-computing/using-kubernetes-on-cloud/">Kubernetes&lt;/a>ä½œä¸ºè¿è¡Œç¯å¢ƒï¼Œéƒ½ä¼šæœ‰å¤§é‡è¿ç»´å±‚é¢çš„äº‹åŠ¡éœ€è¦è€ƒè™‘å’Œå¤„ç†ï¼Œå¹¶ä¸”åº”ç”¨ç¨‹åºéœ€è¦æŒ‰ç…§åˆ†å¸ƒå¼ç¨‹åºçš„è®¾è®¡å‡†åˆ™æ¥åº”å¯¹åº”ç”¨çš„æ°´å¹³ä¼¸ç¼©ã€‚åŒæ—¶éšç€äº‘è®¡ç®—æœåŠ¡çš„å‘å±•å’Œå®Œå–„ï¼Œäº‘è®¡ç®—å‚å•†æä¾›äº†è¶Šæ¥è¶Šå¤šçš„åŸºç¡€æœåŠ¡ï¼Œä¾‹å¦‚APIç½‘å…³ã€å¯¹è±¡å­˜å‚¨ã€æ¶ˆæ¯é˜Ÿåˆ—ã€æ—¥å¿—ã€ç›‘æ§ç­‰æœåŠ¡ï¼Œå‡½æ•°è®¡ç®—å¯ä»¥å®Œç¾çš„åŒå…¶ä»–äº‘æœåŠ¡é›†æˆï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿå®ç°å‡ºç”Ÿäº§çº§åˆ«çš„å¼¹æ€§å¯ä¼¸ç¼©çš„åº”ç”¨ã€‚&lt;/p>
&lt;p>é‚£&lt;a href="https://en.wikipedia.org/wiki/Serverless_computing">å‡½æ•°è®¡ç®—&lt;/a>æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè®©æˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹&lt;a href="https://help.aliyun.com/document_detail/52895.html">é˜¿é‡Œäº‘å¯¹äºå‡½æ•°è®¡ç®—çš„å®šä¹‰&lt;/a>ã€‚&lt;/p>
&lt;blockquote>
&lt;p>é˜¿é‡Œäº‘å‡½æ•°è®¡ç®—æ˜¯äº‹ä»¶é©±åŠ¨çš„å…¨æ‰˜ç®¡è®¡ç®—æœåŠ¡ã€‚é€šè¿‡å‡½æ•°è®¡ç®—ï¼Œæ‚¨æ— éœ€ç®¡ç†æœåŠ¡å™¨ç­‰åŸºç¡€è®¾æ–½ï¼Œåªéœ€ç¼–å†™ä»£ç å¹¶ä¸Šä¼ ã€‚å‡½æ•°è®¡ç®—ä¼šä¸ºæ‚¨å‡†å¤‡å¥½è®¡ç®—èµ„æºï¼Œä»¥å¼¹æ€§ã€å¯é çš„æ–¹å¼è¿è¡Œæ‚¨çš„ä»£ç ï¼Œå¹¶æä¾›æ—¥å¿—æŸ¥è¯¢ã€æ€§èƒ½ç›‘æ§ã€æŠ¥è­¦ç­‰åŠŸèƒ½ã€‚å€ŸåŠ©äºå‡½æ•°è®¡ç®—ï¼Œæ‚¨å¯ä»¥å¿«é€Ÿæ„å»ºä»»ä½•ç±»å‹çš„åº”ç”¨å’ŒæœåŠ¡ï¼Œæ— éœ€ç®¡ç†å’Œè¿ç»´ã€‚è€Œä¸”ï¼Œæ‚¨åªéœ€è¦ä¸ºä»£ç å®é™…è¿è¡Œæ‰€æ¶ˆè€—çš„èµ„æºä»˜è´¹ï¼Œä»£ç æœªè¿è¡Œåˆ™ä¸äº§ç”Ÿè´¹ç”¨ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>åŸºäºå‡½æ•°è®¡ç®—çš„ç‰¹ç‚¹ï¼Œå¯ä»¥å¾ˆå¥½æ»¡è¶³ä»¥ä¸‹éœ€æ±‚ï¼Œ&lt;/p>
&lt;ul>
&lt;li>ä¸šåŠ¡æµé‡ä¸ç¡®å®šæˆ–æœ‰æ˜ç»†çš„å‘¨æœŸæ€§&lt;/li>
&lt;li>æ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿç»éªŒä¸è¶³&lt;/li>
&lt;li>æ— éœ€è¿ç»´&lt;/li>
&lt;li>æŒ‰éœ€è®¡ç®—&lt;/li>
&lt;li>è®¡è´¹çµæ´»&lt;/li>
&lt;/ul>
&lt;p>ç”±äºå‡½æ•°è®¡ç®—çš„æ‰©å±•èƒ½åŠ›ï¼Œå¯¹è¿ç»´çš„è¦æ±‚æå°‘ï¼ŒæŒ‰é‡è®¡è´¹ç­‰ç‰¹æ€§ç”¨äºéœ€è¦å¿«é€ŸéªŒè¯çš„æ—©æœŸé¡¹ç›®ä¹Ÿæ˜¯éå¸¸å¥½çš„åœºæ™¯ã€‚&lt;/p>
&lt;p>ä¸‹é¢è¿™ä¸ªslideæ˜¯è¿‘æœŸé’ˆå¯¹é˜¿é‡Œäº‘å‡½æ•°è®¡ç®—åšçš„åˆ†äº«ã€‚&lt;/p>
&lt;div class="responsive-wrap">
&lt;iframe src="https://docs.google.com/presentation/d/e/2PACX-1vQpucN0Imyd1rram7bmQJzO5lRwRrph5KDL18swF_MuKiUFm4_H2Hg8cpUnP_83yqleJnSXYtE9gvUv/embed?start=false&amp;amp;loop=false&amp;amp;delayms=60000" frameborder="0" width="960" height="569" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true">&lt;/iframe>
&lt;/div></description></item><item><title>ä¸ºKubernetesä¸­ä»»æ„åº”ç”¨æ·»åŠ åŸºäºoauth2çš„è®¤è¯ä¿æŠ¤ (ä¸Š)</title><link>https://kane.mx/posts/effective-cloud-computing/oauth2-proxy-on-kubernetes/part1/</link><pubDate>Sun, 03 Feb 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/effective-cloud-computing/oauth2-proxy-on-kubernetes/part1/</guid><description>&lt;p>ä¼ä¸šéšç€ä¸šåŠ¡çš„å‘å±•ï¼Œå¿…ç„¶ä¼šéƒ¨ç½²å„ç§å„æ ·çš„ITç³»ç»Ÿã€‚å‡ºäºå®‰å…¨æ€§çš„è€ƒè™‘ï¼Œä¸€äº›ç³»ç»Ÿä»…å¯ä¼ä¸šå†…éƒ¨ä½¿ç”¨ï¼Œç”šè‡³ä»…å¼€æ”¾ç»™ä¼ä¸šéƒ¨åˆ†éƒ¨é—¨å‘˜å·¥ä½¿ç”¨ã€‚&lt;/p>
&lt;p>è¿™äº›ITç³»ç»Ÿå¤§è‡´å¯åˆ†ä¸ºä¸¤ç±»ï¼Œ&lt;/p>
&lt;ol>
&lt;li>ç³»ç»Ÿæœ¬èº«ä¸æ”¯æŒä»»ä½•è®¤è¯æœºåˆ¶ï¼Œä¾‹å¦‚èµ„è®¯æˆ–æ–‡æ¡£ç±»ç³»ç»Ÿã€‚éœ€è¦å¢åŠ è®¤è¯ä¿æŠ¤ï¼Œèƒ½å¤Ÿé™åˆ¶éä¼ä¸šå‘˜å·¥è®¿é—®å³å¯ã€‚ç³»ç»Ÿè¿ç»´é€šå¸¸çš„åšæ³•æ˜¯ï¼Œä¸ºç«™ç‚¹è®¾ç½®&lt;a href="https://en.wikipedia.org/wiki/Basic_access_authentication">HTTP Basicè®¤è¯&lt;/a>ä¿æŠ¤ã€‚ç”±äº&lt;a href="https://en.wikipedia.org/wiki/Basic_access_authentication">HTTP Basicè®¤è¯&lt;/a>æ˜¯é€šè¿‡é¢„è®¾çš„ç”¨æˆ·ã€å¯†ç è®¤è¯ï¼Œè®¤è¯ä¿¡æ¯æ¯”è¾ƒå®¹æ˜“æ³„éœ²ã€‚å³ä½¿å®šæœŸæ›´æ¢å¯†ç ï¼Œä½†éœ€è¦é¢å¤–çš„æœºåˆ¶é€šçŸ¥ç”¨æˆ·å¯†ç çš„å˜æ›´ï¼Œç”¨æˆ·ä½“éªŒä¹Ÿä¸å¥½ã€‚&lt;/li>
&lt;li>ç³»ç»Ÿè‡ªèº«æ”¯æŒè®¤è¯ï¼Œç”šè‡³æ”¯æŒå¤šç§è®¤è¯æœºåˆ¶ã€‚æ¯”å¦‚æœ€å¸¸ç”¨çš„å¼€æºCI/CDå·¥å…·ï¼Œ&lt;a href="https://jenkins.io/">Jenkins&lt;/a>å†…ç½®æ”¯æŒæœ¬åœ°æ•°æ®åº“è®¤è¯ã€é€šè¿‡&lt;a href="https://plugins.jenkins.io/#">æ’ä»¶&lt;/a>æ”¯æŒå¤šç§ç¬¬ä¸‰æ–¹ç³»ç»Ÿé›†æˆè®¤è¯ã€‚å¦‚æœå¤§é‡çš„ITç³»ç»Ÿéƒ½æœ‰ä¸€å¥—ç‹¬ç«‹çš„ç”¨æˆ·ç®¡ç†ï¼Œéšç€ä¼ä¸šçš„å‘˜å·¥çš„å˜æ›´ï¼Œç”¨æˆ·çš„å¢åˆ ç­‰æ“ä½œå¯¹ç³»ç»Ÿç®¡ç†å‘˜æ¥è¯´æ˜¯ä¸å°çš„å·¥ä½œé‡ã€‚åŒæ—¶ï¼Œä¹Ÿå¾ˆå®¹æ˜“ç”±äºäººä¸ºç–å¿½ï¼Œé€ æˆèµ„äº§ã€æ•°æ®çš„å®‰å…¨éšæ‚£ã€‚&lt;/li>
&lt;/ol>
&lt;p>å‡è®¾ä¼ä¸šè‡ªèº«å·²ç»æœ‰äº†ä¸€å¥—OAç³»ç»ŸåŒ…å«å‘˜å·¥ã€ç»„ç»‡ç»“æ„ç®¡ç†ï¼Œä¾‹å¦‚ï¼Œå›½å†…ç›®å‰æœ€ä¸ºæ™®åŠæµè¡Œçš„&lt;a href="https://www.dingtalk.com/">é’‰é’‰&lt;/a>æˆ–&lt;a href="https://work.weixin.qq.com/">ä¼ä¸šå¾®ä¿¡&lt;/a>ã€‚æˆ‘ä»¬å®Œå…¨å¯ä»¥æä¾›ä¸€å¥—åŸºäº&lt;a href="https://oauth.net/2/">oauth 2.0åè®®&lt;/a>çš„è®¤è¯æ–¹å¼ï¼Œè®©ä»¥ä¸Šä¸¤ç±»ITç³»ç»Ÿä½¿ç”¨ä¼ä¸šå·²æœ‰çš„OAç³»ç»Ÿ(&lt;a href="https://www.dingtalk.com/">é’‰é’‰&lt;/a>æˆ–&lt;a href="https://work.weixin.qq.com/">ä¼ä¸šå¾®ä¿¡&lt;/a>)æ¥å®ç°ç™»å½•è®¤è¯ã€‚åšåˆ°è¿™ä¸€ç‚¹åï¼Œä¼ä¸šæ— è®ºæœ‰å¤šå°‘ITç³»ç»Ÿéƒ½ä¸å†éœ€è¦é¢å¤–ç®¡ç†ç”¨æˆ·çš„æˆæœ¬ï¼Œå¹¶ä¸”ä¹Ÿé¿å…äº†æ•°æ®å®‰å…¨éšæ‚£ã€‚&lt;/p>
&lt;p>&lt;a href="https://www.dingtalk.com/">é’‰é’‰&lt;/a>é€šè¿‡&lt;a href="https://open-dev.dingtalk.com">é’‰é’‰å¼€æ”¾å¹³å°&lt;/a>æä¾›çš„APIå¼€æ”¾äº†è®¸å¤šé’‰é’‰å†…éƒ¨çš„èƒ½åŠ›ï¼Œä¾‹å¦‚ï¼Œ&lt;a href="https://open-doc.dingtalk.com/microapp/serverapi2/vt6khw">èº«ä»½éªŒè¯&lt;/a>ã€&lt;a href="https://open-doc.dingtalk.com/microapp/serverapi2/cqfmel">é€šè®¯å½•ç®¡ç†&lt;/a>ç­‰ç­‰ã€‚ç„¶è€Œ&lt;a href="https://open-doc.dingtalk.com/microapp/serverapi2/kymkv6">é’‰é’‰çš„ä¸‰æ–¹ç½‘ç«™ç™»å½•æ¥å£&lt;/a>å¹¶ä¸æ˜¯æ ‡å‡†çš„&lt;a href="https://oauth.net/2/">oauth 2.0åè®®&lt;/a>å®ç°ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ä¸€ä¸ª&lt;a href="https://github.com/zxkane/oauth2_proxy">oauth2 proxy&lt;/a>ä»£ç†å·¥å…·å®ç°å°†&lt;a href="https://open-doc.dingtalk.com/microapp/serverapi2/kymkv6">é’‰é’‰çš„ä¸‰æ–¹ç½‘ç«™ç™»å½•&lt;/a>å…¼å®¹&lt;a href="https://oauth.net/2/">oauth2&lt;/a>åè®®ã€‚åŒç†ï¼Œä½¿ç”¨&lt;a href="https://github.com/bitly/oauth2_proxy">è¿™ä¸ªoauth2ä»£ç†å·¥å…·&lt;/a>ï¼Œå¯ä»¥ä½¿ç”¨&lt;a href="https://github.com/bitly/oauth2_proxy#google-auth-provider">Google&lt;/a>ã€&lt;a href="https://github.com/bitly/oauth2_proxy#facebook-auth-provider">Facebook&lt;/a>ç­‰ä¸‰æ–¹ç½‘ç«™ä½œä¸ºç»Ÿä¸€è®¤è¯æ–¹å¼ã€‚&lt;/p>
&lt;p>æœ‰äº†åŸºäº&lt;a href="https://github.com/zxkane/oauth2_proxy">é’‰é’‰çš„oauth2ä»£ç†&lt;/a>ä½œä¸ºä¼ä¸šç»Ÿä¸€ç™»å½•æ–¹å¼ï¼Œå¯¹äºä¸Šé¢ä¸¤å¤§ç±»ç³»ç»Ÿçš„è®¤è¯éœ€æ±‚è§£å†³æ–¹æ¡ˆåˆ†åˆ«å¦‚ä¸‹ï¼Œ&lt;/p>
&lt;ol>
&lt;li>éƒ¨ç½²åœ¨&lt;a href="https://kubernetes.io/">Kubernetes&lt;/a>ä¸­æ— å†…ç½®è®¤è¯æœºåˆ¶çš„Webåº”ç”¨ï¼Œé€šè¿‡&lt;a href="https://kubernetes.github.io/ingress-nginx/">nginx-ingress&lt;/a>çš„&lt;a href="https://kubernetes.github.io/ingress-nginx/examples/auth/oauth-external-auth/">å¤–éƒ¨OAUTHè®¤è¯&lt;/a>å®ç°åŸºäºoauth2çš„å®‰å…¨è®¤è¯ã€‚&lt;/li>
&lt;li>&lt;a href="https://jenkins.io/">Jenkins&lt;/a>å¯ä»¥é€šè¿‡&lt;a href="https://plugins.jenkins.io/reverse-proxy-auth-plugin">åå‘ä»£ç†æ’ä»¶&lt;/a>å®ç°ä½¿ç”¨oauth2è®¤è¯ç™»å½•ã€‚&lt;/li>
&lt;/ol>
&lt;p>åœ¨&lt;a href="https://kane.mx/posts/effective-cloud-computing/oauth2-proxy-on-kubernetes/part2/">ä¸‹ç¯‡&lt;/a>ä¸­ï¼Œæˆ‘ä»¬å°†å›¾æ–‡è¯¦è§£å¦‚ä½•ä¸€æ­¥æ­¥å®ç°ä¸ºä¸€ä¸ªæ— è®¤è¯çš„ä¼ä¸šæ–‡æ¡£Webåº”ç”¨æ·»åŠ åŸºäº&lt;a href="https://open-doc.dingtalk.com/microapp/serverapi2/vt6khw">é’‰é’‰çš„ç»Ÿä¸€è®¤è¯&lt;/a>ã€‚&lt;/p></description></item><item><title>IAMæœ€ä½³å®è·µ</title><link>https://kane.mx/posts/effective-cloud-computing/iam-best-practice/</link><pubDate>Fri, 01 Feb 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/effective-cloud-computing/iam-best-practice/</guid><description>&lt;p>ä¼ä¸šä½¿ç”¨å…¬æœ‰äº‘æœåŠ¡çš„ç¬¬ä¸€ä»¶äº‹æƒ…å°±æ˜¯åˆ›å»ºäº‘å¸å·ï¼Œæœ‰äº†å¸å·ä¹‹åå¦‚ä½•è®©ä¼ä¸šå‘˜å·¥å®‰å…¨åˆè§„çš„ä½¿ç”¨äº‘å¸å·ä¸‹çš„å„ç§èµ„æºæ˜¯å¼€å¯äº‘ä¹‹æ—…åçš„ç¬¬ä¸€ä¸ªè€ƒéªŒã€‚&lt;/p>
&lt;p>äº‘è®¡ç®—å‚å•†é’ˆå¯¹ä¼ä¸šä¸Šäº‘åé¢ä¸´çš„ç¬¬ä¸€ä¸ªéœ€æ±‚å·²ç»æ¨å‡ºäº†å®Œå–„çš„è§£å†³æ–¹æ¡ˆ&amp;ndash;&lt;a href="https://en.wikipedia.org/wiki/Identity_management">Identity and Access Management&lt;/a>ã€‚&lt;a href="https://en.wikipedia.org/wiki/Identity_management">IAM&lt;/a>å¯ä»¥å¸®åŠ©äº‘å¸å·å®‰å…¨åœ°æ§åˆ¶å¯¹äº‘è®¡ç®—æœåŠ¡èµ„æºçš„è®¿é—®ã€‚ä¼ä¸šå¯ä»¥ä½¿ç”¨IAMæ§åˆ¶å¯¹å“ªä¸ªç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯ (ç™»å½•) å’Œæˆæƒ (å…·æœ‰æƒé™) ä»¥ä½¿ç”¨èµ„æºã€‚&lt;/p>
&lt;p>äº‘å‚å•†æ˜¯å¦æä¾›å®Œå–„çš„IAMæœåŠ¡å¯ä»¥ä½œä¸ºæ•´ä½“äº§å“è§£å†³æ–¹æ¡ˆæ˜¯å¦æˆç†Ÿçš„ä¸€ä¸ªè¡¡é‡æŒ‡æ ‡ï¼Œæ¯”å¦‚AWSçš„&lt;a href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/introduction.html">IAM&lt;/a>å’Œé˜¿é‡Œäº‘çš„&lt;a href="https://help.aliyun.com/document_detail/28627.html">è®¿é—®æ§åˆ¶&lt;/a>éƒ½æ˜¯è¾ƒä¸ºæˆç†Ÿå®Œå–„çš„äº§å“ã€‚å›½å†…æŸä¸ªä»¥AIèƒ½åŠ›ä¸ºå–ç‚¹çš„äº‘å‚å•†ï¼Œåœ¨IAMäº§å“æ–¹é¢å‡ ä¹ä¸ºé›¶ï¼Œå¾ˆéš¾ç›¸ä¿¡å¯¹å®‰å…¨åˆè§„æœ‰éœ€æ±‚çš„ä¼ä¸šä¼šå®Œæ•´ä½¿ç”¨ä»–çš„äº‘äº§å“ä½œä¸ºè§£å†³æ–¹æ¡ˆã€‚&lt;/p>
&lt;p>&lt;a href="https://en.wikipedia.org/wiki/Identity_management">IAM&lt;/a>é€šå¸¸æä¾›ä»¥ä¸‹åŠŸèƒ½:&lt;/p>
&lt;h3 id="å¯¹äº‘è´¦æˆ·çš„å…±äº«è®¿é—®æƒé™">å¯¹äº‘è´¦æˆ·çš„å…±äº«è®¿é—®æƒé™&lt;/h3>
&lt;p>å…è®¸åœ¨ä¸€ä¸ªäº‘è´¦æˆ·ä¸‹åˆ›å»ºå¹¶ç®¡ç†å¤šä¸ªç”¨æˆ·èº«ä»½ï¼Œå¹¶å…è®¸ç»™å•ä¸ªèº«ä»½æˆ–ä¸€ç»„èº«ä»½ï¼ˆæ—¢å¯ä»¥æ˜¯å½“å‰äº‘å¸å·ä¸‹ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–äº‘å¸å·ä¸‹ï¼‰åˆ†é…ä¸åŒçš„æƒé™ç­–ç•¥ï¼Œä»è€Œå®ç°ä¸åŒç”¨æˆ·æ‹¥æœ‰ä¸åŒçš„äº‘èµ„æºè®¿é—®æƒé™ï¼Œè€Œä¸å¿…å…±äº«äº‘å¸å·æ ¹ç”¨æˆ·çš„å¯†ç æˆ–è®¿é—®å¯†é’¥ã€‚&lt;/p>
&lt;h3 id="ç²¾ç»†æƒé™">ç²¾ç»†æƒé™&lt;/h3>
&lt;p>å¯ä»¥é’ˆå¯¹ä¸åŒèµ„æºå‘ä¸åŒäººå‘˜æˆäºˆä¸åŒæƒé™ã€‚å¯ä»¥è¦æ±‚ç”¨æˆ·å¿…é¡»ä½¿ç”¨å®‰å…¨ä¿¡é“ï¼ˆå¦‚ SSLï¼‰ã€åœ¨æŒ‡å®šæ—¶é—´èŒƒå›´ã€æˆ–åœ¨æŒ‡å®šæº IP æ¡ä»¶ä¸‹æ‰èƒ½æ“ä½œæŒ‡å®šçš„äº‘èµ„æºã€‚&lt;/p>
&lt;h3 id="å¤šé‡éªŒè¯-mfa">å¤šé‡éªŒè¯ (MFA)&lt;/h3>
&lt;p>å¯ä»¥å‘äº‘è´¦æˆ·å’Œå„ä¸ªç”¨æˆ·æ·»åŠ åŒé‡èº«ä»½éªŒè¯ä»¥å®ç°æ›´é«˜å®‰å…¨æ€§ã€‚å€ŸåŠ©&lt;a href="https://en.wikipedia.org/wiki/Multi-factor_authentication">MFA&lt;/a>ï¼Œç”¨æˆ·ä¸ä»…å¿…é¡»æä¾›ä½¿ç”¨è´¦æˆ·æ‰€éœ€çš„å¯†ç æˆ–è®¿é—®å¯†é’¥ï¼Œè¿˜å¿…é¡»æä¾›æ¥è‡ªç»è¿‡ç‰¹æ®Šé…ç½®çš„è®¾å¤‡çš„ä»£ç ã€‚&lt;/p>
&lt;h3 id="è”åˆèº«ä»½">è”åˆèº«ä»½&lt;/h3>
&lt;p>å¯ä»¥å…è®¸å·²åœ¨å…¶ä»–ä½ç½®ï¼ˆä¾‹å¦‚ï¼Œåœ¨ä¼ä¸šç½‘ç»œä¸­æˆ–é€šè¿‡ Internet èº«ä»½æä¾›å•†ï¼‰è·å¾—å¯†ç çš„ç”¨æˆ·è·å–å¯¹äº‘è´¦æˆ·çš„ç”¨æˆ·è®¿é—®æƒé™ã€‚&lt;/p>
&lt;p>åé¢ä¼šæœ‰ä¸“é—¨çš„æ–‡ç« æ¥è®²å¦‚ä½•å®è·µè”åˆèº«ä»½ã€‚&lt;/p>
&lt;h3 id="ç»Ÿä¸€è´¦å•">ç»Ÿä¸€è´¦å•&lt;/h3>
&lt;p>äº‘è´¦æˆ·æ¥æ”¶åŒ…æ‹¬æ‰€æœ‰ç”¨æˆ·çš„èµ„æºæ“ä½œæ‰€å‘ç”Ÿè´¹ç”¨çš„ç»Ÿä¸€è´¦å•ã€‚&lt;/p>
&lt;blockquote>
&lt;p>å°½ç®¡&lt;a href="https://en.wikipedia.org/wiki/Identity_management">IAM&lt;/a>æä¾›äº†ä¸Šé¢ç§ç§åŠŸèƒ½ï¼Œäº‘å¸å·çš„ç®¡ç†è€…ä»å¯é€šè¿‡ä¸€äº›æœ€ä½³å®è·µæ¥æ›´å¥½çš„ä½¿ç”¨IAMäº§å“æ¥æå‡å®‰å…¨çº§åˆ«å’Œå‡å°‘è¿ç»´æˆæœ¬ã€‚&lt;/p>
&lt;/blockquote>
&lt;h2 id="iamæœ€ä½³å®è·µ">IAMæœ€ä½³å®è·µ&lt;/h2>
&lt;ul>
&lt;li>å°½é‡ä¸è¦ä½¿ç”¨äº‘å¸å·çš„æ ¹ç”¨æˆ·ï¼Œ&lt;strong>ä¸è¦ä¸ºæ ¹ç”¨æˆ·åˆ›å»ºAK&lt;/strong>ã€‚äº‘å¸å·ç®¡ç†å‘˜ä¹Ÿä½¿ç”¨å„è‡ªç‹¬ç«‹çš„å­è´¦å·ã€‚&lt;/li>
&lt;li>&lt;strong>ä¸ºä¼ä¸šä¸­æ¯ä¸€ä¸ªéœ€è¦ä½¿ç”¨äº‘æœåŠ¡çš„å‘˜å·¥å•ç‹¬åˆ›å»ºå­è´¦æˆ·ï¼Œä¸”é»˜è®¤ä¸å…è®¸åˆ›å»ºAK&lt;/strong>ã€‚ä¾¿äºå‘˜å·¥ç¦»èŒçš„æ—¶å€™ï¼Œé€šè¿‡åˆ é™¤å¸å·æ¥å®Œå…¨æ¸…ç†ç”¨æˆ·åœ¨äº‘è®¡ç®—å¹³å°çš„å„ç§æƒé™ã€‚&lt;/li>
&lt;li>å¯†ç å®‰å…¨å®è·µï¼Œ
&lt;ul>
&lt;li>é™åˆ¶å¯†ç å¼ºåº¦&lt;strong>ä¸å°‘äº8ä½&lt;/strong>ï¼Œå¿…é¡»&lt;strong>ç”±å¤§å°å†™å­—æ¯ã€æ•°å­—å’Œç¬¦å·ä¸­çš„ä¸‰ç§ç»„æˆ&lt;/strong>ã€‚&lt;/li>
&lt;li>å¼ºåˆ¶å¯†ç &lt;strong>è¿‡æœŸæ—¶é—´ä¸è¶…è¿‡90å¤©&lt;/strong>ï¼Œä¸”è¿‡æœŸåä¸å¯ç™»å½•ã€‚&lt;/li>
&lt;li>æ–°å¯†ç è‡³å°‘&lt;strong>ç¦æ­¢ä½¿ç”¨å‰3æ¬¡å¯†ç &lt;/strong>ã€‚&lt;/li>
&lt;li>è®¾ç½®å¯†ç é‡è¯•çº¦æŸï¼Œä¾‹å¦‚ï¼Œ&lt;strong>ä¸€å°æ—¶å†…ä½¿ç”¨é”™è¯¯å¯†ç æœ€å¤§å°è¯•9æ¬¡ç™»å½•&lt;/strong>ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¼ºåˆ¶æ‰€æœ‰ç”¨æˆ·å¯ç”¨&lt;a href="https://en.wikipedia.org/wiki/Multi-factor_authentication">ä¸¤æ­¥è®¤è¯&lt;/a>ã€‚&lt;/li>
&lt;li>å¯¹è®¿é—®ç½‘ç»œæœ‰é™åˆ¶çš„ä¼ä¸šï¼Œå¯ä»¥å¼€å¯ç™»å½•IPé™åˆ¶ã€‚&lt;/li>
&lt;li>[&lt;strong>æ¨èåšæ³•&lt;/strong>]å·²æœ‰SSOå•ç‚¹ç™»å½•ç³»ç»Ÿçš„ä¼ä¸šï¼Œå¯ä»¥é€šè¿‡&lt;a href="https://en.wikipedia.org/wiki/SAML_2.0">SAML 2.0æ ‡å‡†&lt;/a>å®ç°ä»ä¼ä¸šæœ¬åœ°è´¦å·ç³»ç»Ÿç™»å½•åˆ°é˜¿é‡Œäº‘ï¼Œä»è€Œæ»¡è¶³ä¼ä¸šçš„ç»Ÿä¸€ç”¨æˆ·ç™»å½•è®¤è¯è¦æ±‚ã€‚&lt;/li>
&lt;li>ç»†ç²’åº¦çš„æƒé™ç®¡ç†ï¼Œ
&lt;ul>
&lt;li>&lt;strong>ä¸ºå„ç§äº‘èµ„æºåˆ›å»ºæœ€ç»†ç²’åº¦çš„æƒé™ç­–ç•¥&lt;/strong>ã€‚ä¾‹å¦‚ï¼Œåˆ†åˆ«ä¸ºRDSå®ä¾‹&lt;code>rds-instance-1&lt;/code>åˆ›å»ºåªè¯»æƒé™ç­–ç•¥&lt;code>rds-instance-1-readonly-access&lt;/code>ï¼ŒRDSå®ä¾‹&lt;code>rds-instance-2&lt;/code>åˆ›å»ºåªè¯»æƒé™ç­–ç•¥&lt;code>rds-instance-2-readonly-access&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;strong>æ ¹æ®èŒèƒ½ã€éƒ¨é—¨ç­‰ç»´åº¦ä¸ºäº‘å¸å·å­ç”¨æˆ·åˆ›å»ºç”¨æˆ·ç»„&lt;/strong>ã€‚ä¾‹å¦‚ï¼ŒæŒ‰é¡¹ç›®åˆ›å»ºç”¨æˆ·ç»„ï¼Œ&lt;code>group-project-a&lt;/code>ï¼Œ&lt;code>group-project-b&lt;/code>ã€‚å¦‚æœ&lt;code>project-a&lt;/code>ç”¨æˆ·éœ€è¦è®¿é—®&lt;code>rds-instance-1&lt;/code>çš„ä¿¡æ¯ï¼Œå°†è‡ªå®šä¹‰æƒé™&lt;code>rds-instance-1-readonly-access&lt;/code>æˆæƒç»™&lt;code>group-project-a&lt;/code>ã€‚å†å°†ç›¸å…³ç”¨æˆ·åŠ åˆ°ç”¨æˆ·ç»„&lt;code>group-project-a&lt;/code>ä¸­ï¼Œè¿™æ ·è¿™äº›ç”¨æˆ·å°±å…·æœ‰åªè¯»è®¿é—®RDSå®ä¾‹&lt;code>rds-instance-1&lt;/code>çš„æƒé™ã€‚è€Œä¸æ˜¯å°†æ‰€æœ‰RDSçš„è¯»å†™æƒé™éƒ½æˆäºˆè¿™äº›ç”¨æˆ·ï¼Œ&lt;strong>æœ€å¤§é™åº¦çš„ä¿è¯ç”¨æˆ·ä¸è·å–è¶…è¿‡å®é™…éœ€è¦çš„æƒé™&lt;/strong>ã€‚&lt;/li>
&lt;li>åœ¨å®é™…åœºæ™¯ä¸­ï¼Œé€šå¸¸ä¼šé€šè¿‡äº‘è®¡ç®—æœåŠ¡çš„APIæ¥å®ŒæˆæŸäº›å‘¨æœŸæ€§ä»»åŠ¡ï¼Œæ¯”å¦‚æ¯æ—¥RDSä¸­çš„æ…¢æŸ¥è¯¢ç»Ÿè®¡ã€äº‘å¸å·æ¯æ—¥èŠ±è´¹ç»Ÿè®¡ç­‰ã€‚è¿™äº›ä»»åŠ¡éƒ½éœ€è¦ä¸€ä¸ªäº‘å¸å·çš„AKæ¥å®ŒæˆAPIçš„èº«ä»½è®¤è¯ã€‚æœ€ä½³çš„åšæ³•æ˜¯ï¼Œ&lt;strong>ä¸ºæ¯ç±»ç›¸å…³çš„ä»»åŠ¡åˆ›å»ºä¸€ä¸ª&lt;code>åŠŸèƒ½æ€§å­è´¦å·&lt;/code>&lt;/strong>ï¼Œç¦ç”¨ä»–ä»¬çš„webç™»å½•ï¼Œä¸”éµå¾ªç‰¹æ®Šçš„å‘½åè§„èŒƒ(&lt;code>functional-&lt;/code>å¼€å¤´)ï¼Œæ¯”å¦‚&lt;code>functional-rds-stats&lt;/code>ã€&lt;code>functional-cost-stats&lt;/code>ã€‚åˆ›å»ºæœ€å°çš„æƒé™ç­–ç•¥ï¼Œç„¶ååˆ†é…ç»™è¿™äº›åŠŸèƒ½æ€§ç”¨æˆ·ã€‚ä¾‹å¦‚ï¼Œ&lt;code>functional-rds-stats&lt;/code>ä»…è¢«æˆäºˆRDSåªè¯»æƒé™ï¼Œ&lt;code>functional-cost-stats&lt;/code>ä»…è¢«æˆäºˆè´¹ç”¨çš„åªè¯»æƒé™ã€‚ä¸ºè¿™äº›å­è´¦å·åˆ›å»ºAKï¼Œæ¯ç±»ä»»åŠ¡ä½¿ç”¨ä¸åŒçš„AKæ¥å®ŒæˆAPIè®¤è¯ï¼Œè€Œä¸æ˜¯éƒ½ä½¿ç”¨åŒä¸€ä¸ªAKã€‚è¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œä¸åŒç±»å‹ä»»åŠ¡çš„AKå…·æœ‰ä¸åŒçš„æƒé™ï¼Œæœ€å¤§é™åº¦çš„ä¿æŠ¤äº†äº‘å¸å·çš„å®‰å…¨ï¼Œå¹¶ä¸”è¿™äº›AKä¸è·Ÿå®é™…çš„å‘˜å·¥å­è´¦å·å…³è”ï¼Œä¸ä¼šå› ä¸ºå‘˜å·¥å¸å·çš„å˜æ›´è€Œå—å½±å“ã€‚å¦‚æœ‰æ›´é«˜çš„å®‰å…¨åˆè§„çš„è¦æ±‚ä¸‹ï¼Œå¯ä»¥å®šæœŸä½œåºŸå·²æœ‰AKï¼Œåˆ›å»ºæ–°AKæ›¿æ¢ã€‚è‡³äºAKæ€æ ·å®‰å…¨ç®¡ç†ï¼Œä¹‹åä¼šæœ‰ä¸“é—¨çš„æ–‡ç« æ¥è¯¦è§£ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item><item><title>ä¸è¦è‡ªå»ºKubernetes</title><link>https://kane.mx/posts/effective-cloud-computing/using-kubernetes-on-cloud/</link><pubDate>Tue, 22 Jan 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/effective-cloud-computing/using-kubernetes-on-cloud/</guid><description>&lt;p>è¿™æ˜¯â€œå¦‚ä½•é«˜æ•ˆä½¿ç”¨äº‘æœåŠ¡â€ç³»åˆ—æ–‡ç« çš„é¦–ç¯‡åˆ†äº«ã€‚å¯èƒ½æœ‰æœ‹å‹å¥½å¥‡ä¸ºä»€ä¹ˆä¸æ˜¯ä»äº‘è®¡ç®—æœ€åŸºç¡€çš„æœåŠ¡&amp;ndash;è®¡ç®—èµ„æº&lt;a href="https://cn.aliyun.com/product/ecs">ECS&lt;/a>/&lt;a href="https://aws.amazon.com/cn/ec2/">EC2&lt;/a>è®²èµ·å‘¢ï¼Ÿåœ¨&lt;a href="https://pivotal.io/cloud-native">Cloud Native&lt;/a>å·²ç»è¢«è¶Šæ¥è¶Šæ¥å—çš„ä»Šå¤©ï¼ŒåŸºäº&lt;a href="https://kubernetes.io/">Kubernetes&lt;/a>éƒ¨ç½²ã€ç¼–æ’åº”ç”¨çš„æ–¹å¼å·²ç»æ˜¯ä¸šç•Œçš„äº‹å®æ ‡å‡†ã€‚æ— è®ºæ˜¯äº’è”ç½‘å·¨å¤´ï¼Œä¼ ç»Ÿ500å¼ºä¼ä¸šï¼Œè¿˜æ˜¯åˆ›ä¸šå›¢é˜Ÿéƒ½åœ¨ä½¿ç”¨æˆ–è§„åˆ’ä½¿ç”¨&lt;a href="https://kubernetes.io/">Kubernetes&lt;/a>ä½œä¸ºåº”ç”¨ç¨‹åºçš„è‡ªåŠ¨åŒ–éƒ¨ç½²ã€å¯æ‰©å±•ç®¡ç†å¹³å°ã€‚åœ¨äº‘è®¡ç®—å¹³å°ï¼Œè™šæ‹Ÿæœºè¶Šæ¥è¶Šä¸éœ€è¦å•ç‹¬çš„ç®¡ç†ï¼Œåœ¨ç»å¤§å¤šæ•°çš„ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œå®ƒä»¬åªæ˜¯ä½œä¸ºå®¹å™¨é›†ç¾¤æ‰€ç®¡ç†çš„è®¡ç®—èµ„æºã€‚ç”šè‡³è™šæ‹Ÿæœºçš„åˆ›å»ºåˆ°é”€æ¯æ•´ä¸ªç”Ÿå‘½å‘¨æœŸç®¡ç†éƒ½å¯ä»¥ç”±&lt;a href="https://kubernetes.io/">Kubernetes&lt;/a>æ ¹æ®é›†ç¾¤çš„è´Ÿè½½æ¥è‡ªåŠ¨å®Œæˆã€‚&lt;/p>
&lt;p>æ‰€æœ‰ä¸»æµçš„äº‘è®¡ç®—å‚å•†éƒ½åœ¨è§£å†³æ–¹æ¡ˆä¸­åŠ›æ¨æ‰˜ç®¡çš„&lt;a href="https://kubernetes.io/">Kubernetes&lt;/a>ï¼Œ&lt;a href="https://aws.amazon.com/cn/">AWS&lt;/a>çš„&lt;a href="https://aws.amazon.com/eks">EKS&lt;/a>ï¼Œ&lt;a href="https://azure.microsoft.com/en-us/">Azure&lt;/a>ä¸Šçš„&lt;a href="https://azure.microsoft.com/en-us/services/kubernetes-service/">AKS&lt;/a>ï¼Œå½“ç„¶å°‘ä¸äº†Googleå®¶&lt;a href="https://cloud.google.com/">GCP&lt;/a>ä¸Šçš„&lt;a href="https://cloud.google.com/kubernetes-engine/">Kubernetes Engine&lt;/a>ã€‚å›½å†…&lt;a href="https://www.aliyun.com/product/kubernetes">é˜¿é‡Œäº‘&lt;/a>ï¼Œ&lt;a href="https://cloud.tencent.com/product/tke">è…¾è®¯äº‘&lt;/a>ç­‰æ¯ä¸€ä¸ªå…¬æœ‰äº‘ç©å®¶ä¹Ÿéƒ½åŸºäºå¼€æº&lt;a href="https://kubernetes.io/">Kubernetes&lt;/a>æ¨å‡ºäº†æ‰˜ç®¡æœåŠ¡ã€‚å¦‚æœä¸€å®¶äº‘è®¡ç®—å‚å•†åœ¨æä¾›æ‰˜ç®¡&lt;a href="https://kubernetes.io/">Kubernetes&lt;/a>è¿™ä¸€æœåŠ¡ä¸Šæ²¡è·Ÿä¸Šä¸šç•Œçš„æ­¥ä¼ï¼Œå°†æ¥æå¤§å¯èƒ½è¢«æ·˜æ±°å‡ºè¿™ä¸ªå¸‚åœºã€‚&lt;/p>
&lt;h2 id="æ‰˜ç®¡çš„kubernetesç±»å‹">æ‰˜ç®¡çš„Kubernetesç±»å‹&lt;/h2>
&lt;p>ä»¥å›½å†…çš„é˜¿é‡Œäº‘ä¸ºä¾‹ï¼Œç›®å‰æä¾›äº†ä¸¤å¤§ç±»ä¸‰ç§ä¸åŒçš„&lt;a href="https://help.aliyun.com/document_detail/86737.html">Kubernetesæ‰˜ç®¡æœåŠ¡&lt;/a>ã€‚&lt;/p>
&lt;ul>
&lt;li>ç»å…¸Dedicated Kubernetesæ¨¡å¼ã€‚è¿™ç§æ¨¡å¼ä¸‹ç”¨æˆ·å¯ä»¥é€‰æ‹©å®¿ä¸»æœºå®ä¾‹è§„æ ¼å’Œæ“ä½œç³»ç»Ÿï¼ŒæŒ‡å®šKubernetesç‰ˆæœ¬ã€è‡ªå®šä¹‰Kubernetesç‰¹æ€§å¼€å…³è®¾ç½®ç­‰ã€‚ç”¨æˆ·éœ€è¦æ‰‹åŠ¨ç»´æŠ¤é›†ç¾¤ï¼Œä¾‹å¦‚å‡çº§Kubernetesç‰ˆæœ¬ï¼Œå†…ç½®ç»„ä»¶ç‰ˆæœ¬ç­‰ã€‚å¯ä»¥æ‰‹åŠ¨æˆ–è‡ªåŠ¨ä¼¸ç¼©é›†ç¾¤èŠ‚ç‚¹æ•°ç›®ã€‚ç›®å‰è¯¥æ¨¡å¼ä¸‹æœ‰ä¸¤ç§ç±»å‹ï¼Œç¬¬ä¸€ç§é›†ç¾¤ä¸»èŠ‚ç‚¹éœ€è¦ä½¿ç”¨ç”¨æˆ·çš„ECSï¼Œç”¨æˆ·å¯è¿œç¨‹ç™»å½•æˆ–ç®¡ç†è¿™äº›ECSã€‚å¦ä¸€ç§æ˜¯ï¼Œä¸»èŠ‚ç‚¹ä¹Ÿç”±äº‘å‚å•†æ‰˜ç®¡ï¼Œç”¨æˆ·åªèƒ½é€šè¿‡API Serverç®¡ç†Kubernetesã€‚åœ¨è´¹ç”¨æ–¹é¢ï¼Œæ— è®ºæ˜¯å¦æ‰˜ç®¡é›†ç¾¤ä¸»èŠ‚ç‚¹ï¼Œé›†ç¾¤æœåŠ¡å…è´¹ï¼ŒæŒ‰ä½¿ç”¨çš„ECSå®ä¾‹åŠè®¡è´¹æ–¹å¼æ”¶è´¹ã€‚&lt;/li>
&lt;li>Serverless æ¨¡å¼(ç›®å‰å…¬æµ‹ä¸­ï¼Œæš‚æ—¶å…è´¹)ã€‚æ— éœ€åˆ›å»ºåº•å±‚è™šæ‹ŸåŒ–èµ„æºï¼Œå¯ä»¥åˆ©ç”¨ Kubernetes å‘½ä»¤æŒ‡æ˜åº”ç”¨å®¹å™¨é•œåƒã€CPUå’Œå†…å­˜è¦æ±‚ä»¥åŠå¯¹å¤–æœåŠ¡æ–¹å¼ï¼Œç›´æ¥å¯åŠ¨åº”ç”¨ç¨‹åºã€‚æŒ‰å®¹å™¨ä½¿ç”¨çš„CPUå’Œå†…å­˜èµ„æºé‡è®¡è´¹ã€‚è¿™ç§æ¨¡å¼ä¸‹åº”è¯¥æ˜¯åœ¨ä¸€ä¸ªé›†ç¾¤å†…å®ç°å¤šç§Ÿæˆ·ï¼Œç›®å‰æœ‰äº›&lt;a href="https://help.aliyun.com/document_detail/86371.html">featuresä¸è¢«æ”¯æŒ&lt;/a>ã€‚ä¾‹å¦‚ï¼Œéƒ¨ç½²ä¸æ”¯æŒDaemonSetï¼ŒIngressä¸æ”¯æŒNodePortç±»å‹ï¼Œå­˜å‚¨ä¸æ”¯æŒPVå’ŒPVCç­‰ã€‚&lt;/li>
&lt;/ul>
&lt;p>ç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡ç±»å‹æ¥é€‰æ‹©é€‚åˆçš„æ‰˜ç®¡Kubernetesé›†ç¾¤ã€‚å¦‚æœéƒ¨ç½²çš„åº”ç”¨æ˜¯&lt;a href="https://kubernetes.io/docs/tutorials/stateless-application/">æ— çŠ¶æ€çš„WebæœåŠ¡&lt;/a>ï¼Œå¯ä»¥é€‰æ‹©Serverless Kubernetesé›†ç¾¤ï¼Œè¿›ä¸€æ­¥å‡å°‘è¿ç»´å·¥ä½œé‡ã€‚&lt;/p>
&lt;p>å¦‚æœç”¨æˆ·éƒ¨ç½²çš„åº”ç”¨æœ‰çŠ¶æ€ï¼Œéœ€è¦æŒ‚è½½å¤–éƒ¨å­˜å‚¨ï¼Œä¾‹å¦‚MongDBé›†ç¾¤ï¼ŒMQé›†ç¾¤ï¼Œå¯ä»¥é€‰æ‹©ç»å…¸Dedicated Kubernetesæ¨¡å¼ã€‚å¦‚æœç”¨æˆ·éœ€è¦é€šè¿‡Kubernetesç»„ä»¶æ‰©å±•æˆ–è‡ªå®šä¹‰å®ç°æŸäº›åŠŸèƒ½ï¼Œè¿™äº›éœ€æ±‚äº‘å‚å•†çš„æ ‡å‡†ç‰ˆå¹¶æ²¡æœ‰æä¾›ï¼Œè¿™æ—¶å¯ä»¥é€‰æ‹©ç»å…¸Dedicated Kubernetesæ¨¡å¼ï¼Œåˆ©ç”¨Kubernetesé«˜åº¦çµæ´»çš„æ‰©å±•æœºåˆ¶æ¥æ»¡è¶³è‡ªå®šä¹‰éœ€æ±‚ã€‚&lt;/p>
&lt;h2 id="æ‰˜ç®¡kuberentesçš„ä¼˜åŠ¿">æ‰˜ç®¡Kuberentesçš„ä¼˜åŠ¿&lt;/h2>
&lt;p>å›½å†…çš„é˜¿é‡Œäº‘æœ‰ç¯‡æŠ€æœ¯æ–‡æ¡£å¯¹æ¯”&lt;a href="https://help.aliyun.com/document_detail/69575.html">é˜¿é‡Œäº‘Kubernetes vs. è‡ªå»ºKubernetes&lt;/a>ï¼Œæ–‡ç« çœ‹èµ·æ¥è™½ç„¶æœ‰å‚å•†è‡ªå–è‡ªå¤¸çš„å«Œç–‘ã€‚ä½œä¸º&lt;a href="https://www.aliyun.com/product/kubernetes">é˜¿é‡Œäº‘K8S&lt;/a>çš„å®¢æˆ·ï¼Œåœ¨ä½¿ç”¨æ‰˜ç®¡K8Sè¿‘ä¸€å¹´æ¥ï¼Œæ·±åˆ‡çš„ä½“ä¼šåˆ°äº‘å‚å•†æ‰˜ç®¡K8Så¸¦æ¥çš„ç§ç§å¥½å¤„ï¼Œæ–‡æ¡£ä¸­æåˆ°çš„ç§ç§ä¼˜åŠ¿ç¡®å®æ˜¯è¨€ä¹‹å‡¿å‡¿ã€‚&lt;/p>
&lt;p>æ¥ä¸‹æ¥å…·ä½“çœ‹çœ‹äº‘å‚å•†æ‰˜ç®¡K8Såˆ°åº•æœ‰å“ªäº›ä¼˜åŠ¿ã€‚&lt;/p>
&lt;h3 id="ä¾¿æ·">ä¾¿æ·&lt;/h3>
&lt;ul>
&lt;li>é€šè¿‡Webç•Œé¢/APIä¸€é”®åˆ›å»ºKubernetesé›†ç¾¤ï¼Œé›†ç¾¤å‡çº§ã€‚&lt;/li>
&lt;li>Webç•Œé¢/APIå®ç°é›†ç¾¤çš„æ‰©å®¹æˆ–ç¼©å®¹ã€‚&lt;/li>
&lt;/ul>
&lt;p>é›†ç¾¤çš„å®‰è£…ï¼Œè¡¥ä¸ä»¥åŠå¸¸è§„ç‰ˆæœ¬å‡çº§åœ¨è¿ç»´å·¥ä½œä¸­å±äºä½“åŠ›æ´»ã€‚åœ¨è§„æ¨¡ä¸å¤§çš„æ—¶å€™ï¼Œä½¿ç”¨äººå·¥å®ç°éœ€è¦èŠ±è´¹ä¸å°‘æ—¶é—´å‡†å¤‡ç¯å¢ƒæµ‹è¯•éªŒè¯ï¼Œä¸”æ˜“é”™ã€‚å¦‚æœé›†ç¾¤ä½“é‡ä¸å¤Ÿå¤§çš„è¯ï¼Œå¼€å‘è‡ªåŠ¨åŒ–è¿ç»´è„šæœ¬åˆæµªè´¹äººåŠ›æˆæœ¬ã€‚äº‘è®¡ç®—å‚å•†çš„æ‰˜ç®¡K8Sé›†ç¾¤å°†æä¾›ä¸“ä¸šã€ç¨³å®šçš„æŠ€æœ¯è¿ç»´æœåŠ¡ï¼Œå’Œå‡ ä¹ä¸ºé›¶çš„äººåŠ›æˆæœ¬ã€‚&lt;/p>
&lt;p>ä»æ•ˆç‡å’ŒäººåŠ›æˆæœ¬ä¸Šçœ‹ï¼Œ&lt;strong>æ‰˜ç®¡K8Sé›†ç¾¤å®Œèƒœè‡ªå»ºKubernetesé›†ç¾¤&lt;/strong>ã€‚&lt;/p>
&lt;h3 id="åŠŸèƒ½æ›´å¼ºå¤§">åŠŸèƒ½æ›´å¼ºå¤§&lt;/h3>
&lt;p>&lt;a href="https://kubernetes.io/">Kubernetes&lt;/a>ä½œä¸ºä¸€ä¸ªå®¹å™¨ç¼–æ’ç³»ç»Ÿï¼Œå¼€æºç‰ˆæœ¬ä¸­è®¸å¤šç»„ä»¶æ²¡æœ‰é»˜è®¤å®ç°æˆ–å®ç°æœ‰é™ï¼Œéœ€è¦è·Ÿè¿è¡Œç¯å¢ƒ(å¦‚æ‰˜ç®¡K8Sçš„äº‘å¹³å°)é›†æˆã€‚ä¾‹å¦‚ï¼Œå­˜å‚¨ï¼ŒLoad Balancerï¼Œç½‘ç»œç­‰æ ¸å¿ƒç»„ä»¶ã€‚å®˜æ–¹æ–‡æ¡£&lt;a href="https://kubernetes.io/docs/concepts/services-networking/service/#internal-load-balancer">Internal load balancer&lt;/a>å°±æä¾›äº†åœ¨ä¸åŒçš„äº‘å‚å•†ç¯å¢ƒä¸­çš„ä½¿ç”¨ç¤ºä¾‹ã€‚éƒ¨ç½²ä¸€ä¸ªå¼ºå¤§ä¸”å®Œæ•´çš„K8Sé›†ç¾¤éœ€è¦åŒè®¸å¤šäº‘è®¡ç®—çš„åŸºç¡€ç»„ä»¶é›†æˆ(ä¸”åªèƒ½é€šè¿‡APIå®Œæˆ)ï¼Œè¿™å¾€å¾€æ˜¯äº‘è®¡ç®—å‚å•†çš„å¼ºé¡¹ã€‚&lt;/p>
&lt;p>äº‘å‚å•†æ‰˜ç®¡çš„K8Så¯ä»¥åœ¨ä»¥ä¸‹æ–¹é¢æä¾›å¼ºå¤§çš„äº‘è®¡ç®—å¹³å°æ”¯æŒï¼Œ&lt;/p>
&lt;h4 id="ç½‘ç»œ">ç½‘ç»œ&lt;/h4>
&lt;ul>
&lt;li>é«˜æ€§èƒ½ VPC ç½‘ç»œæ’ä»¶ã€‚&lt;/li>
&lt;li>æ”¯æŒ network policy å’Œæµæ§ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="è´Ÿè½½å‡è¡¡">è´Ÿè½½å‡è¡¡&lt;/h4>
&lt;p>æ”¯æŒåˆ›å»ºå…¬ç½‘æˆ–å†…ç½‘è´Ÿè½½å‡è¡¡å®ä¾‹ï¼Œæˆ–è€…å¤ç”¨å·²æœ‰å®ä¾‹ã€‚æ”¯æŒæŒ‡å®šå¸¦å®½å¤§å°ã€è®¡è´¹æ–¹å¼ã€4å±‚æˆ–7å±‚åè®®ä»£ç†ç­‰äº‘å‚å•†è´Ÿè½½å‡è¡¡åŠŸèƒ½ã€‚å¯¹åº”ç”¨è¿ç»´æ¥è¯´å¯ä»¥æŠŠè´Ÿè½½å‡è¡¡çš„é…ç½®é€šè¿‡ä»£ç å®ç°ï¼Œå¹¶ä¸”æ”¯æŒç‰ˆæœ¬æ§åˆ¶ã€‚å¯¹æ¯”ä¼ ç»Ÿçš„äº‘ç«¯éƒ¨ç½²ï¼Œä¹Ÿå¯ä»¥å°†åº”ç”¨éƒ¨ç½²å’Œåº”ç”¨è¿ç»´é›†æˆåœ¨ä¸€èµ·ç»Ÿä¸€ç®¡ç†ï¼Œé¿å…åº”ç”¨å‘å¸ƒå’Œè¿ç»´é…ç½®çš„å‰²è£‚ï¼Œå‡å°‘äººä¸ºè¿ç»´å¤±è¯¯ã€‚&lt;/p>
&lt;p>é˜¿é‡Œäº‘æ‰˜ç®¡K8Sçš„è´Ÿè½½å‡è¡¡è¯¦ç»†é…ç½®å¯ä»¥å‚è€ƒè¿™ä¸ª&lt;a href="https://help.aliyun.com/document_detail/53759.html?spm=a2c4g.11186623.2.15.73364c07mR8rhS#h2-url-4">æ–‡æ¡£&lt;/a>ï¼ŒAWSä¸Šè§æ­¤&lt;a href="https://docs.aws.amazon.com/eks/latest/userguide/load-balancing.html">æ–‡æ¡£&lt;/a>ã€‚&lt;/p>
&lt;h4 id="å­˜å‚¨">å­˜å‚¨&lt;/h4>
&lt;p>é›†æˆäº†äº‘å‚å•†çš„äº‘ç›˜ã€æ–‡ä»¶å­˜å‚¨NASã€å—å­˜å‚¨ç­‰å­˜å‚¨æ–¹æ¡ˆï¼ŒåŸºäºæ ‡å‡†çš„&lt;a href="https://github.com/kubernetes/community/blob/master/contributors/devel/flexvolume.md">FlexVolume&lt;/a>é©±åŠ¨ï¼Œæä¾›äº†æœ€ä½³çš„æ— ç¼é›†æˆã€‚&lt;/p>
&lt;p>å¦‚æœæ˜¯åœ¨äº‘å‚å•†çš„è™šæ‹Ÿæœºä¸Šè‡ªå»º&lt;a href="https://kubernetes.io/">Kubernetes&lt;/a>é›†ç¾¤ï¼Œé»˜è®¤æ— æ³•ä½¿ç”¨äº‘ä¸Šçš„å­˜å‚¨èµ„æºã€‚å¦‚æœéœ€è¦åˆ©ç”¨äº‘å‚å•†æä¾›çš„å­˜å‚¨æ–¹æ¡ˆï¼Œä¾‹å¦‚å¯¹è±¡å­˜å‚¨ï¼Œå°±éœ€è¦è‡ªè¡Œå¼€å‘åŸºäº&lt;a href="https://github.com/kubernetes/community/blob/master/contributors/devel/flexvolume.md">FlexVolume&lt;/a>çš„é©±åŠ¨ã€‚åœ¨å‚å•†æ‰˜ç®¡K8Så·²ç»å®Œç¾è§£å†³äº†å­˜å‚¨é›†æˆçš„é—®é¢˜ï¼Œä½•å¿…è‡ªå·±åˆå»è´¹æ—¶è´¹åŠ›çš„å®šåˆ¶å¼€å‘å‘¢ï¼Ÿ&lt;/p>
&lt;p>å¯ä»¥çœ‹åˆ°ï¼Œäº‘å‚å•†æ‰˜ç®¡çš„K8Sé›†ç¾¤åœ¨ç½‘ç»œã€è´Ÿè½½å‡è¡¡å’Œå­˜å‚¨ä¸Šæœ‰è®¸å¤šå¤©ç„¶çš„ä¼˜åŠ¿ã€‚åœ¨å…¶ä»–å‡ ä¸ªç»´åº¦ï¼Œæ‰˜ç®¡çš„K8Sé›†ç¾¤åŒæ ·ä¹Ÿä¼˜äºè‡ªå»ºçš„K8Sï¼Œ&lt;/p>
&lt;h4 id="è¿ç»´">è¿ç»´&lt;/h4>
&lt;ul>
&lt;li>é›†æˆå‚å•†çš„æ—¥å¿—æœåŠ¡ï¼Œç›‘æ§æœåŠ¡ã€‚&lt;/li>
&lt;li>K8Sé›†ç¾¤cluster autoscalerè‡ªåŠ¨åˆ©ç”¨äº‘å‚å•†çš„å¼¹æ€§ä¼¸ç¼©æ‰©ç¼©å®¹é›†ç¾¤èŠ‚ç‚¹ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="é•œåƒä»“åº“">é•œåƒä»“åº“&lt;/h4>
&lt;ul>
&lt;li>é«˜å¯ç”¨ï¼Œæ”¯æŒå¤§å¹¶å‘ã€‚&lt;/li>
&lt;li>æ”¯æŒé•œåƒåŠ é€Ÿã€‚&lt;/li>
&lt;li>æ”¯æŒ p2p åˆ†å‘ã€‚&lt;/li>
&lt;li>å¯é›†æˆäº‘å¹³å°çš„ç”¨æˆ·æƒé™ã€‚&lt;/li>
&lt;li>éƒ¨åˆ†å‚å•†ç›®å‰å…è´¹ä¸”ä¸é™å®¹é‡ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="é«˜å¯ç”¨">é«˜å¯ç”¨&lt;/h4>
&lt;ul>
&lt;li>æä¾›å¤šå¯ç”¨åŒºæ”¯æŒã€‚&lt;/li>
&lt;li>æ”¯æŒå¤‡ä»½å’Œå®¹ç¾ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="æŠ€æœ¯æ”¯æŒ">æŠ€æœ¯æ”¯æŒ&lt;/h4>
&lt;ul>
&lt;li>ä¸“é—¨çš„æŠ€æœ¯å›¢é˜Ÿä¿éšœå®¹å™¨çš„ç¨³å®šæ€§ã€‚&lt;/li>
&lt;li>æ¯ä¸ª Linux ç‰ˆæœ¬ï¼Œæ¯ä¸ª Kubernetes ç‰ˆæœ¬éƒ½ä¼šåœ¨ç»è¿‡ä¸¥æ ¼æµ‹è¯•ä¹‹åä¹‹åæ‰ä¼šæä¾›ç»™ç”¨æˆ·ã€‚&lt;/li>
&lt;li>æä¾› Kubernetes å‡çº§èƒ½åŠ›ï¼Œæ–°ç‰ˆæœ¬ä¸€é”®å‡çº§ã€‚&lt;/li>
&lt;li>ä¸ºå¼€æºè½¯ä»¶æä¾›å…œåº•ï¼Œæ— è®ºæ˜¯K8Sã€Dockerç”šè‡³Linuxè‡ªèº«çš„é—®é¢˜æä¾›æ”¯æŒã€‚&lt;/li>
&lt;/ul>
&lt;p>ä¸“ä¸šçš„æŠ€æœ¯å›¢é˜Ÿæ˜¯æä¾›ç¨³å®šK8SæœåŠ¡å¿…ä¸å¯å°‘çš„ã€‚ä½†ç»å¤§å¤šæ•°ä¼ä¸šæ˜¯æ— æ³•åšåˆ°æœ‰ä¸“ä¸šçš„æŠ€æœ¯å›¢é˜Ÿæ¥ç»´æŠ¤K8Sã€æä¾›K8Sæˆ–å®¹å™¨æŠ€æœ¯è‡ªèº«çš„å„ç§æœ€ä½³å®è·µã€å‘ç°ä»¥åŠä¿®å¤å¼€æºè½¯ä»¶Bugã€‚&lt;/p>
&lt;p>åœ¨ç¬”è€…çš„ä½¿ç”¨æ‰˜ç®¡K8Sçš„æ—¶å€™å°±é‡åˆ°è¿™æ ·çš„çŠ¶å†µã€‚å…¶ä¸­ä¸€ä¸ªé›†ç¾¤å‡çº§åˆ°æ–°ç‰ˆæœ¬&lt;a href="https://kubernetes.io/">Kubernetes&lt;/a>åï¼Œå†…ç½®DNSç»„ä»¶ä»&lt;a href="https://github.com/kubernetes/dns">KubeDNS&lt;/a>è¢«æ›¿æ¢ä¸ºå…¨æ–°çš„&lt;a href="https://coredns.io/">CoreDNS&lt;/a>ï¼Œè€Œå½“æ—¶çš„&lt;a href="https://coredns.io/">CoreDNS&lt;/a>ç‰ˆæœ¬åœ¨&lt;a href="https://kubernetes.io/docs/concepts/services-networking/service/#externalname">Service ExternalName&lt;/a>æ”¯æŒä¸Šæœ‰Bugï¼Œå¯¼è‡´å·²æœ‰çš„è¿™ç§Serviceæ— æ³•æä¾›æœåŠ¡ã€‚åœ¨åŒäº‘å‚å•†çš„æŠ€æœ¯å›¢é˜Ÿæ²Ÿé€šåï¼Œå…ˆç”¨workaroundå°†é—®é¢˜å¿«é€Ÿç»•è¿‡ï¼Œä¸å½±å“ä¸šåŠ¡çš„ä½¿ç”¨ã€‚åŒæ—¶ï¼Œäº‘å‚å•†çš„æŠ€æœ¯äººå‘˜ï¼ˆä¹Ÿæ˜¯K8Sç¤¾åŒºcommitterï¼‰ç»§ç»­è°ƒç ”ï¼Œå‘ç°è¯¥é—®é¢˜æ˜¯&lt;a href="https://coredns.io/">CoreDNS&lt;/a>çš„Bugã€‚åœ¨ä¸ºå¼€æº&lt;a href="https://coredns.io/">CoreDNS&lt;/a>é¡¹ç›®åˆ›å»ºIssueåï¼ŒåŒæ—¶æä¾›Patchï¼Œåˆåœ¨CoreDNS committerå»ºè®®ä¸‹å®Œå–„äº†æµ‹è¯•ç”¨ä¾‹ï¼Œæ¨åŠ¨äº†è¯¥é—®é¢˜å¿«é€Ÿåœ¨CoreDNSä¸­è¢«ä¿®å¤ã€‚CoreDNSåŒ…å«Fixçš„ç‰ˆæœ¬å‘å¸ƒåï¼Œäº‘å‚å•†æŠ€æœ¯æ”¯æŒå›¢é˜Ÿå°†æ›´å®Œç¾çš„è§£å†³æ–¹æ¡ˆæä¾›ç»™äº†æˆ‘ä»¬ã€‚ä½œä¸ºK8SæœåŠ¡çš„ç”¨æˆ·ï¼Œè¿™ç§ä½“éªŒæ˜¯æå¥½çš„ã€‚å½“æ—¶æˆ‘ä»¬çš„æŠ€æœ¯å›¢é˜Ÿæ—¢æ²¡æœ‰ç²¾åŠ›ä¹Ÿæ²¡æœ‰èƒ½åŠ›å¿«é€Ÿå‘ç°å¹¶ä¿®å¤å¼€æºè½¯ä»¶ä¸­çš„è¿™ç±»é—®é¢˜ï¼Œè€Œäº‘å‚å•†çš„æœåŠ¡é—´æ¥å¸®æˆ‘ä»¬å®ç°äº†è¿™ç§èƒ½åŠ›ã€‚&lt;/p>
&lt;p>&lt;strong>è¿™å…¶å®æ˜¯ä¸€ç§éå¸¸å¥½çš„å…±èµ¢å•†ä¸šæ¨¡å¼ï¼Œäº‘å‚å•†æœ‰èƒ½åŠ›ä¸”æœ‰åŠ¨åŠ›æŠ•å…¥é¡¶å°–æŠ€æœ¯å›¢é˜Ÿå°†å¼€æºæŠ€æœ¯å•†ä¸šåŒ–ï¼Œäº‘å‚å•†çš„ç”¨æˆ·åˆ™ç”¨æœ€å°çš„ä»£ä»·è·å¾—äº†æœ€ä¼˜çš„åŸºç¡€æœåŠ¡æ¥ä¸ºæ ¸å¿ƒä¸šåŠ¡èµ‹èƒ½ã€‚&lt;/strong>&lt;/p></description></item><item><title>çœŸçš„ä¼šç”¨äº‘æœåŠ¡å—ï¼Ÿ</title><link>https://kane.mx/posts/effective-cloud-computing/preface/</link><pubDate>Mon, 07 Jan 2019 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/effective-cloud-computing/preface/</guid><description>&lt;p>è¿™æ˜¯â€œå¦‚ä½•é«˜æ•ˆä½¿ç”¨äº‘æœåŠ¡â€ç³»åˆ—æ–‡ç« çš„å¼•å­ã€‚è¯¥ç³»åˆ—å°†è®²è¿°å¦‚ä½•åˆ©ç”¨å„ç§å…¬æœ‰äº‘æœåŠ¡æ¥å®‰å…¨åˆè§„ã€é«˜è´¨é‡ã€å¿«é€Ÿã€ä½æˆæœ¬çš„æ‰“é€ äº§å“/ç³»ç»Ÿï¼Œå¸®åŠ©ä¼ä¸šï¼ˆç‰¹åˆ«æ˜¯ä¸­å°å¾®åˆ›ä¸šå›¢é˜Ÿï¼‰åœ¨äººå°‘ï¼Œé’±ç¼ºçš„æƒ…å†µä¸‹åšåˆ°æœ€é«˜æ•ˆç‡ã€‚&lt;/p>
&lt;h2 id="ä¸ªäººä½¿ç”¨å…¬æœ‰äº‘æœåŠ¡çš„ç»å†">ä¸ªäººä½¿ç”¨å…¬æœ‰äº‘æœåŠ¡çš„ç»å†&lt;/h2>
&lt;h3 id="åˆä¼š">åˆä¼š&lt;/h3>
&lt;p>æœ€æ—©æ˜¯2012å¹´åœ¨parttimeé¡¹ç›®ä¸­å¼€å§‹æ¥è§¦ä½¿ç”¨äº‘è®¡ç®—æœåŠ¡ï¼Œå½“æ—¶çš„åˆåˆ›å›¢é˜Ÿä¹Ÿæ˜¯å¸Œæœ›ç”¨æœ€ä½çš„æˆæœ¬æ¥éªŒè¯ideaï¼Œæ‰€æœ‰ä½¿ç”¨äº†äº‘æœåŠ¡æ¥åšPOCã€‚ç›®å‰å›½å†…å¸‚åœºæœ€é¢†å…ˆçš„äº‘è®¡ç®—å‚å•†&lt;a href="https://baike.baidu.com/item/%E9%98%BF%E9%87%8C%E4%BA%91#4">é˜¿é‡Œäº‘é‚£æ—¶ä¹Ÿæ‰æä¾›å…¬æœ‰äº‘æœåŠ¡ä¸åˆ°1å¹´&lt;/a>ã€‚ç”±äºäº‘äº§å“ä¸å¤Ÿæˆç†Ÿï¼ŒåŠ ä¸Šå›¢é˜ŸæŠ€èƒ½ç»éªŒä¸è¶³ï¼Œè‡ªåŠ©äº’åŠ©çš„æ¸ é“ä¸ç•…ï¼Œå¯¼è‡´æœ€åˆçš„äº‘è®¡ç®—ä½¿ç”¨ä½“éªŒå¹¶ä¸å¥½ï¼Œå›¢é˜Ÿæ²¡æœ‰é€‰æ‹©å®Œå…¨ä½¿ç”¨äº‘æœåŠ¡æ„å»ºäº§å“ã€‚&lt;/p>
&lt;h3 id="iaas-or-paas">IaaS or PaaS&lt;/h3>
&lt;p>äº‘è®¡ç®—å…´èµ·çš„æ—©æœŸï¼Œäº‘å‚å•†å¤§è‡´åˆ†ä¸ºä¸¤ç±»ï¼Œæä¾›åŸºäº&lt;a href="https://en.wikipedia.org/wiki/Infrastructure_as_a_service">IaaS&lt;/a>æˆ–&lt;a href="https://en.wikipedia.org/wiki/Platform_as_a_service">PaaS&lt;/a>çš„äº‘æœåŠ¡ã€‚2013å¹´èµ·ä¹Ÿæœ‰å°è¯•ä¸åŒç±»å‹çš„å‚å•†å¹³å°ï¼Œè™½ç„¶ä¹Ÿè¾ƒå¥½çš„å®Œæˆä¸€äº›ä½“é‡ä¸å¤§çš„é¡¹ç›®ï¼Œä½†è¦åœ¨ä»–ä»¬ä¸Šé¢æ„å»ºå¤§è§„æ¨¡ç”¨æˆ·äº§å“æˆ–ä¼ä¸šçº§åº”ç”¨ï¼Œåœ¨äº‘äº§å“å®Œå–„åº¦ä¸Šæˆ–æ”¯æŒå¼€å‘å›¢é˜Ÿåä½œä¸Šéƒ½æœ‰ä¸å°‘æ¬ ç¼ºï¼Œè¿˜æœ‰å¤§é‡çš„åŸºç¡€å·¥ä½œæˆ–é™åˆ¶ç•™ç»™äº†å¼€å‘å›¢é˜Ÿè‡ªèº«è§£å†³ã€‚&lt;/p>
&lt;h3 id="all-in-cloud">All-in Cloud&lt;/h3>
&lt;p>2015å¹´æˆ‘å¼€å§‹ä¸€ä¸ªå¾®ç”µå½±é¡¹ç›®åˆ›ä¸šï¼Œå›¢é˜Ÿæ˜¯ä¸åˆ°10äººçš„å¾®å‹å›¢é˜Ÿã€‚ä»æ•ˆç‡å’Œæˆæœ¬è€ƒè™‘ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰çš„æœåŠ¡éƒ½æ”¾åˆ°äº†é˜¿é‡Œäº‘ä¸Šã€‚æˆ‘ä»¬ä½¿ç”¨äº†å¤šç§äº‘äº§å“ï¼Œä¾‹å¦‚ï¼Œäº‘ä¸»æœºï¼ˆå¤šç§OSï¼‰ï¼Œå¯¹è±¡å­˜å‚¨ï¼Œå›¾ç‰‡å¤„ç†ï¼ŒCDNï¼ŒSLBï¼Œäººè„¸è¯†åˆ«ç­‰äº‘æœåŠ¡ï¼Œç»“åˆ&lt;a href="https://en.wikipedia.org/wiki/DevOps">Devops&lt;/a>é›†æˆå¼€å‘ï¼Œæµ‹è¯•ï¼Œéƒ¨ç½²pipelineæ¥åŠ é€Ÿäº§å“çš„è¿­ä»£å’Œæ›´æ–°ã€‚æ¯åå·¥ç¨‹å¸ˆæ‰¿æ‹…ä¸€ç§ä»¥ä¸Šè§’è‰²ï¼Œå‰ç«¯ï¼Œåç«¯ï¼Œè¿ç»´ï¼Œæ•°æ®ï¼Œè§†é¢‘æ¸²æŸ“ç­‰ã€‚åˆç†ä½¿ç”¨äº‘å‚å•†çš„å„ç§äº§å“å¸®æˆ‘ä»¬åœ¨è´¨é‡ï¼Œæ•ˆç‡ï¼Œæˆæœ¬ä¸Šè·å¾—å·¨å¤§çš„æ”¶ç›Šã€‚&lt;/p>
&lt;p>2017å¹´æˆ‘åŠ å…¥äº†ä¸€å®¶ä¼ä¸šè´¢ç¨æœåŠ¡çš„åˆåˆ›å…¬å¸è´Ÿè´£æŠ€æœ¯å›¢é˜Ÿã€‚å…¬å¸åœ¨2018å¹´è·å¾—äº†Bè½®æŠ•èµ„ï¼Œç ”å‘äº§å“è¿è¥å›¢é˜Ÿè¿‘ç™¾äººï¼Œå±äºä¸­ç­‰è§„æ¨¡ã€‚éšç€å„ç§å¼€æºæŠ€æœ¯çš„å·¨å¤§è¿›æ­¥å’Œå½±å“é€æ­¥æ‰©å¤§ï¼Œ&lt;a href="https://en.wikipedia.org/wiki/Microservices">å¾®æœåŠ¡&lt;/a>æ¶æ„çš„æµè¡Œï¼ŒåŸºäº&lt;a href="https://kubernetes.io/">Kubernetes&lt;/a>çš„&lt;a href="https://www.cncf.io/">Cloud Native Computing&lt;/a>å…´èµ·ã€‚æˆ‘ä»¬åˆ©ç”¨äº‘å‚å•†çš„å®¹å™¨æœåŠ¡ï¼Œ&lt;a href="https://en.wikipedia.org/wiki/Cloud_database">DBaaS&lt;/a>ï¼ŒBig Dataï¼ŒAIæŠ€æœ¯ç­‰ç”¨æœ€é«˜æ•ˆçš„æ–¹å¼å°†æ•°ä¸ªå•ä½“åº”ç”¨å¹³æ»‘å‡çº§åˆ°é«˜å¯ç”¨å¼¹æ€§çš„åˆ†å¸ƒå¼æ¶æ„ï¼Œæ›´å¥½çš„æ»¡è¶³å¤æ‚ä¸šåŠ¡çš„å¤šå˜éœ€æ±‚ï¼Œå…¬å¸æœåŠ¡ä¹Ÿåœ¨å…¨å›½300å¤šä¸ªåŸå¸‚è½åœ°ï¼ŒæœåŠ¡äº†æ•°åä¸‡ä¸­å°å¾®ä¼ä¸šå®¢æˆ·ã€‚åŒæ—¶åˆ©ç”¨äº‘å‚å•†çš„VPCï¼Œè®¿é—®æ§åˆ¶ï¼ŒWAFç­‰äº§å“è¿›è¡Œæƒé™æ§åˆ¶å’Œå®‰å…¨ä¿æŠ¤ï¼Œæœ‰æ•ˆé˜²èŒƒäº†å› ä¸ºå›¢é˜Ÿæ‰©å¤§ç®¡ç†éš¾åº¦å¢åŠ è€Œå‡ºç°å®‰å…¨é—®é¢˜ã€‚&lt;/p>
&lt;h2 id="ç¼˜èµ·">ç¼˜èµ·&lt;/h2>
&lt;p>ä½œä¸ºä¸€åäº‘è®¡ç®—æœåŠ¡6å¹´çš„ç”¨æˆ·ï¼Œè§è¯äº†å¼€æºæŠ€æœ¯çš„å¿«é€Ÿå‘å±•å’Œå½±å“åŠ›æ€¥å‰§æ‰©å¤§ï¼Œæ„Ÿå—åˆ°æ•´ä¸ªäº‘è®¡ç®—è¡Œä¸šå’Œå‚å•†çš„é•¿è¶³è¿›æ­¥ã€‚è§è¯äº†å›½å†…å¤´éƒ¨äº‘å‚å•†ä»æœ€åˆçš„ä½¿ç”¨éš¾åº¦é¢‡å¤§ï¼Œç°åœ¨æˆé•¿ä¸ºä¸‡ä¼—åˆ›ä¸šçš„é¦–é€‰æœåŠ¡å•†ã€‚&lt;/p>
&lt;p>è¿‡å»çš„ä¸€å¹´å‚åŠ äº†æ•°åœºæŠ€æœ¯ä¼šè®®ï¼Œå…¶ä¸­ä¸»é¢˜å¤§å¤šåå‘äºç”±çŸ¥åçš„äº’è”ç½‘æˆ–è¡Œä¸šå…¬å¸åˆ†äº«åœ¨æµ·é‡æ•°æ®ä¸‹çš„æŠ€æœ¯åº”ç”¨ã€‚è¿™äº›æŠ€æœ¯å¹¿æ³›æ¶‰åŠå¼€å‘è¯­è¨€ã€åº”ç”¨æ¶æ„ã€æ€§èƒ½ã€å¤§æ•°æ®ã€æœºå™¨å­¦ä¹ å’Œäººå·¥æ™ºèƒ½ç­‰é¢†åŸŸï¼Œæ— è®ºè¿™äº›å…¬å¸æ˜¯å¦é‡‡ç”¨å¼€æºäº§å“ï¼Œåœ¨å›¢é˜Ÿå•å…µæŠ€æœ¯èƒ½åŠ›ï¼Œä¸“ä¸šçš„åˆ†å·¥ï¼Œå¯¹å¼€æºé¡¹ç›®çš„ç ”å‘æŠ•å…¥åŠ›é‡ï¼Œè¿™äº›ç»éªŒå’Œæ–¹æ³•å¹¶ä¸æ˜¯ä¸­å°ä¼ä¸šå¯ä»¥è½»æ˜“å€Ÿé‰´çš„ã€‚è€Œäº‘è®¡ç®—å‚å•†å°†è¿™äº›é¢†åŸŸæœ€åŸºç¡€é€šç”¨çš„èƒ½åŠ›ä»¥äº§å“çš„æ–¹å¼è¾“å‡ºç»™ç”¨æˆ·ï¼Œä»¥æŒ‰ç”¨é‡çš„æ–¹å¼è®¡è´¹ï¼Œä½¿ç”¨æ›´ç®€å•ï¼Œæœ‰ä¸“ä¸šå›¢é˜Ÿç»´æŠ¤å’Œæ”¯æŒã€‚ä¸­å°å›¢é˜Ÿå°±åº”è¯¥å°†è¿™äº›äº‹æƒ…â€œå¤–åŒ…â€ç»™äº‘å‚å•†ï¼Œé›†ä¸­ç²¾åŠ›åˆ°ä¸šåŠ¡ä¸Šï¼Œå°†æœ€å¤§çš„ç ”å‘èµ„æºç”¨åˆ°æœ€æ ¸å¿ƒæœ€å…³é”®çš„åœ°æ–¹ã€‚&lt;/p>
&lt;p>æˆ‘åŒå›¢é˜ŸåŒäº‹æ²Ÿé€šä¸­ï¼Œå’Œå…¬å¸ç ”å‘å€™é€‰äººé¢è¯•äº¤æµä¸­ï¼Œå‘ç°è®¸å¤šä»ä¸šè€…å¯¹äº‘è®¡ç®—æœåŠ¡äº†è§£è¿˜ä¸å¤Ÿæ·±å…¥ã€‚è®¸å¤šäººç†è§£ä¸­çš„äº‘è®¡ç®—æœåŠ¡åªæœ‰äº‘æœåŠ¡å™¨ã€äº‘æ•°æ®åº“ç­‰å°‘æ•°äº§å“ï¼Œéœ€è¦è‡ªå·±å®‰è£…ç»´æŠ¤åº”ç”¨æœåŠ¡å™¨ã€è´Ÿè½½å‡è¡¡ã€æ”¶é›†æ—¥å¿—ç­‰ç­‰çœ‹èµ·æ¥æ¯ä¸ªåº”ç”¨éƒ½ç»•ä¸å¼€çš„äº‹æƒ…ã€‚ä»–ä»¬çš„è®¤çŸ¥è¿˜åœç•™åœ¨æ’æŸ¥åº”ç”¨å¼‚å¸¸è¿˜éœ€è¦è¿œç¨‹ç™»å½•æœåŠ¡å™¨çœ‹æ—¥å¿—ï¼Œåšä¸åˆ°åˆç†çš„æ ¹æ®åœºæ™¯é«˜æ•ˆç»„åˆä½¿ç”¨äº‘æœåŠ¡ï¼Œå°†äº‘æœåŠ¡å½“åšæ°´ç”µä¸€æ ·ï¼Œä½œä¸ºæœ€åŸºç¡€çš„èƒ½åŠ›åŠ é€Ÿä¸šåŠ¡çš„å‘å±•ã€‚ä¸šåŠ¡ä¸Šæ˜¯é‡‡ç”¨åæ°”å¤§ä¸”æˆç†Ÿçš„äº§å“ï¼Œå°è¯•æ–°é²œçœ‹èµ·æ¥é…·ä½†ä¸é‚£ä¹ˆå®Œå–„çš„äº§å“ï¼Œè¿˜æ˜¯äºŒæ¬¡å¼€å‘æˆ–è‡ªç ”å¼€å‘ï¼Ÿè¦åšå‡ºæœ€ä¼˜çš„é€‰æ‹©éœ€è¦å·¥ç¨‹å¸ˆèƒ½å¤Ÿä»æœ‰é«˜åº¦çš„å…¨å±€è§’åº¦æ¥è€ƒé‡ï¼Œç”šè‡³åœ¨çŸ­æ—¶é—´å†…èƒ½ç”¨POCé¡¹ç›®éªŒè¯å¤šä¸ªå¯é€‰çš„æ–¹æ¡ˆï¼ŒåŸºäºæ•°æ®åšå‡ºæœ€ç»ˆçš„é€‰æ‹©ã€‚&lt;/p>
&lt;p>è¿™å°±æ˜¯è¿™ä¸ªç³»åˆ—çš„ç¼˜èµ·ï¼Œä¹‹åæˆ‘å°†é™†ç»­åˆ†äº«ä½¿ç”¨é‚£äº›é«˜æ•ˆçš„äº‘æœåŠ¡äº§å“çš„åœºæ™¯ã€å¿ƒå¾—ã€ä½“ä¼šç­‰ç­‰ã€‚&lt;/p>
&lt;blockquote>
&lt;p>å°é¢å›¾ç‰‡&lt;a href="http://www.thebluediamondgallery.com/tablet/c/cloud-computing.html">Cloud Computing&lt;/a>å¼•ç”¨è‡ª&lt;a href="http://www.thebluediamondgallery.com/">The Blue Diamond Gallery&lt;/a> under &lt;a href="http://creativecommons.org/licenses/by-sa/3.0/">CC BY-SA 3.0&lt;/a>&lt;/p>
&lt;/blockquote></description></item><item><title>2018åŒ—äº¬ArchSummitå›é¡¾</title><link>https://kane.mx/posts/2018/2018-12-13-bj-archsummit-review/</link><pubDate>Thu, 13 Dec 2018 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2018/2018-12-13-bj-archsummit-review/</guid><description>&lt;p>ä¸Šå‘¨å‚åŠ äº†&lt;a href="https://bj2018.archsummit.com">ArchSummit(å…¨çƒæ¶æ„å¸ˆå³°ä¼š)&lt;/a>ï¼Œåœ¨è¿™é‡Œè®°å½•ä¸‹éƒ¨åˆ†å‚åŠ çš„ä¸»é¢˜ä»¥åŠä¸ªäººæ„Ÿå—ã€‚&lt;/p>
&lt;h3 id="ä¼šè®®å›é¡¾">ä¼šè®®å›é¡¾&lt;/h3>
&lt;p>ä»Šå¹´å‚åŠ äº†å‡ æ¬¡æŠ€æœ¯ä¼šè®®ï¼Œ&lt;code>å¾®æœåŠ¡&lt;/code>ã€&lt;code>å®¹å™¨æŠ€æœ¯&lt;/code>ã€&lt;code>åŒºå—é“¾&lt;/code>ã€&lt;code>å¤§æ•°æ®&lt;/code>ã€&lt;code>æœºå™¨å­¦ä¹ &lt;/code>ä»¥åŠ&lt;code>äººå·¥æ™ºèƒ½&lt;/code>éƒ½æ˜¯å½“ä¸‹æœ€çƒ­é—¨çš„ä¸»é¢˜ã€‚åŒæ ·è¿™æ¬¡ArchSummitç»å¤§éƒ¨åˆ†topicséƒ½è·Ÿè¿™äº›ä¸»é¢˜ç›¸å…³ã€‚&lt;/p>
&lt;p>è¿™æ¬¡ä¼šè®®ä¸»è¦å‚åŠ äº†ä¸¤ä¸ªä¸“åœºä¸»é¢˜ï¼Œ&lt;a href="https://bj2018.archsummit.com/track/440">Kubernetesçš„åº”ç”¨&lt;/a>å’Œ&lt;a href="https://bj2018.archsummit.com/track/446">å¿«æ‰‹ç§‘æŠ€æŠ€æœ¯ä¸“é¢˜&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;a href="https://bj2018.archsummit.com/presentation/928">åŸºäº Kubernetes çš„ DevOps&lt;/a>æ˜¯æ¥è‡ªå¾®è½¯Azureçš„å®¹å™¨å·¥ç¨‹å¸ˆåˆ†äº«å¦‚ä½•åŸºäº Kubernetes çš„ CI/CD è½åœ°å®è·µã€‚è¯¥åˆ†äº«ä¸­æåˆ°äº†CI/CDå„ä¸ªæ­¥éª¤ä¸­éƒ½æœ‰ä¼—å¤šçš„å·¥å…·æ”¯æŒï¼Œå¦‚ä½•é€‰æ‹©åˆé€‚Kubernetesçš„å·¥å…·å°†æŒç»­é›†æˆå’Œéƒ¨ç½²ä¸²è”åœ¨ä¸€èµ·æ˜¯Devopsä¸­çš„ä¸»è¦æŒ‘æˆ˜ã€‚åˆ†äº«è€…ä¹Ÿå®‰åˆ©äº†AKSæä¾›Devopså®Œæ•´çš„å·¥å…·é“¾ï¼Œä»¥åŠå°†å¼€æºå·¥å…·åŒAKSä¸­çš„æœåŠ¡é›†æˆå®ç°CI/CDçš„æœ€ä½³å®è·µã€‚&lt;/p>
&lt;p>æˆ‘ä»¬å™¼é‡Œå•ªå›¢é˜Ÿåœ¨CI/CDã€Devopsè¿™å—åšå¾—è¿˜ä¸é”™ã€‚CI/CD pipelinesæŒç»­å°†åº”ç”¨éƒ¨ç½²åœ¨è¿è¡Œçš„Kubernetesé›†ç¾¤ï¼Œè¿‡ç¨‹ä¸­ä½¿ç”¨çš„å·¥å…·é“¾åŸºæœ¬ä¹Ÿæ˜¯ç¤¾åŒºæˆ–CNCFæ¨èçš„ä¸»æµå·¥å…·ã€‚ä¸‹ä¸€æ­¥å¯ä»¥è€ƒè™‘åŒäº‘å‚å•†çš„Devopså·¥å…·é“¾é›†æˆï¼Œè¿›ä¸€æ­¥å‡å°‘ç»´æŠ¤æˆæœ¬ã€‚&lt;/p>
&lt;p>&lt;a href="https://bj2018.archsummit.com/presentation/1258">åŸºäºIstio on Kubernetesäº‘åŸç”Ÿåº”ç”¨çš„æœ€ä½³å®è·µ&lt;/a>æ¥è‡ªé˜¿é‡Œäº‘å®¹å™¨å·¥ç¨‹å¸ˆçš„åˆ†äº«ã€‚ä»–æ¦‚è¦çš„åˆ†äº«äº†IstioæŠ€æœ¯å’Œå®ç°åŸç†ã€‚å½“ç„¶ä¹Ÿå¤§åŠ›ä»‹ç»äº†é˜¿é‡Œäº‘å®¹å™¨æœåŠ¡å¯¹Istioçš„åŸç”Ÿæ”¯æŒï¼Œä»¥åŠé˜¿é‡Œäº‘å¯¹å®¢æˆ·ä½¿ç”¨Istioçš„æ”¯æŒï¼Œå³ä½¿å®¢æˆ·é—®é¢˜éå¸¸çš„åˆçº§ä»–ä»¬çš„æŠ€æœ¯æ”¯æŒä¹Ÿå¾ˆåˆ°ä½ã€‚&lt;/p>
&lt;p>Istioå¯ä»¥è¯´æ˜¯CNCFåœ¨Kubernetesä¸Šäº‹å®çš„æœåŠ¡æ²»ç†å®ç°ã€‚å™¼é‡Œå•ªæŠ€æœ¯å›¢é˜Ÿä¹Ÿä¸€ç›´åœ¨å…³æ³¨è¿™ä¸€å—ï¼Œæ­£åœ¨å°è¯•å¼•å…¥Istioæå‡æœåŠ¡çš„SLAã€‚&lt;/p>
&lt;p>å¿«æ‰‹æŠ€æœ¯å›¢é˜Ÿçš„4ä¸ªåˆ†äº«éƒ½æ˜¯å›´ç»•è§£å†³æ˜ç¡®çš„ä¸šåŠ¡é—®é¢˜è€Œåšå¾—æŠ€æœ¯å·¥ä½œï¼Œéå¸¸å…·æœ‰å®æˆ˜æ€§ã€‚å…¶ä¸­&lt;a href="https://bj2018.archsummit.com/presentation/1337">å¿«æ‰‹ä¸‡äº¿çº§å®æ—¶ OLAP å¹³å°çš„å»ºè®¾ä¸å®è·µ&lt;/a>ä»‹ç»äº†å¿«æ‰‹å®æ—¶OLAPå¹³å°ä»0åˆ°1çš„æ­å»ºè¿‡ç¨‹ã€‚è¯¥å¹³å°ä»ä»Šå¹´4æœˆå¼€å§‹æ­å»ºï¼Œæˆªæ­¢åˆ°11æœˆï¼Œæ¯æ—¥å¯ä»¥å®æ—¶è®¡ç®—å¤„ç†è¶…è¿‡ä¸‡äº¿çš„æ•°æ®ã€‚è€Œæ•´ä¸ªå¹³å°çš„æ­å»ºç”±ä¸¤åå¤§æ•°æ®å·¥ç¨‹å¸ˆå¤–åŠ ä¸€åå‰ç«¯å·¥ç¨‹å¸ˆè´Ÿè´£portalç­‰UIï¼Œäººæ•ˆäº§å‡ºè®©äººéå¸¸ä½©æœã€‚ç»“åˆæœ‹å‹é—´ä¼ è¨€å¿«æ‰‹ç»™æŠ€æœ¯äººå‘˜çš„offerï¼Œå¿«æ‰‹åº”è¯¥æ˜¯ä¸€å®¶åœ¨å®è·µç±»ä¼¼Netflixç®¡ç†æ–‡åŒ–çš„å…¬å¸ã€‚&lt;/p>
&lt;p>æœ€åç»™å¤§å®¶æ¨èä¸€ä¸ªå›½äº§çš„åˆ†å¸ƒå¼New SQLæ•°æ®åº“TiDBç›¸å…³çš„ä¸»é¢˜ã€‚TiDBæ˜¯å›½å†…æŠ€æœ¯å›¢é˜Ÿå¼€æºçš„ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“ï¼Œå·²è¢«CNCFä½œä¸ºDatabaseå®ç°æ¨èæ–¹æ¡ˆä¹‹ä¸€ã€‚ä»–ä»¬çš„CTOåˆ†äº«äº†&lt;a href="https://bj2018.archsummit.com/presentation/1331">TiDB on Kubernetes æœ€ä½³å®è·µ&lt;/a>ï¼Œä»¥åŠä»–ä»¬å®¢æˆ·åŒ—äº¬é“¶è¡Œåœ¨&lt;a href="https://bj2018.archsummit.com/presentation/962">ä¸¤åœ°å¤šæ´»çš„æ ¸å¿ƒç³»ç»Ÿ&lt;/a>ä¸­é‡‡ç”¨çš„æ•°æ®åº“å°±æ˜¯TiDBã€‚&lt;/p>
&lt;h3 id="ä¸ªäººæ„Ÿå—">ä¸ªäººæ„Ÿå—&lt;/h3>
&lt;p>ä¼šè®®çš„åˆ†äº«è€…å¤§å¤šæ¥è‡ªå›½å†…ä¸€çº¿çš„äº’è”ç½‘å…¬å¸ï¼Œä»–ä»¬æ™®éå…·å¤‡æµé‡å¤§ã€æ•°æ®å¤šã€æŠ€æœ¯å›¢é˜Ÿèƒ½åŠ›æ›´å¼ºç­‰ç‰¹è´¨ã€‚å¹¶ä¸”å¾ˆå°‘ä½¿ç”¨å…¬æœ‰äº‘æœåŠ¡ï¼Œä½¿ç”¨å¼€æºäº§å“å¤šæ•°ä¹Ÿä¼šç»´æŠ¤ç§æœ‰ç‰ˆæœ¬ã€‚ä»–ä»¬çš„ä¸šåŠ¡è§£å†³æ–¹æ¡ˆå¯¹ä¸­å°å‹æŠ€æœ¯å›¢é˜Ÿæ¥è¯´å¯å¤åˆ¶æ€§ä¸å¼ºï¼Œç…§æ¬å®æ–½çš„éš¾åº¦é«˜ï¼Œæ›´å¤šçš„æ˜¯åœ¨æ‰©å±•æ€è·¯äº†è§£ä¸šç•ŒæŠ€æœ¯åŠ¨æ€ã€‚ä¸­å°å‹æŠ€æœ¯å›¢é˜Ÿæœ€ç´§è¿«çš„äº‹æƒ…æ˜¯æ»¡è¶³ä¸šåŠ¡å¿«é€Ÿå‘å±•å’Œéœ€æ±‚å¤šå˜ï¼Œæ›´åˆç†çš„è§£æ³•æ˜¯é€‰ç”¨äº‘å‚å•†çš„æœåŠ¡æˆ–ç¬¬ä¸‰æ–¹æœåŠ¡å¿«é€Ÿé«˜æ•ˆçš„æ»¡è¶³ä¸šåŠ¡éœ€æ±‚ã€‚æå®¢é‚¦æ——ä¸‹çš„ä¼šè®®å¤§å¤šç¼ºå°‘è¿™ç±»çš„åˆ†äº«ï¼Œç›¸æ¯”ä¹‹ä¸‹AWSçš„reInventå¤§ä¼šåœ¨è¿™æ–¹é¢åšå¾—æ›´å¥½ã€‚&lt;/p></description></item><item><title>å¦‚ä½•ä¿®å¤Jenkins CIæ— æ³•è¯»å–å­˜åœ¨çš„ä»»åŠ¡é…ç½®</title><link>https://kane.mx/posts/2016/how-to-fix-jenkins-fail-to-load-job-config/</link><pubDate>Wed, 12 Oct 2016 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2016/how-to-fix-jenkins-fail-to-load-job-config/</guid><description>&lt;p>&lt;a href="https://vme360.com">Vç§˜&lt;/a>å¼€å‘å›¢é˜Ÿä¸€ç›´ä½¿ç”¨ç€&lt;a href="https://jenkins.io/">Jenkins CI&lt;/a>æ¥æŒç»­é›†æˆ&lt;a href="https://vme360.com">Vç§˜&lt;/a>æœåŠ¡çš„æ–°åŠŸèƒ½å’Œå„ç§æ”¹è¿›ã€‚è¿‘æ—¥ï¼Œ&lt;a href="https://jenkins.io/">Jenkins CI&lt;/a>åœ¨é‡å¯ä¹‹åï¼Œå¾ˆå¤šå·²æœ‰ä»»åŠ¡çš„é…ç½®æ— æ³•è¢«&lt;a href="https://jenkins.io/">Jenkins CI&lt;/a>å®Œæ•´çš„åŠ è½½ï¼Œå¯¼è‡´å¾ˆå¤šåŠŸèƒ½æ— æ³•ä½¿ç”¨ã€‚å¯¼è‡´æˆ‘ä»¬æ•´ä¸ªç½‘ç«™çš„å„ç§æœåŠ¡æ— æ³•è¢«å‡çº§æ›´æ–°äº†:-(&lt;/p>
&lt;p>&lt;a href="https://jenkins.io/">Jenkins CI&lt;/a>åœ¨ç®¡ç†æ§åˆ¶å°åˆ—å‡ºå¦‚ä¸‹çš„é”™è¯¯ä¿¡æ¯ï¼Œç¤ºæ„ç°æœ‰ä»»åŠ¡çš„éƒ¨åˆ†é…ç½®ç”±äºé”™è¯¯æ— æ³•åŠ è½½ã€‚&lt;/p>
&lt;pre>&lt;code>CannotResolveClassException: hudson.plugins.git.GitSCM,
CannotResolveClassException: com.cloudbees.jenkins.plugins.BitBucketTrigger,
CannotResolveClassException: hudson.plugins.emailext.ExtendedEmailPublisher,
CannotResolveClassException: hudson.plugins.parameterizedtrigger.BuildTrigger
&lt;/code>&lt;/pre>
&lt;p>é€šè¿‡ä¸Šé¢çš„é”™è¯¯ä¿¡æ¯ï¼Œæˆ‘ä»¬åˆæ­¥è®¤ä¸ºé”™è¯¯æ˜¯ç”±äºæ’ä»¶æ— æ³•è¢«&lt;a href="https://jenkins.io/">Jenkins CI&lt;/a>åŠ è½½ã€‚ä½†æ˜¯é€šè¿‡&lt;a href="https://jenkins.io/">Jenkins CI&lt;/a>çš„æ’ä»¶ç®¡ç†åˆ—è¡¨ï¼Œæˆ‘ä»¬å‘ç°&lt;strong>Git&lt;/strong>æ’ä»¶å·²ç»è¢«è®¤ä¸ºæ˜¯å®‰è£…çš„äº†ã€‚åŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨&lt;a href="https://jenkins.io/">Jenkins CI&lt;/a>å®‰è£…ç›®å½•ä¸­æ‰¾åˆ°æ’ä»¶å¯¹åº”çš„æ–‡ä»¶&lt;code>git.jar&lt;/code>ï¼Œå¹¶ä¸”æˆåŠŸéªŒè¯äº†ç±»&lt;code>hudson.plugins.git.GitSCM&lt;/code>ä¹Ÿæ˜¯å­˜åœ¨åœ¨jaræ–‡ä»¶é‡Œé¢çš„ã€‚é‡æ–°å®‰è£…&lt;code>Git client&lt;/code>æ’ä»¶ä¹Ÿä¸èƒ½è§£å†³è¿™ä¸ªé”™è¯¯ï¼&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;p>ç»è¿‡è¿›ä¸€æ­¥çš„åˆ†æï¼Œé€šè¿‡&lt;a href="https://jenkins.io/">Jenkins CI&lt;/a>çš„ç³»ç»Ÿæ—¥å¿—ï¼Œæˆ‘ä»¬å‘ç°&lt;code>Gitæ’ä»¶&lt;/code>è™½ç„¶æ˜¯æˆåŠŸå®‰è£…äº†ï¼Œä½†æ˜¯å®ƒæ‰€ä¾èµ–çš„æŸäº›æ’ä»¶æ²¡æœ‰è¢«å®‰è£…ï¼è¿™å¯¼è‡´&lt;a href="https://jenkins.io/">Jenkins CI&lt;/a>æ— æ³•æ­£ç¡®åŠ è½½&lt;code>Gitæ’ä»¶&lt;/code>ã€‚é€šè¿‡æ—¥å¿—çš„æç¤ºï¼Œå°†ç¼ºå¤±çš„æ’ä»¶ä¸€ä¸€å®‰è£…ä¸Šï¼Œé‡å¯&lt;a href="https://jenkins.io/">Jenkins CI&lt;/a>åï¼Œæ’ä»¶åŠ è½½æ­£å¸¸ï¼Œä»»åŠ¡æ‰§è¡Œä¹Ÿæ¢å¤æ­£å¸¸ã€‚&lt;/p>
&lt;p>è¿™ä¸ªé”™è¯¯å‡ºç°çš„è¿˜æ˜¯ç›¸å½“å¥‡æ€ªã€‚å› ä¸º&lt;a href="https://jenkins.io/">Jenkins CI&lt;/a>ä¼šåœ¨å®‰è£…æ’ä»¶çš„æ—¶å€™å°†ä¾èµ–çš„æ’ä»¶ä¸€å¹¶å®‰è£…ä¸Šã€‚æ­¤å¤–è¯¥&lt;a href="https://jenkins.io/">Jenkins CI&lt;/a>å·²ç»è¿è¡Œå¾ˆä¹…äº†ï¼Œè¿™äº›æ’ä»¶ä¹Ÿæ˜¯ä¸€ç›´å®‰è£…ç€çš„ã€‚ä¸è¿‡ç°åœ¨å›æƒ³èµ·ä¹‹å‰å‡çº§&lt;a href="https://jenkins.io/">Jenkins CI&lt;/a>æ’ä»¶çš„æ—¶å€™ï¼Œéƒ¨åˆ†æ’ä»¶ç”±äºç½‘ç»œåŸå› å‡çº§å¤±è´¥äº†ï¼Œä½†æ˜¯æ²¡æœ‰é‡æ–°æ›´æ–°ã€‚è¿™å¯¼è‡´è¿™äº›æ’ä»¶å¤„åœ¨äº†ä¸€ä¸ªä¸æ­£ç¡®çš„çŠ¶æ€ã€‚åœ¨é‡å¯&lt;a href="https://jenkins.io/">Jenkins CI&lt;/a>åï¼Œè¿™äº›æ’ä»¶è¢«æ ‡è®°ä¸ºæœªå®‰è£…ï¼Œå¯¼è‡´ä¾èµ–å®ƒä»¬çš„æ’ä»¶æ— æ³•åŠ è½½ã€‚&lt;/p></description></item><item><title>MongoDBä¸­å¦‚ä½•æ‰¾å‡ºæ…¢æŸ¥è¯¢</title><link>https://kane.mx/posts/2016/how-to-find-slow-queries-in-mongodb/</link><pubDate>Thu, 29 Sep 2016 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2016/how-to-find-slow-queries-in-mongodb/</guid><description>&lt;p>&lt;a href="https://www.mongodb.com/">MongoDB&lt;/a>æ˜¯ç›®å‰æœ€ä¸ºæµè¡Œçš„&lt;a href="https://en.wikipedia.org/wiki/NoSQL">NoSQL&lt;/a>æ•°æ®åº“ä¹‹ä¸€ã€‚&lt;a href="https://vme360.com">Vç§˜&lt;/a>çš„åå°æ•°æ®å°±æ˜¯ä¿å­˜åœ¨&lt;a href="https://www.mongodb.com/">MongoDB&lt;/a>ä¸­çš„å“¦;)&lt;/p>
&lt;p>å°½ç®¡&lt;a href="https://www.mongodb.com/">MongoDB&lt;/a>çš„æ€§èƒ½ä¸ºä¸šç•Œç§°é“ï¼Œä½†ä»»ä½•æ•°æ®åº“ç³»ç»Ÿä½¿ç”¨ä¸­éƒ½å­˜åœ¨ç€æ…¢æŸ¥è¯¢çš„é—®é¢˜ã€‚æ…¢æŸ¥è¯¢çš„æ€§èƒ½é—®é¢˜ï¼Œå¯èƒ½æ˜¯ç”±äºä½¿ç”¨éæœ€ä¼˜çš„æŸ¥è¯¢è¯­å¥ï¼Œä¸æ­£ç¡®çš„ç´¢å¼•æˆ–å…¶ä»–é…ç½®åŸå› å¯¼è‡´çš„ã€‚ä½†å¼€å‘äººå‘˜æˆ–æ•°æ®åº“ç»´æŠ¤äººå‘˜é¦–å…ˆè¦æ‰¾å‡ºè¿™äº›ä½æ•ˆçš„æŸ¥è¯¢ï¼Œæ‰èƒ½åšå‡ºå¯¹åº”çš„æŸ¥è¯¢ä¼˜åŒ–ã€‚&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;p>åœ¨&lt;a href="https://www.mongodb.com/">MongoDB&lt;/a>ä¸­å®ç°æ…¢æŸ¥è¯¢çš„profileæ˜¯éå¸¸å®¹æ˜“ï¼Œå› ä¸º&lt;a href="https://www.mongodb.com/">MongoDB&lt;/a>å†…ç½®äº†&lt;a href="https://docs.mongodb.com/manual/reference/method/db.setProfilingLevel/">profileå¼€å…³&lt;/a>æ¥è®°å½•æ‰§è¡Œæ—¶é—´è§¦å‘äº†profileæ¡ä»¶çš„æŸ¥è¯¢ã€‚&lt;/p>
&lt;p>å‚ç…§&lt;a href="https://docs.mongodb.com/manual/reference/method/db.setProfilingLevel/">db.setProfileLevel()&lt;/a>çš„æ–‡æ¡£ï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤å°±å¯ä»¥è®°å½•æ‰§è¡Œæ—¶é•¿è¶…è¿‡&lt;strong>300ms&lt;/strong>çš„æŸ¥è¯¢ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="color:#a6e22e">db&lt;/span>.&lt;span style="color:#a6e22e">setProfilingLevel&lt;/span>(&lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#ae81ff">300&lt;/span>)
&lt;/code>&lt;/pre>&lt;/div>
&lt;p>å½“æ…¢æŸ¥è¯¢è¢«é‡ç°åï¼Œå¯ä»¥é€šè¿‡æŸ¥æ‰¾&lt;code>system.profile&lt;/code> collectionæ¥æŸ¥çœ‹æ‰§è¡Œæ—¶é•¿è¶…è¿‡&lt;strong>300ms&lt;/strong>çš„æŸ¥è¯¢ã€‚&lt;/p>
&lt;p>è¢«profilerè®°å½•ä¸‹æ¥æ…¢æŸ¥è¯¢recordçœ‹èµ·æ¥å¦‚ä¸‹ï¼Œ&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-json" data-lang="json">{
&lt;span style="color:#f92672">&amp;#34;op&amp;#34;&lt;/span> : &lt;span style="color:#e6db74">&amp;#34;query&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;ns&amp;#34;&lt;/span> : &lt;span style="color:#e6db74">&amp;#34;myCollection&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;query&amp;#34;&lt;/span> : {
&lt;span style="color:#f92672">&amp;#34;builds&amp;#34;&lt;/span> : {
&lt;span style="color:#f92672">&amp;#34;$elemMatch&amp;#34;&lt;/span> : {
&lt;span style="color:#f92672">&amp;#34;builtTime&amp;#34;&lt;/span> : &lt;span style="color:#66d9ef">null&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;$and&amp;#34;&lt;/span> : [
{
&lt;span style="color:#f92672">&amp;#34;createdTime&amp;#34;&lt;/span> : {
&lt;span style="color:#f92672">&amp;#34;$lt&amp;#34;&lt;/span> : &lt;span style="color:#960050;background-color:#1e0010">ISODate(&lt;/span>&lt;span style="color:#e6db74">&amp;#34;2016-09-20T20:07:00.796Z&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">)&lt;/span>
}
}
]
}
}
},
&lt;span style="color:#f92672">&amp;#34;ntoreturn&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">0&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;ntoskip&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">0&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;nscanned&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">0&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;nscannedObjects&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">18231&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;keyUpdates&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">0&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;writeConflicts&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">0&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;numYield&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">577&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;locks&amp;#34;&lt;/span> : {
&lt;span style="color:#f92672">&amp;#34;Global&amp;#34;&lt;/span> : {
&lt;span style="color:#f92672">&amp;#34;acquireCount&amp;#34;&lt;/span> : {
&lt;span style="color:#f92672">&amp;#34;r&amp;#34;&lt;/span> : &lt;span style="color:#960050;background-color:#1e0010">NumberLong(&lt;/span>&lt;span style="color:#ae81ff">1156&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">)&lt;/span>
}
},
&lt;span style="color:#f92672">&amp;#34;Database&amp;#34;&lt;/span> : {
&lt;span style="color:#f92672">&amp;#34;acquireCount&amp;#34;&lt;/span> : {
&lt;span style="color:#f92672">&amp;#34;r&amp;#34;&lt;/span> : &lt;span style="color:#960050;background-color:#1e0010">NumberLong(&lt;/span>&lt;span style="color:#ae81ff">578&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">)&lt;/span>
}
},
&lt;span style="color:#f92672">&amp;#34;Collection&amp;#34;&lt;/span> : {
&lt;span style="color:#f92672">&amp;#34;acquireCount&amp;#34;&lt;/span> : {
&lt;span style="color:#f92672">&amp;#34;r&amp;#34;&lt;/span> : &lt;span style="color:#960050;background-color:#1e0010">NumberLong(&lt;/span>&lt;span style="color:#ae81ff">578&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">)&lt;/span>
}
}
},
&lt;span style="color:#f92672">&amp;#34;nreturned&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">2&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;responseLength&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">98076&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;millis&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">11161&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;execStats&amp;#34;&lt;/span> : {
&lt;span style="color:#f92672">&amp;#34;stage&amp;#34;&lt;/span> : &lt;span style="color:#e6db74">&amp;#34;COLLSCAN&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;filter&amp;#34;&lt;/span> : {
&lt;span style="color:#f92672">&amp;#34;builds&amp;#34;&lt;/span> : {
&lt;span style="color:#f92672">&amp;#34;$elemMatch&amp;#34;&lt;/span> : {
&lt;span style="color:#f92672">&amp;#34;$and&amp;#34;&lt;/span> : [
{
&lt;span style="color:#f92672">&amp;#34;$and&amp;#34;&lt;/span> : [
{
&lt;span style="color:#f92672">&amp;#34;createdTime&amp;#34;&lt;/span> : {
&lt;span style="color:#f92672">&amp;#34;$lt&amp;#34;&lt;/span> : &lt;span style="color:#960050;background-color:#1e0010">ISODate(&lt;/span>&lt;span style="color:#e6db74">&amp;#34;2016-09-20T20:07:00.796Z&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">)&lt;/span>
}
}
]
},
{
&lt;span style="color:#f92672">&amp;#34;builtTime&amp;#34;&lt;/span> : {
&lt;span style="color:#f92672">&amp;#34;$eq&amp;#34;&lt;/span> : &lt;span style="color:#66d9ef">null&lt;/span>
}
}
]
}
}
},
&lt;span style="color:#f92672">&amp;#34;nReturned&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">2&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;executionTimeMillisEstimate&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">11080&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;works&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">18233&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;advanced&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">2&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;needTime&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">18230&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;needFetch&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">0&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;saveState&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">577&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;restoreState&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">577&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;isEOF&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">1&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;invalidates&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">0&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;direction&amp;#34;&lt;/span> : &lt;span style="color:#e6db74">&amp;#34;forward&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;docsExamined&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">18231&lt;/span>
},
&lt;span style="color:#f92672">&amp;#34;ts&amp;#34;&lt;/span> : &lt;span style="color:#960050;background-color:#1e0010">ISODate(&lt;/span>&lt;span style="color:#e6db74">&amp;#34;2016-09-20T23:07:14.313Z&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">)&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;client&amp;#34;&lt;/span> : &lt;span style="color:#e6db74">&amp;#34;10.171.127.66&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;allUsers&amp;#34;&lt;/span> : [
{
&lt;span style="color:#f92672">&amp;#34;user&amp;#34;&lt;/span> : &lt;span style="color:#e6db74">&amp;#34;dbuser&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;db&amp;#34;&lt;/span> : &lt;span style="color:#e6db74">&amp;#34;mydb&amp;#34;&lt;/span>
}
],
&lt;span style="color:#f92672">&amp;#34;user&amp;#34;&lt;/span> : &lt;span style="color:#e6db74">&amp;#34;dbuser@mydb&amp;#34;&lt;/span>
} &lt;/code>&lt;/pre>&lt;/div>
&lt;p>ä¸Šé¢çš„æ•°æ®å…·ä½“è§£è¯»å¦‚ä¸‹ï¼Œ&lt;/p>
&lt;ol>
&lt;li>&lt;code>op: 'query'&lt;/code>è¡¨ç¤ºæ‰§è¡Œçš„æ˜¯æŸ¥è¯¢ï¼Œ&lt;/li>
&lt;li>&lt;code>ns&lt;/code>æ˜¯æŒ‡æŸ¥è¯¢çš„collectionï¼Œ&lt;/li>
&lt;li>&lt;code>query&lt;/code>æ˜¯å…·ä½“çš„æŸ¥è¯¢è¯­å¥ï¼Œ&lt;/li>
&lt;li>æ ¸å¿ƒéƒ¨åˆ†æ˜¯&lt;code>execStats&lt;/code>ï¼Œç»™å‡ºäº†çš„æŸ¥è¯¢è¯­å¥å…·ä½“æ‰§è¡Œç»Ÿè®¡ï¼Œè·Ÿ**.explain(&amp;lsquo;execStats&amp;rsquo;)**çš„å†…å®¹æ˜¯ä¸€è‡´çš„ã€‚ä¸Šé¢çš„ç»Ÿè®¡æ˜¯è¯´ï¼Œè¿™ä¸ªqueryæ‰§è¡Œäº†æ•´ä¸ªcollectionçš„æ‰«æ(æ€»è®¡æ‰«æäº†18231ä¸ªæ–‡æ¡£)ï¼Œæœ€ç»ˆè¿”å›äº†2æ¡æ–‡æ¡£ï¼ŒèŠ±è´¹äº†11080msï¼Œä¹Ÿå°±æ˜¯11sè¿˜å¤šçš„æ—¶é—´ï¼è¿™è¡¨æ˜è¢«è®°å½•ä¸‹çš„æ…¢æŸ¥è¯¢è·Ÿcollectionçš„ç´¢å¼•è®¾ç½®æœ‰é—®é¢˜ï¼Œè¯¥æŸ¥è¯¢æ²¡æœ‰ç”¨ä¸Šç´¢å¼•ã€‚è§£å†³æ–¹æ¡ˆå¾ˆç®€å•ï¼Œæ”¹å–„æŸ¥è¯¢è¯­å¥ä½¿ç”¨å­˜åœ¨çš„ç´¢å¼•æˆ–è€…è®¾ç½®åˆç†çš„ç´¢å¼•ã€‚&lt;/li>
&lt;li>&lt;code>ts&lt;/code>æ˜¯æŸ¥è¯¢å¼€å§‹è¯·æ±‚çš„æ—¶é—´ï¼Œ&lt;/li>
&lt;li>&lt;code>allUsers&lt;/code>å’Œ&lt;code>user&lt;/code>éƒ½æ˜¯MongoDB clientè¿æ¥æ‰€ä½¿ç”¨çš„ç”¨æˆ·ã€‚&lt;/li>
&lt;/ol></description></item><item><title>Docker Swarm mode(v1.12.x)çš„ä¸€äº›ä½¿ç”¨é™åˆ¶</title><link>https://kane.mx/posts/2016/the-limitations-docker-swarm-mode-v1.12/</link><pubDate>Tue, 20 Sep 2016 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2016/the-limitations-docker-swarm-mode-v1.12/</guid><description>&lt;p>&lt;a href="https://docs.docker.com/engine/swarm/">Swarm mode&lt;/a>åœ¨&lt;a href="https://www.docker.com">Docker&lt;/a> v1.12ä¸­æ­£å¼å‘å¸ƒï¼Œ&lt;a href="https://docs.docker.com/engine/swarm/">Swarm mode&lt;/a>å¸¦æ¥äº†è¯¸å¦‚Dockeré›†ç¾¤ï¼Œå®¹å™¨ç¼–æ’ï¼Œå¤šä¸»æœºç½‘ç»œç­‰æ¿€åŠ¨äººå¿ƒçš„ç‰¹æ€§ã€‚&lt;a href="https://vme360.com">Vç§˜&lt;/a>å›¢é˜Ÿä¹Ÿå°è¯•ç€å°†å„ç§åå°æœåŠ¡éƒ¨ç½²åˆ°&lt;a href="https://docs.docker.com/engine/swarm/">Docker Swarm Cluster&lt;/a>è·å–æ›´å¥½çš„å¼¹æ€§è®¡ç®—èƒ½åŠ›ã€‚&lt;/p>
&lt;p>&lt;a href="https://www.docker.com">Docker v1.12&lt;/a>ä¸­æ­£å¼å‘å¸ƒçš„&lt;a href="https://docs.docker.com/engine/swarm/">Docker Swarm&lt;/a>åœ¨æˆ‘ä»¬å®ç”¨ä¸­å‘ç°ä»æœ‰ä¸å°‘ä¸è¶³ä¹‹å¤„ï¼Œè®©æˆ‘ä»¬ä¸€ä¸€åˆ†äº«ç»™å¤§å®¶ã€‚&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;ol>
&lt;li>æ— æ³•å°†æœåŠ¡çš„publishedç«¯å£åªç»‘å®šåˆ°ç‰¹ç‚¹çš„ç½‘å¡ä¸Šã€‚æ¯”å¦‚æˆ‘ä»¬çš„äº‘ä¸»æœºï¼ˆåŒæ—¶ä¹Ÿæ˜¯Swarm manager/nodeï¼‰æœ‰&lt;strong>eth0&lt;/strong>å’Œ&lt;strong>eth1&lt;/strong>ä¸¤å—ç½‘å¡ï¼Œåˆ†åˆ«è¿æ¥å†…ç½‘å’Œå¤–ç½‘ã€‚æˆ‘ä»¬è®¡åˆ’åœ¨&lt;a href="https://docs.docker.com/engine/swarm/">Docker Swarm&lt;/a>ä¸­è¿è¡Œä¸€ä¸ª&lt;strong>nginx&lt;/strong>æœåŠ¡ï¼Œé€šè¿‡80/443ç«¯å£æä¾›HTTP/HTTPSæœåŠ¡ã€‚å½“æˆ‘ä»¬å¸Œæœ›å°†&lt;strong>nginx&lt;/strong>ä¸­çš„WebæœåŠ¡æš´éœ²åœ¨äº‘ä¸»æœºä¸Šæ—¶ï¼Œæˆ‘ä»¬é€šè¿‡ä»¥ä¸‹å‘½ä»¤åˆ›å»º&lt;strong>nginx&lt;/strong>æœåŠ¡ã€‚ç„¶è€Œæˆ‘ä»¬æ— æ³•é€‰æ‹©å°†publishedçš„&lt;strong>80&lt;/strong>ç«¯å£ç»‘å®šåœ¨å“ªä¸ªinterfaceä¸Šã€‚&lt;a href="https://docs.docker.com/engine/swarm/">Docker Swarm&lt;/a>ä¼šè‡ªåŠ¨å°†æœåŠ¡ç›‘å¬åˆ°Swarm nodeçš„æ‰€æœ‰80ç«¯å£ä¸Šã€‚å¦‚æœæˆ‘ä»¬åªæƒ³å°†è¿™ä¸ªæœåŠ¡æš´éœ²åœ¨å†…ç½‘interfaceæš‚æ—¶æ— æ³•å®ç°ã€‚
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">docker service create --name vme-nginx --network vme-network --replicas &lt;span style="color:#ae81ff">1&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;span style="color:#ae81ff">&lt;/span> --publish 80:80 --publish 443:443 &lt;span style="color:#ae81ff">\
&lt;/span>&lt;span style="color:#ae81ff">&lt;/span> nginx:1.11&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>æ— æ³•ä¸º&lt;a href="https://docs.docker.com/engine/swarm/">Docker Swarm&lt;/a>å†…è¿è¡Œçš„æœåŠ¡è®¾ç½®ä¸»æœºåã€‚é€šè¿‡&lt;a href="https://docs.docker.com/engine/reference/run/">docker runå‘½ä»¤&lt;/a>æ‰§è¡Œçš„å®¹å™¨å¯ä»¥è®¾ç½®hostnameã€‚æ¯”å¦‚ï¼Œ
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">docker run --hostname vme-nginx nginx:1.11&lt;/code>&lt;/pre>&lt;/div>
ä½†æ˜¯&lt;a href="https://docs.docker.com/engine/reference/commandline/service_create/">docker service createå‘½ä»¤&lt;/a>ç¼ºå°‘ç­‰ä»·çš„å‚æ•°ä¸ºå®¹å™¨æŒ‡å®šhostnameã€‚ä¸€äº›ä¾èµ–äº&lt;strong>hostname&lt;/strong>çš„æœåŠ¡å°†æ— æ³•éƒ¨ç½²åœ¨&lt;a href="https://docs.docker.com/engine/swarm/">Docker Swarm&lt;/a>ä¸­ï¼Œæ¯”å¦‚clustered rabbitmqã€‚&lt;/li>
&lt;li>&lt;a href="https://docs.docker.com/compose/">Docker compose&lt;/a>è¿˜ä¸èƒ½ä¸&lt;a href="https://docs.docker.com/engine/swarm/">Docker Swarm&lt;/a>å®Œç¾é›†æˆã€‚ç›®å‰æœ‰ä¸€ä¸ªexperimentalçš„&lt;a href="https://docs.docker.com/compose/bundles/">Docker Stacks and Distributed Application Bundles&lt;/a>åœ¨å°è¯•åšæ›´å¥½çš„æ•´åˆã€‚&lt;/li>
&lt;li>&lt;strong>docker service update&lt;/strong>æœ‰æ—¶ä¸èƒ½æ›´æ–°æ­£åœ¨è¿è¡Œä¸­çš„containerã€‚æ›´å¤šè®¨è®ºè§&lt;a href="https://github.com/docker/swarmkit/issues/1619">è¿™ä¸ªissue&lt;/a>ã€‚&lt;/li>
&lt;/ol></description></item><item><title>åˆ›å»ºäºDocker Swarmçš„æœåŠ¡æ— æ³•åœ¨Ubuntu 14.04 LTSä¸­è¿è¡Œ</title><link>https://kane.mx/posts/2016/docker-swarm-mode-in-ubuntu-1404/</link><pubDate>Tue, 13 Sep 2016 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2016/docker-swarm-mode-in-ubuntu-1404/</guid><description>&lt;p>&lt;a href="https://vme360.com">Vç§˜&lt;/a>å›¢é˜Ÿä¸€ç›´è‡´åŠ›äºç”¨æŠ€æœ¯æ”¹å–„äº§å“ã€‚&lt;a href="https://vme360.com">Vç§˜&lt;/a>åå°çš„å„ç§æœåŠ¡ä¸€ç›´æ˜¯é€šè¿‡å®Œå–„çš„Devopsæµç¨‹è‡ªåŠ¨éƒ¨ç½²åˆ°&lt;a href="https://www.docker.com">Docker&lt;/a>å®¹å™¨é›†ç¾¤ã€‚éšç€&lt;a href="https://docs.docker.com/engine/swarm/">Swarm mode&lt;/a>åœ¨&lt;a href="https://www.docker.com">Docker&lt;/a> v1.12ä¸­æ­£å¼å‘å¸ƒï¼Œ&lt;a href="https://docs.docker.com/engine/swarm/">Swarm mode&lt;/a>å¸¦æ¥äº†è¯¸å¦‚Dockeré›†ç¾¤ï¼Œå¤šä¸»æœºç½‘ç»œç­‰æ¿€åŠ¨äººå¿ƒçš„ç‰¹æ€§ã€‚æˆ‘ä»¬ä¹Ÿåœ¨å°è¯•å°†&lt;a href="https://vme360.com">Vç§˜&lt;/a>æœåŠ¡éƒ¨ç½²åˆ°&lt;a href="https://docs.docker.com/engine/swarm/">Docker Swarm Cluster&lt;/a>è·å–æ›´å¥½çš„å¼¹æ€§è®¡ç®—èƒ½åŠ›ã€‚&lt;/p>
&lt;p>ç„¶è€Œæˆ‘ä»¬å°†&lt;a href="https://vme360.com">Vç§˜&lt;/a>çš„æœåŠ¡éƒ¨ç½²åˆ°&lt;a href="https://docs.docker.com/engine/swarm/">Docker Swarm Cluster&lt;/a>æ—¶é‡åˆ°æœåŠ¡å®¹å™¨æ— æ³•å¯åŠ¨çš„é”™è¯¯ã€‚é”™è¯¯ä¿¡æ¯ç±»ä¼¼å¦‚ä¸‹ï¼Œ&lt;/p>
&lt;blockquote>
&lt;p>starting container failed: could not add veth pair inside the network sandbox: could not find an appropriate master &amp;quot;ov-000100-1wkbc&amp;quot; for &amp;quot;vethee39f9d&amp;quot;&lt;/p>
&lt;/blockquote>
&lt;!-- raw HTML omitted -->
&lt;p>ç»è¿‡ä¸&lt;a href="https://github.com/docker/docker/issues">Docker ç¤¾åŒº&lt;/a>çš„å›é¦ˆè®¨è®ºï¼Œæš‚æ—¶é€šè¿‡å‡çº§Dockerä¸»æœº(OS: Ubuntu 14.04 LTS)çš„å†…æ ¸ç‰ˆæœ¬è§£å†³äº†è¿™ä¸ªé”™è¯¯ã€‚&lt;/p>
&lt;p>å…·ä½“æ–¹æ³•å¦‚ä¸‹ï¼Œ&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">root@swarm1:~# uname -r
3.13.0-32-generic
root@swarm1:~# apt-get install linux-generic-lts-vivid
root@swarm1:~# reboot
root@swarm1:~# uname -r
3.19.0-69-generic&lt;/code>&lt;/pre>&lt;/div>
&lt;p>è‡³äºè¿™ä¸ªé”™è¯¯çš„æ ¹æœ¬åŸå› æ˜¯&lt;a href="https://www.docker.com">Docker&lt;/a>çš„bugè¿˜æ˜¯å¯¹Linux Kernelæœ‰ç‰¹æ®Šçš„è¦æ±‚ï¼Œéœ€è¦Dockerå¼€å‘è¿›ä¸€æ­¥ç¡®è®¤ã€‚å¦‚æœå¯¹æ­¤é—®é¢˜æœ‰æ›´å¤šå…´è¶£ï¼Œå¯ä»¥å…³æ³¨&lt;a href="https://github.com/docker/docker/issues/25039">docker issue #25039&lt;/a>ã€‚&lt;/p></description></item><item><title>åŸºäºAngularjså•é¡µé¢åº”ç”¨çš„SEOä¼˜åŒ–</title><link>https://kane.mx/posts/2016/seo-optimization-for-angularajs-based-app/</link><pubDate>Thu, 19 May 2016 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2016/seo-optimization-for-angularajs-based-app/</guid><description>&lt;p>åœ¨ä¹‹å‰çš„&lt;a href="https://kane.mx/posts/2016/single-page-app-meets-weixin-pay/">æ–‡ç« &lt;/a>æˆ‘æ›¾æåˆ°åŸºäº&lt;a href="https://angularjs.org/">Angularjs&lt;/a>çš„å•é¡µé¢åº”ç”¨åœ¨ç”¨æˆ·ä½“éªŒä¸Šçš„ç§ç§å¥½å¤„ã€‚ç„¶è€Œä»»ä½•äº‹æƒ…éƒ½ä¸æ˜¯å®Œç¾çš„ï¼Œ&lt;a href="https://angularjs.org/">Angular&lt;/a>å’Œç±»ä¼¼çš„æ¡†æ¶é€šè¿‡åº”ç”¨å†…åšé¡µé¢è·¯ç”±çš„å®ç°ç»™SEOï¼ˆä¹Ÿä¿—ç§°æœç´¢å¼•æ“ä¼˜åŒ–ï¼‰å¸¦æ¥äº†ä¸å°‘éº»çƒ¦ã€‚&lt;/p>
&lt;p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹é¡µé¢å†…è·¯ç”±æ˜¯å¦‚ä½•å®ç°çš„ã€‚é»˜è®¤&lt;a href="https://angularjs.org/">Angularjs&lt;/a>ç”Ÿæˆçš„é¡µé¢uriç±»å‹å¦‚ä¸‹ï¼Œ&lt;/p>
&lt;p>&lt;code>http://mydomain.com/#/app/page1&lt;/code>&lt;/p>
&lt;p>æµè§ˆå™¨è¯·æ±‚ä¸Šé¢è¿™ä¸ªuriçš„æ—¶å€™ï¼Œå®é™…å‘é€ç»™æœåŠ¡å™¨çš„è¯·æ±‚åœ°å€æ˜¯&lt;strong>&lt;a href="http://mydomain.com/">http://mydomain.com/&lt;/a>&lt;/strong>, webæœåŠ¡å™¨ä¼šå°†é»˜è®¤çš„é¡µé¢å“åº”ç»™æµè§ˆå™¨ï¼Œæ¯”å¦‚&lt;em>index.html&lt;/em>æˆ–&lt;em>index.php&lt;/em>ç­‰ã€‚&lt;/p>
&lt;p>æµè§ˆå™¨è¿”å›çš„é¡µé¢é‡Œé¢å¼•å…¥äº†&lt;a href="https://angularjs.org/">Angularjs&lt;/a>å’Œå…¶ä»–åº”ç”¨éœ€è¦çš„JSåº“ã€‚&lt;a href="https://angularjs.org/">Angularjs&lt;/a>åº”ç”¨å¼€å§‹æ‰§è¡Œåï¼Œå°è¯•å¤„ç†è·¯ç”±**/app/page1**ã€‚å¦‚æœåº”ç”¨å®šä¹‰äº†è¯¥è·¯ç”±ï¼Œå°†åŠ è½½å¿…è¦çš„JSåº“å’Œå…¶ä»–htmlç‰‡æ®µæ¥å®Œæˆé¡µé¢çš„æ¸²æŸ“ã€‚&lt;/p>
&lt;p>ç†è§£äº†&lt;a href="https://angularjs.org/">Angularjs&lt;/a>é¡µé¢å†…è·¯ç”±çš„åŸç†åï¼Œæˆ‘ä»¬çŸ¥é“äº†å¯¹æµè§ˆå™¨æˆ–æœç´¢å¼•æ“çˆ¬è™«è€Œè¨€ï¼Œå•é¡µé¢åº”ç”¨æ‰€æœ‰çš„é¡µé¢å¯¹æµè§ˆå™¨å’Œæœç´¢å¼•æ“éƒ½æ˜¯ä¸€ä¸ªç½‘å€ï¼Œæ¯”å¦‚&lt;code>http://mydomain.com/&lt;/code>ã€‚è¿™æ ·å¯¹çˆ¬è™«æŠ“å–ç«™å†…é“¾æ¥é€ æˆäº†å›°éš¾ï¼Œå› ä¸ºæ‰€æœ‰åº”ç”¨å†…çš„é“¾æ¥éƒ½è¢«è®¤åšäº†åŒä¸€ä¸ªé“¾æ¥ã€‚&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;p>æˆ‘ä»¬ç†è§£äº†uri &lt;code>http://mydomain.com/#/app/page1&lt;/code>ç»™SEOé€ æˆçš„éº»çƒ¦ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è®¨è®ºå¦‚ä½•é’ˆå¯¹SEOæ¥ä½œçš„ä¼˜åŒ–ã€‚&lt;/p>
&lt;p>æœ€ç†æƒ³çš„æƒ…å†µå½“ç„¶æ˜¯æœç´¢å¼•æ“çˆ¬è™«å˜çš„æ›´åŠ æ™ºèƒ½ï¼Œå®ƒèƒ½ç†è§£ç½‘ç«™çš„æ¡†æ¶ï¼Œå¹¶ä¸”é’ˆå¯¹æ­¤ç§æƒ…å†µåšå‡ºä¼˜åŒ–ã€‚ä½†æˆªæ­¢åˆ°ç›®å‰ï¼ŒåŒ…æ‹¬Googleåœ¨å†…çš„æ‰€æœ‰çˆ¬è™«éƒ½æ— æ³•åšåˆ°è¿™ç‚¹ã€‚é‚£æˆ‘ä»¬SEOçš„ä¼˜åŒ–åªèƒ½åœ¨åº”ç”¨è¿™è¾¹æ¥åšäº†ã€‚&lt;/p>
&lt;p>&lt;a href="https://angularjs.org/">Angularjs&lt;/a>æä¾›äº†ä¸€ç§&lt;a href="https://docs.angularjs.org/guide/$location">HTML5 mode&lt;/a>æ¨¡å¼å¯ä»¥åˆ©ç”¨HTML5 History APIæ¥å®ç°é¡µé¢å†…è·¯ç”±ã€‚æ‰“å¼€çš„æ–¹æ³•å¦‚ä¸‹ï¼Œ&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="color:#a6e22e">$locationProvider&lt;/span>.&lt;span style="color:#a6e22e">html5Mode&lt;/span>(&lt;span style="color:#66d9ef">true&lt;/span>);
&lt;/code>&lt;/pre>&lt;/div>
&lt;p>åŒæ—¶åœ¨&lt;code>index.html&lt;/code>é¡µé¢åŠ ä¸Šå¦‚ä¸‹æ ‡ç­¾ï¼Œ&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&amp;lt;&lt;span style="color:#f92672">base&lt;/span> &lt;span style="color:#a6e22e">href&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;/&amp;#34;&lt;/span>&amp;gt;&lt;/code>&lt;/pre>&lt;/div>
&lt;p>åœ¨æ‰“å¼€&lt;a href="https://docs.angularjs.org/guide/$location">HTML5 mode&lt;/a>åçš„&lt;a href="https://angularjs.org/">Angularjs&lt;/a>åº”ç”¨çš„é“¾æ¥çœ‹èµ·æ¥å°±æ˜¯è¿™æ ·äº†ï¼Œ&lt;/p>
&lt;p>&lt;code>http://mydomain.com/app/page1&lt;/code>&lt;/p>
&lt;p>æ–°çš„é“¾æ¥æ¨¡å¼å’Œç«™å†…è·³è½¬é€šè¿‡è®¿é—®ç½‘ç«™ä¸»é¡µè¯·æ±‚å°†æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚ç„¶è€Œç›´æ¥åœ¨æµè§ˆå™¨è¯·æ±‚å¦‚ä¸Šé“¾æ¥çš„è¯ï¼ŒWebæœåŠ¡å™¨å°†å°è¯•è¯·æ±‚&lt;code>/app/page1&lt;/code>ï¼Œé€šå¸¸ä¼šå¾—åˆ°&lt;strong>404&lt;/strong>çš„é¡µé¢å“åº”ã€‚å› ä¸ºæœåŠ¡å™¨ä¸Šå¹¶æ²¡æœ‰éƒ¨ç½²é¡µé¢&lt;code>/app/page1&lt;/code>ã€‚&lt;/p>
&lt;p>è¿™æ—¶å°±éœ€è¦åœ¨Webåº”ç”¨æœåŠ¡å™¨æˆ–åº”ç”¨é‡Œé¢å®ç°&lt;strong>URL Rewrite&lt;/strong>ã€‚å°†&lt;code>/app/page1&lt;/code>çš„è¯·æ±‚è½¬åˆ°å•é¡µé¢åº”ç”¨htmlæ–‡ä»¶ä¸Šã€‚&lt;/p>
&lt;p>ä¸‹é¢æ˜¯ä¸€äº›WebæœåŠ¡å™¨æˆ–åº”ç”¨çš„å‚è€ƒé…ç½®ï¼Œ&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>Apache Rewrites&lt;/strong>&lt;/p>
&lt;pre>&lt;code class="language-conf" data-lang="conf"> &amp;lt;VirtualHost *:80&amp;gt;
ServerName my-app
DocumentRoot /path/to/app
&amp;lt;Directory /path/to/app&amp;gt;
RewriteEngine on
# Don&amp;#39;t rewrite files or directories
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]
# Rewrite everything else to index.html to allow html5 state links
RewriteRule ^ index.html [L]
&amp;lt;/Directory&amp;gt;
&amp;lt;/VirtualHost&amp;gt;
&lt;/code>&lt;/pre>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Nginx Rewrites&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-nginx" data-lang="nginx"> &lt;span style="color:#66d9ef">server&lt;/span> {
&lt;span style="color:#f92672">server_name&lt;/span> &lt;span style="color:#e6db74">my-app&lt;/span>;
&lt;span style="color:#f92672">root&lt;/span> &lt;span style="color:#e6db74">/path/to/app&lt;/span>;
&lt;span style="color:#f92672">location&lt;/span> &lt;span style="color:#e6db74">/&lt;/span> {
&lt;span style="color:#f92672">try_files&lt;/span> $uri $uri/ &lt;span style="color:#e6db74">/index.html&lt;/span>;
}
}
&lt;/code>&lt;/pre>&lt;/div>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Azure IIS Rewrites&lt;/strong>&lt;/p>
&lt;pre>&lt;code class="language-conf" data-lang="conf"> &amp;lt;system.webServer&amp;gt;
&amp;lt;rewrite&amp;gt;
&amp;lt;rules&amp;gt;
&amp;lt;rule name=&amp;#34;Main Rule&amp;#34; stopProcessing=&amp;#34;true&amp;#34;&amp;gt;
&amp;lt;match url=&amp;#34;.*&amp;#34; /&amp;gt;
&amp;lt;conditions logicalGrouping=&amp;#34;MatchAll&amp;#34;&amp;gt;
&amp;lt;add input=&amp;#34;{REQUEST_FILENAME}&amp;#34; matchType=&amp;#34;IsFile&amp;#34; negate=&amp;#34;true&amp;#34; /&amp;gt;
&amp;lt;add input=&amp;#34;{REQUEST_FILENAME}&amp;#34; matchType=&amp;#34;IsDirectory&amp;#34; negate=&amp;#34;true&amp;#34; /&amp;gt;
&amp;lt;/conditions&amp;gt;
&amp;lt;action type=&amp;#34;Rewrite&amp;#34; url=&amp;#34;/&amp;#34; /&amp;gt;
&amp;lt;/rule&amp;gt;
&amp;lt;/rules&amp;gt;
&amp;lt;/rewrite&amp;gt;
&amp;lt;/system.webServer&amp;gt;
&lt;/code>&lt;/pre>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Express Rewrites&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-javascript" data-lang="javascript"> &lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">express&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;express&amp;#39;&lt;/span>);
&lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">express&lt;/span>();
&lt;span style="color:#a6e22e">app&lt;/span>.&lt;span style="color:#a6e22e">use&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;/js&amp;#39;&lt;/span>, &lt;span style="color:#a6e22e">express&lt;/span>.&lt;span style="color:#66d9ef">static&lt;/span>(&lt;span style="color:#a6e22e">__dirname&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#39;/js&amp;#39;&lt;/span>));
&lt;span style="color:#a6e22e">app&lt;/span>.&lt;span style="color:#a6e22e">use&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;/dist&amp;#39;&lt;/span>, &lt;span style="color:#a6e22e">express&lt;/span>.&lt;span style="color:#66d9ef">static&lt;/span>(&lt;span style="color:#a6e22e">__dirname&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#39;/../dist&amp;#39;&lt;/span>));
&lt;span style="color:#a6e22e">app&lt;/span>.&lt;span style="color:#a6e22e">use&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;/css&amp;#39;&lt;/span>, &lt;span style="color:#a6e22e">express&lt;/span>.&lt;span style="color:#66d9ef">static&lt;/span>(&lt;span style="color:#a6e22e">__dirname&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#39;/css&amp;#39;&lt;/span>));
&lt;span style="color:#a6e22e">app&lt;/span>.&lt;span style="color:#a6e22e">use&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;/partials&amp;#39;&lt;/span>, &lt;span style="color:#a6e22e">express&lt;/span>.&lt;span style="color:#66d9ef">static&lt;/span>(&lt;span style="color:#a6e22e">__dirname&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#39;/partials&amp;#39;&lt;/span>));
&lt;span style="color:#a6e22e">app&lt;/span>.&lt;span style="color:#a6e22e">all&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;/*&amp;#39;&lt;/span>, &lt;span style="color:#66d9ef">function&lt;/span>(&lt;span style="color:#a6e22e">req&lt;/span>, &lt;span style="color:#a6e22e">res&lt;/span>, &lt;span style="color:#a6e22e">next&lt;/span>) {
&lt;span style="color:#75715e">// Just send the index.html for other files to support HTML5Mode
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">sendFile&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;index.html&amp;#39;&lt;/span>, { &lt;span style="color:#a6e22e">root&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">__dirname&lt;/span> });
});
&lt;span style="color:#a6e22e">app&lt;/span>.&lt;span style="color:#a6e22e">listen&lt;/span>(&lt;span style="color:#ae81ff">3006&lt;/span>); &lt;span style="color:#75715e">//the port you want to use
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ASP.Net C# Rewrites&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-csharp" data-lang="csharp"> &lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span> ROOT_DOCUMENT = &lt;span style="color:#e6db74">&amp;#34;/default.aspx&amp;#34;&lt;/span>;
&lt;span style="color:#66d9ef">protected&lt;/span> &lt;span style="color:#66d9ef">void&lt;/span> Application_BeginRequest( Object sender, EventArgs e )
{
&lt;span style="color:#66d9ef">string&lt;/span> url = Request.Url.LocalPath;
&lt;span style="color:#66d9ef">if&lt;/span> ( !System.IO.File.Exists( Context.Server.MapPath( url ) ) )
Context.RewritePath( ROOT_DOCUMENT );
}
&lt;/code>&lt;/pre>&lt;/div>
&lt;/li>
&lt;/ul></description></item><item><title>Springæ¡†æ¶ä¸‹çš„åˆ†å¸ƒå¼sessionç®¡ç†</title><link>https://kane.mx/posts/2016/clustered-session-under-spring-framework/</link><pubDate>Sat, 07 May 2016 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2016/clustered-session-under-spring-framework/</guid><description>&lt;p>åœ¨å¾®æœåŠ¡å’Œå®¹å™¨ç­‰æŠ€æœ¯çš„å¸®åŠ©ä¸‹ï¼ŒWebåº”ç”¨å¯ä»¥è¾ƒä¸ºå®¹æ˜“çš„è¿›è¡Œæ°´å¹³æ‰©å±•ï¼Œæ¥éƒ¨ç½²æ›´å¤šçš„åº”ç”¨å®ä¾‹æ¥æå‡è¯·æ±‚å¤„ç†æ•°QPSã€‚å½“WebæœåŠ¡æœ‰çŠ¶æ€çš„æ—¶å€™ï¼Œå¦‚ä½•åœ¨é›†ç¾¤ä¸‹ç®¡ç†ç”¨æˆ·sessionæˆä¸ºæ–°çš„å¾…è§£å†³é—®é¢˜ã€‚&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;p>&lt;a href="https://spring.io">Spring Framework&lt;/a>é’ˆå¯¹æ­¤é—®é¢˜è¡ç”Ÿå‡ºäº†ä¸€ä¸ªå­é¡¹ç›®&lt;a href="http://projects.spring.io/spring-session/">Spring Session&lt;/a>æ¥å®ç°é›†ç¾¤ä¸‹çš„sessionç®¡ç†ã€‚è¯¥é¡¹ç›®æä¾›äº†ä»¥ä¸‹åŠŸèƒ½ï¼š&lt;/p>
&lt;ul>
&lt;li>æä¾›APIå’Œå®ç°ç®¡ç†ç”¨æˆ·session&lt;/li>
&lt;li>HttpSession - æ›¿æ¢å®ç°åº”ç”¨å®¹å™¨(tomcat)ä¸­çš„HttpSession
&lt;ul>
&lt;li>Clustered Sessions - å®ç°é›†ç¾¤çš„sessionè€Œä¸ä¾èµ–ä»»ä½•åº”ç”¨å®¹å™¨ç‰¹å®šçš„è§£å†³æ–¹æ¡ˆ&lt;/li>
&lt;li>Multiple Browser Sessions - æ”¯æŒå¤šä¸ªç”¨æˆ·sessionä¿å­˜åœ¨åŒä¸€ä¸ªæµè§ˆå™¨å®ä¾‹ä¸­ (ä¾‹å¦‚ï¼Œç±»ä¼¼Googleçš„å¤šç”¨æˆ·è®¤è¯).&lt;/li>
&lt;li>RESTful APIs - é€šè¿‡æ”¯æŒsession idsåœ¨Httpè¯·æ±‚å¤´æ¥æ”¯æŒRestful APIçš„è®¤è¯&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>WebSocket - èƒ½å¤Ÿä¿è¯HttpSessionçš„å­˜æ´»å½“åœ¨æ¥å—WebSocketæ¶ˆæ¯æ—¶&lt;/li>
&lt;/ul>
&lt;p>ä»ä¸Šé¢çš„åŠŸèƒ½åˆ—è¡¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°&lt;a href="http://projects.spring.io/spring-session/">Spring Session&lt;/a>èƒ½å¤Ÿæ»¡è¶³é›†ç¾¤ä¸‹å„ç§sessionçš„ä½¿ç”¨åœºæ™¯å’Œéœ€æ±‚ã€‚&lt;/p>
&lt;p>&lt;a href="http://projects.spring.io/spring-session/">Spring Session&lt;/a>åœ¨1.0.0 GAå¯ä»¥ä½¿ç”¨&lt;a href="http://redis.io/">Redis&lt;/a>åšä¸ºsessionå‚¨å­˜çš„backendã€‚&lt;/p>
&lt;p>é€šè¿‡changelogï¼Œåœ¨æœ€æ–°çš„1.1.0 GAä¸­æ”¯æŒ&lt;a href="http://docs.spring.io/spring-session/docs/1.1.1.RELEASE/reference/html5/#what-s-new-in-1-1">è‡ªå®šä¹‰Cookieçš„åˆ›å»º&lt;/a>ï¼Œå…è®¸è‡ªå®šä¹‰Cookieçš„è¿‡æœŸæ—¶é—´ï¼Œä½œç”¨åŸŸç­‰ã€‚åœ¨å³å°†å‘å¸ƒçš„&lt;a href="http://docs.spring.io/spring-session/docs/1.2.0.RC2/reference/html5/#what-s-new-in-1-2">1.2.0 GA&lt;/a>ç‰ˆæœ¬ä¸­ï¼Œå°†æ·»åŠ æ”¯æŒJDBCçš„å…³ç³»æ•°æ®åº“å’Œ&lt;a href="https://www.mongodb.org/">MongoDB&lt;/a>ä½œä¸ºsessionä¿å­˜çš„backendã€‚&lt;/p>
&lt;p>æ­¤å¤–ï¼Œ&lt;a href="http://projects.spring.io/spring-session/">Spring Session&lt;/a>åŒ&lt;a href="http://projects.spring.io/spring-boot/">Spring-boot&lt;/a>çš„åº”ç”¨æœ‰å¾ˆå¥½çš„&lt;a href="http://docs.spring.io/spring-session/docs/current/reference/html5/guides/boot.html">é›†æˆ&lt;/a>ï¼Œåªéœ€è¦åå¤šè¡Œä»£ç åŠé…ç½®å³å¯é›†æˆï¼&lt;/p></description></item><item><title>Vç§˜æ˜¯å¦‚ä½•æ„å»ºçš„</title><link>https://kane.mx/posts/2016/how-we-build-videome/</link><pubDate>Thu, 07 Apr 2016 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2016/how-we-build-videome/</guid><description>&lt;p>æ˜¥å¤©æ¥äº†ï¼Œ&lt;a href="https://vme360.com">Vç§˜&lt;/a>å¤§å®¶åº­ä¹Ÿæ–°å¢äº†ä¸¤ä½10åçš„ä¼ äººã€‚æ–°çˆ¸çˆ¸ç»è¿‡ä¸€ç•ªå¿™ä¹±åï¼Œå¸Œæœ›åœ¨è¿™é‡Œä¸å¤§å®¶åˆ†äº«&lt;a href="https://vme360.com">Vç§˜&lt;/a>çš„æ¶æ„ï¼Œå…±åŒæ¢è®¨å¦‚ä½•å¿«é€Ÿçš„æ„å»ºé«˜å¯ç”¨ï¼Œé«˜æ€§èƒ½çš„WebæœåŠ¡ã€‚&lt;/p>
&lt;p>&lt;a href="https://vme360.com">Vç§˜&lt;/a>è‡´åŠ›äºæä¾›æœ€å¥½çš„åœ¨çº¿è§†é¢‘åˆ¶ä½œäº‘å¹³å°ã€‚è®©ç”¨æˆ·éšæ—¶éšåœ°é›¶é—¨æ§›çš„å¿«é€Ÿåˆ¶ä½œå‡ºé«˜è´¨é‡é«˜æ¸…æ™°åº¦çš„è§†é¢‘ï¼Œæ¥çºªå¿µè®°å½•ç”Ÿæ´»ä¸­æœ‰æ„ä¹‰çš„æ—¶åˆ»ï¼ŒåŒæ—¶å°†è¿™ä»½å¿«ä¹ä¼ é€’ç»™æ›´å¤šçš„å®¶äººæœ‹å‹ä¸€èµ·åˆ†äº«ã€‚&lt;/p>
&lt;p>ç„¶è€Œè¦å¯é çš„å¯æ‰©å±•çš„å®ç°è¿™æ ·çœ‹ä¼¼ç®€å•çš„éœ€æ±‚ï¼Œå…¶èƒŒåç¡®ç”±ä¼—å¤šçŸ¥åå¼€æºæŠ€æœ¯ï¼Œå¯é çš„äº‘æœåŠ¡ï¼Œä¸é—´æ­‡çš„ç›‘æ§è¿ç»´æ¥å®ç°å’Œä¿è¯çš„ã€‚&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;p>&lt;a href="https://vme360.com">Vç§˜&lt;/a>æ¶æ„çš„åŸºæœ¬ç›®æ ‡å°±æ˜¯è¦å®ç°ï¼Œ&lt;/p>
&lt;ul>
&lt;li>æœåŠ¡çš„é«˜æ‰©å±•æ€§ã€‚æœ‰æœ‰æ•ˆå¯é çš„æ–¹æ³•æ”¯æ’‘æ•°ä¸‡å¹¶å‘åˆ°æ•°åä¸‡ï¼Œç™¾ä¸‡åŠæ›´å¤šçš„å¹¶å‘è¯·æ±‚ã€‚&lt;/li>
&lt;li>æœåŠ¡çš„é«˜å¯ç”¨æ€§ã€‚å„ç§æœåŠ¡éƒ½æ˜¯å¤šå®ä¾‹çš„é›†ç¾¤ï¼ŒæŸäº›æœåŠ¡æ•…éšœåï¼Œé›†ç¾¤ä¸­çš„å…¶ä»–å®ä¾‹ä»ç„¶èƒ½å¤Ÿæä¾›æœåŠ¡ã€‚&lt;/li>
&lt;li>æœåŠ¡çš„è‡ªåŠ¨åŒ–æ„å»ºã€‚ä»ä»£ç åˆ°æœåŠ¡éƒ¨ç½²ä¸Šçº¿æ˜¯ä¸€å¥—è‡ªåŠ¨åŒ–çš„æµç¨‹ï¼Œè¶Šå°‘çš„äººå·¥ä»‹å…¥ä¿è¯äº†æœåŠ¡çš„å¯ç”¨æ€§ã€‚&lt;/li>
&lt;li>ç³»ç»Ÿçš„å®æ—¶ç›‘æ§ã€‚7x24å°æ—¶çš„ç›‘æ§ä¿è¯æœåŠ¡çš„å¯ç”¨æ€§ï¼Œå½“ç›‘æ§åˆ°æ•°æ®å¼‚å¸¸æˆ–æœåŠ¡åœæ­¢è¿è¡Œèƒ½åŠæ—¶å‘Šè­¦å¼•å…¥äººå·¥è¿ç»´å›¢é˜Ÿã€‚&lt;/li>
&lt;/ul>
&lt;p>æ›´å¤šç»†èŠ‚è¯·å‚é˜…ä¸‹é¢çš„&lt;a href="http://www.slideshare.net/zxkane/how-we-build-vme">slides&lt;/a>,&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;p>æ¬¢è¿ç•™è¨€ä¸æˆ‘ä»¬æ¢è®¨ä½ çš„å¿ƒå¾—å’Œå»ºè®®ã€‚&lt;/p></description></item><item><title>è¯´ä¸€è¯´é˜¿é‡Œäº‘ossfs</title><link>https://kane.mx/posts/2016/aliyun-ossfs-sucks/</link><pubDate>Fri, 26 Feb 2016 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2016/aliyun-ossfs-sucks/</guid><description>&lt;p>é˜¿é‡Œäº‘æä¾›çš„å¯¹è±¡æˆ–è€…æ–‡ä»¶å­˜å‚¨å«&lt;a href="https://www.aliyun.com/product/oss">OSS&lt;/a>ï¼Œä¸ºåº”ç”¨ç¨‹åºæä¾›äº†æµ·é‡å­˜å‚¨ï¼ŒæŒ‰éœ€ä»˜è´¹ç­‰æœåŠ¡ã€‚åº”ç”¨ç¨‹åºåˆ™éœ€è¦é€šè¿‡&lt;a href="https://www.aliyun.com/product/oss">Aliyun OSS&lt;/a>çš„å„è¯­è¨€SDKæ‰èƒ½æ“ä½œï¼ˆè¯»ï¼Œå†™ï¼Œéå†ç­‰ï¼‰OSSä¸­çš„æ–‡ä»¶ã€‚&lt;/p>
&lt;p>å¯¹è¿ç»´äººå‘˜æ¥è¯´ï¼Œåšä¸€äº›æ•°æ®ç»´æŠ¤å·¥ä½œçš„æ—¶å€™ï¼Œé€šè¿‡SDKæ“ä½œ&lt;a href="https://www.aliyun.com/product/oss">OSS&lt;/a>ä¸­çš„æ–‡ä»¶å°±ä¼šæ¯”è¾ƒéº»çƒ¦ã€‚åœ¨linux/unixç¯å¢ƒä¸‹ï¼Œé€šå¸¸æœ‰ä¸€äº›å·¥å…·æŠŠè¿œç¨‹æ–‡ä»¶ç³»ç»Ÿæˆ–äº‘ç›˜æŒ‚è½½ä¸ºæœ¬åœ°æ–‡ä»¶ã€‚åœ¨ç½‘ç»œçŠ¶å†µæ¯”è¾ƒå¥½çš„æƒ…å†µä¸‹ï¼Œæ“ä½œè¿œç¨‹æ–‡ä»¶å°±åƒæ“ä½œæœ¬åœ°æ–‡ä»¶ä¸€æ ·ã€‚ä¾‹å¦‚ï¼ŒæŠŠ&lt;a href="https://github.com/s3fs-fuse/s3fs-fuse">Amazon S3&lt;/a>ï¼Œ&lt;a href="https://github.com/joe42/CloudFusion">Dropboxäº‘ç›˜&lt;/a>ï¼Œ&lt;a href="https://github.com/libfuse/sshfs">å¯é€šè¿‡sshç™»å½•çš„è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„ç£ç›˜&lt;/a>æŒ‚è½½ä¸ºæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿã€‚&lt;/p>
&lt;p>ä¹‹å‰ä¹Ÿæœ‰ç¬¬ä¸‰æ–¹å…¬å¸å¼€å‘çš„å·¥å…·æŠŠ&lt;a href="https://www.aliyun.com/product/oss">OSS bucket&lt;/a>æŒ‚è½½ä¸ºæœ¬åœ°ç£ç›˜ã€‚å‡ºäºå®‰å…¨è€ƒè™‘ä¸€ç›´ä¸ºæ•¢ä½¿ç”¨ã€‚&lt;/p>
&lt;p>ç»ˆäºï¼Œé˜¿é‡Œäº‘æ¨å‡ºäº†å®˜æ–¹å¼€æºç‰ˆæœ¬çš„&lt;a href="https://github.com/aliyun/ossfs">ossfs&lt;/a>ï¼Œå¹¶ä¸”æä¾›æŠ€æœ¯æ”¯æŒï¼ˆé€šè¿‡å·¥å•ï¼‰ã€‚&lt;/p>
&lt;p>æ¥ä¸‹æ¥ï¼ŒèŠèŠæˆ‘çš„ä½¿ç”¨ä½“ä¼šã€‚&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;ul>
&lt;li>å®‰è£…ï¼Œé…ç½®éƒ½è¿˜ç®€å•ã€‚&lt;/li>
&lt;li>æ–‡æ¡£çœ‹èµ·æ¥æ¯”è¾ƒè¯¦ç»†ï¼Œä½†å®é™…æ“ä½œèµ·æ¥æœ‰äº›å°±ä¸å¯¹ã€‚æ„Ÿè§‰å†™æ–‡æ¡£çš„äººï¼Œå¹¶æ²¡æœ‰åœ¨ç›¸åº”ç¯å¢ƒä¸Šæµ‹è¯•è¿‡ã€‚&lt;/li>
&lt;li>æƒé™è®¾è®¡çš„ä¸€å¡Œç³Šæ¶‚ã€‚&lt;a href="https://github.com/aliyun/ossfs">ossfs&lt;/a>åŸºäº&lt;a href="https://en.wikipedia.org/wiki/Filesystem_in_Userspace">FUSE&lt;/a>ï¼Œç†å½“å…è®¸érootæŒ‚è½½æˆ–å¸è½½OSS bucketã€‚érootç”¨æˆ·ä½¿ç”¨&lt;a href="https://github.com/aliyun/ossfs">ossfs&lt;/a>æŒ‚è½½çš„æ–‡ä»¶é»˜è®¤çš„owneréƒ½æ˜¯&lt;strong>root&lt;/strong>! è¿˜å¥½ç›®å‰æœ‰workaroundï¼ŒæŒ‚è½½çš„æ—¶å€™æŒ‡å®šå‚æ•°ï¼Œ&lt;code>-ouid=your_uid -ogid=your_gid&lt;/code>æ¥æŒ‡å®šæ–‡ä»¶çš„ownerã€‚&lt;/li>
&lt;li>æ€§èƒ½æå…¶ä½ä¸‹ï¼ï¼ï¼ä¸€å°ECSä¸»æœºæŒ‚è½½äº†ä¸€ä¸ªä½¿ç”¨å†…ç½‘åœ°å€çš„oss bucketï¼Œbucketæ ¹ä¸‹é¢æœ‰2k+å­ç›®å½•ï¼ˆå¯¹æ–‡ä»¶ç³»ç»Ÿè€Œè¨€ï¼‰,bucketå†…æ–‡ä»¶æ€»è®¡æœ‰28Gã€‚ç„¶è€Œæ‰§è¡Œ&lt;code>ls /tmp/&amp;lt;bucket mount point&amp;gt;&lt;/code>è¶…è¿‡10åˆ†é’Ÿéƒ½æ— æ³•å®Œæˆã€‚è€Œæˆ‘ä»¬&lt;a href="https://vme360.com">Vç§˜&lt;/a>ä¹‹å‰ç”¨Javaå®ç°çš„&lt;a href="https://github.com/videome/AliyunOSSFS">AliyunOSSFS&lt;/a>æ‰§è¡ŒåŒæ ·çš„æ“ä½œåªéœ€è¦æ•°ç§’ã€‚&lt;/li>
&lt;li>é˜¿é‡Œäº‘ç›¸å…³çš„æŠ€æœ¯æ”¯æŒäººå‘˜åŠå…¶ä¸ä¸“ä¸šã€‚å¾ˆå¤šæ–‡ä»¶ç³»ç»Ÿï¼Œ&lt;a href="https://en.wikipedia.org/wiki/Filesystem_in_Userspace">FUSE&lt;/a>ç­‰æ¦‚å¿µéƒ½ä¸ç”šäº†è§£ã€‚è·Ÿä»–ä»¬æ²Ÿé€šè¿™äº›æŠ€æœ¯é—®é¢˜ï¼Œé¦–å…ˆè¦èŠ±æ—¶é—´è¿›è¡Œæ•™è‚²ã€‚èŠ±è´¹å¤§é‡æ—¶é—´æ¥æ²Ÿé€šï¼Œè¿›å±•ç¡®ç¼“æ…¢ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="æ€»ä¹‹é˜¿é‡Œäº‘ossfshttpsgithubcomaliyunossfsè¿™ä¸ªå·¥å…·è¿œè¿œæ²¡æœ‰è¾¾åˆ°production-readyçš„è´¨é‡æ— æ³•ä½¿ç”¨åˆ°ç”Ÿäº§ç¯å¢ƒä¸­">æ€»ä¹‹ï¼Œ&lt;a href="https://github.com/aliyun/ossfs">é˜¿é‡Œäº‘ossfs&lt;/a>è¿™ä¸ªå·¥å…·è¿œè¿œæ²¡æœ‰è¾¾åˆ°&lt;strong>production ready&lt;/strong>çš„è´¨é‡ã€‚æ— æ³•ä½¿ç”¨åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ã€‚&lt;/h2></description></item><item><title>å¦‚ä½•ä½¿ç”¨å¾®ä¿¡å…¬ä¼—å¹³å°çš„ä¸´æ—¶ç´ æ</title><link>https://kane.mx/posts/2016/weixin-temporary-materials/</link><pubDate>Wed, 27 Jan 2016 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2016/weixin-temporary-materials/</guid><description>&lt;p>å¾®ä¿¡ç»™å…¬ä¼—å¹³å°æä¾›äº†&lt;a href="http://mp.weixin.qq.com/wiki/15/2d353966323806a202cd2deaafe8e557.html">ç´ æç®¡ç†&lt;/a>çš„æ¥å£ï¼Œé€šè¿‡è¿™ä¸€ç³»åˆ—æ¥å£å¯ä»¥ä¸Šä¼ ï¼Œæ¥æ”¶ä»¥åŠç®¡ç†å›¾ç‰‡ï¼Œè§†é¢‘ç­‰å¤šåª’ä½“æ–‡ä»¶ã€‚å…¶ä¸­åˆåˆ†ä¸º&lt;strong>ä¸´æ—¶&lt;/strong>å’Œ&lt;strong>æ°¸ä¹…&lt;/strong>ä¸¤ç§ç±»å‹ã€‚æ°¸ä¹…ç´ ææœ‰æ€»é‡çš„é™åˆ¶ï¼Œä¸´æ—¶ç´ æå¾®ä¿¡æœåŠ¡å™¨åªç»™ä¿å­˜3å¤©ã€‚&lt;/p>
&lt;p>æœ€è¿‘&lt;a href="https://vme360.com">Vç§˜&lt;/a>åˆšå¥½æœ‰ä¸ªåŒå¾®ä¿¡ç”¨æˆ·äº’åŠ¨çš„åœºæ™¯ï¼Œä¸ºç”¨æˆ·ç¾åŒ–å¾®ä¿¡æ‹æ‘„çš„å°è§†é¢‘ã€‚&lt;a href="https://vme360.com">Vç§˜&lt;/a>åå°æœåŠ¡å™¨æ”¶åˆ°ç”¨æˆ·å‘é€è¿‡æ¥å°è§†é¢‘ï¼ˆå¾®ä¿¡å°†å…¶è®¤åšä¸´æ—¶ç´ æï¼‰ï¼Œå°†å…¶ç¾åŒ–å¤„ç†åï¼Œå†å°†ç¾åŒ–çš„è§†é¢‘ä¸Šä¼ ä¸ºä¸´æ—¶ç´ æï¼Œæœ€ç»ˆç¾åŒ–åçš„è§†é¢‘ä½œä¸ºè§†é¢‘ç±»å‹çš„å®¢æœæ¶ˆæ¯è¢«æ¨é€ç»™ç”¨æˆ·ã€‚æ•´ä¸ªæµç¨‹å¾ˆç®€æ´ï¼Œç”¨æˆ·å‘é€å°è§†é¢‘åï¼Œå°±åç­‰è§‚çœ‹ç¾åŒ–åçš„å°è§†é¢‘äº†ã€‚&lt;/p>
&lt;p>ç„¶è€Œæœ€ç»ˆç»è¿‡Vç§˜å¼€å‘å›¢é˜Ÿçš„å®è·µåŠæµ‹è¯•ï¼Œå¾—å‡ºçš„ç»“è®ºæ˜¯ï¼Œ&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;p>##&lt;strong>å¾®ä¿¡å…¬ä¼—å¹³å°çš„ä¸´æ—¶ç´ æä¸èƒ½ç”¨ï¼ç»å¯¹çš„é¸¡è‚‹ï¼&lt;/strong>&lt;/p>
&lt;p>å…¬ä¼—å¹³å°ä¸Šä¼ ç´ æçš„APIä»¥åŠä½¿ç”¨å·²æœ‰ç´ æå‘é€è§†é¢‘æ¶ˆæ¯APIéƒ½å¾ˆå¥å£®ã€‚ä½†é—®é¢˜å‡ºåœ¨äº†å¾®ä¿¡åå°èµ„æºçš„æœåŠ¡ä¸Šé¢ã€‚&lt;/p>
&lt;p>å¼€å‘è€…æŠŠå›¾ç‰‡è§†é¢‘æˆåŠŸä¸Šä¼ ä¸ºä¸´æ—¶ç´ æåï¼Œä¼šä»å¾®ä¿¡çš„æ¥å£å¾—åˆ°è¿™ä¸ªç´ æçš„IDã€‚è¿™ä¸ªIDéšåä½œä¸ºç»™ç”¨æˆ·å‘é€å›¾æ–‡æ¶ˆæ¯æˆ–è§†é¢‘æ¶ˆæ¯çš„èµ„æºã€‚å¾®ä¿¡åå°ä¼šæŠŠè¿™ä¸ªIDå¯¹åº”åˆ°ç´ æçš„çœŸå®URLè·¯å¾„ä¸Šã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚åŒæ—¶å¾®ä¿¡ä½œä¸ºä¸€ä¸ªæ‹¥æœ‰æµ·é‡ç”¨æˆ·çš„è½¯ä»¶ï¼Œå®ƒä¼šå°†è¿™äº›å°†è¦æ¨é€ç»™ç”¨æˆ·çš„ç´ æéƒ½å‘å¸ƒåˆ°å®ƒçš„CDNã€‚ç”¨æˆ·æ”¶åˆ°çš„æœ€ç»ˆå›¾ç‰‡è§†é¢‘çš„åœ°å€å°±æ˜¯ç´ ææ–‡ä»¶åœ¨å¾®ä¿¡/è…¾è®¯CDNä¸Šçš„åœ°å€ã€‚å¯¹CDNæœ‰äº†è§£çš„æœ‹å‹éƒ½çŸ¥é“ï¼ŒCDNæœåŠ¡å™¨åˆ†æ•£åœ¨å…¨å›½æˆ–å…¨ä¸–ç•Œå„åœ°ï¼Œå½“ç”¨æˆ·è¯·æ±‚è¿™ä¸ªèµ„æºçš„æ—¶å€™ï¼Œè¯·æ±‚ä¼šè¢«è·¯ç”±åˆ°ç¦»ç”¨æˆ·æœ€è¿‘çš„CDNæœåŠ¡å™¨ä¸Šã€‚å½“CDNæœåŠ¡å™¨ä¸Šè¿˜æ²¡æœ‰ç¼“å­˜è¯·æ±‚çš„èµ„æºæ—¶ï¼Œè¿™æ—¶å€™æœ‰ä¸ªæº¯æºçš„è¿‡ç¨‹ã€‚å°±æ˜¯åŸå§‹æ–‡ä»¶ä»æ–‡ä»¶æœåŠ¡å™¨ä¼ é€åˆ°è¯¥CDNæœåŠ¡å™¨çš„ä¸€ä¸ªè¿‡ç¨‹ã€‚è¿™æ—¶ï¼Œç”¨æˆ·æœ‰ä¸€ä¸ªé¢å¤–çš„ç­‰å¾…ï¼Œç­‰å¾…æ—¶é—´å–å†³äºæ–‡ä»¶å¤§å°å’ŒCDNæœåŠ¡å™¨å’Œæ–‡ä»¶æœåŠ¡å™¨é—´çš„å¸¦å®½ã€‚&lt;/p>
&lt;p>å¾®ä¿¡ç”¨æ¥ç»™å…¬ä¼—å·æ”¾ç½®ä¸´æ—¶ç´ æçš„CDNåœ¨è¿™ä¸€å—å‡ºäº†é—®é¢˜ã€‚åœ¨æˆ‘ä»¬çš„æµ‹è¯•ä¸­ï¼Œå¾®ä¿¡CDNå¯èƒ½ä¸€ç›´æ— æ³•æä¾›è¿™äº›ä¸´æ—¶ç´ æï¼ˆæŸäº›æ–‡ä»¶è¶…è¿‡1å¤©åä»ç„¶æ— æ³•è®¿é—®ï¼‰ã€‚è€Œä¸”å‡ºç°é”™è¯¯çš„å‡ ç‡ç›¸å½“é«˜ï¼Œè‡³å°‘20%ä»¥ä¸Šã€‚ç”±äºCDNæ— æ³•ä¸ºä¸´æ—¶ç´ ææä¾›å¯é çš„è®¿é—®ä¿éšœï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—å‡ºå¾®ä¿¡ç»™å…¬ä¼—å·ä¸´æ—¶ç´ æè¿™ä¸ªåŠŸèƒ½åŸºæœ¬å°±æ˜¯ä¸èƒ½ç”¨ã€‚&lt;/p></description></item><item><title>å•é¡µé¢åº”ç”¨(single page application)ä¸­ä½¿ç”¨å¾®ä¿¡æ”¯ä»˜</title><link>https://kane.mx/posts/2016/single-page-app-meets-weixin-pay/</link><pubDate>Sun, 24 Jan 2016 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2016/single-page-app-meets-weixin-pay/</guid><description>&lt;p>éšç€&lt;strong>AngularJS&lt;/strong>ç­‰å‰ç«¯MVCæ¡†æ¶çš„æµè¡Œï¼ŒAJAXçš„å¼‚æ­¥è¯·æ±‚æ•°æ®ç»“åˆH5çš„push stateç­‰ç‰¹æ€§ï¼Œæå¤§çš„æ”¹å–„äº†ç½‘ç«™çš„ç”¨æˆ·ä½“éªŒå’Œé¡µé¢åŠ è½½æ€§èƒ½ã€‚è¿™ç±»ç½‘ç«™åº”ç”¨é€šå¸¸åªæœ‰ä¸€ä¸ªå…¥å£é¡µé¢ï¼Œé€šè¿‡åº”ç”¨å†…è·¯ç”±åˆ°ä¸åŒçš„é¡µé¢ï¼Œæ‰€ä»¥ä¿—ç§°å•é¡µé¢(signle page application)åº”ç”¨ã€‚é¡µé¢&lt;strong>URL&lt;/strong>çœ‹èµ·æ¥å¦‚ä¸‹ï¼Œ&lt;/p>
&lt;blockquote>
&lt;ul>
&lt;li>ç½‘ç«™é¦–é¡µ
&lt;a href="http://mysite.com/#/index">http://mysite.com/#/index&lt;/a>&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;blockquote>
&lt;ul>
&lt;li>å•†å“åˆ—è¡¨é¡µ
&lt;a href="http://mysite.com/#/goods/list">http://mysite.com/#/goods/list&lt;/a>&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;blockquote>
&lt;ul>
&lt;li>å•†å“è¯¦æƒ…é¡µ
&lt;a href="http://mysite.com/#/goods/skuid">http://mysite.com/#/goods/skuid&lt;/a>&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;blockquote>
&lt;ul>
&lt;li>ç½‘ç«™å…³äºé¡µ
&lt;a href="http://mysite.com/#/about">http://mysite.com/#/about&lt;/a>&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;p>å¯¹æµè§ˆå™¨è€Œè¨€ï¼Œä¸Šé¢å‡ ä¸ªåœ°å€éƒ½æ˜¯è®¿é—®çš„ç½‘ç«™**&lt;code>/&lt;/code>**ç›®å½•ï¼Œæ¯ä¸ªurlä¸åŒçš„æ˜¯&lt;code>hash&lt;/code>éƒ¨åˆ†ã€‚è€Œ**AngularJS**æ­£æ˜¯ä¾èµ–é¡µé¢çš„&lt;code>hash&lt;/code>æ¥åšçš„åº”ç”¨å†…è·¯ç”±ï¼Œæ ¹æ®ä¸åŒçš„è·¯ç”±æ¥åŠ è½½ä¸åŒçš„&lt;code>js&lt;/code>å’Œ&lt;code>html&lt;/code>ç‰‡æ®µï¼Œå®ç°åŠ¨æ€å†…å®¹çš„åŠ è½½ã€‚&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;p>ä¸–ä¸Šå¹¶æ²¡æœ‰ç»å¯¹å®Œç¾çš„äº‹æƒ…ï¼Œå•é¡µé¢åº”ç”¨åœ¨ç”¨æˆ·ä½“éªŒå’Œæ€§èƒ½ä¸Šè·å¾—äº†å¥½å¤„ã€‚ç„¶è€Œï¼Œåœ¨åˆ«çš„åœ°æ–¹å¿…ç„¶ä»˜å‡ºä»£ä»·ã€‚è¿™é‡Œå°±åˆ†äº«ä¸€ä¸‹å•é¡µé¢åº”ç”¨å’Œå¾®ä¿¡æ”¯ä»˜é›†æˆçš„ä¸€äº›ç»éªŒã€‚&lt;/p>
&lt;p>è¿™é‡Œçš„å¾®ä¿¡æ”¯ä»˜æŒ‡çš„æ˜¯ï¼Œåœ¨å¾®ä¿¡æµè§ˆå™¨ä¸­é€šè¿‡JSæ¥å£è°ƒèµ·å¾®ä¿¡æ”¯ä»˜æ¥å®Œæˆç½‘é¡µåº”ç”¨ä¸­å•†å“çš„è´­ä¹°ã€‚å¾®ä¿¡æ”¯ä»˜æœ¬èº«çš„å¼€å‘é›†æˆå¹¶ä¸å¤æ‚ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚å¾®ä¿¡æ”¯ä»˜å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œè¦æ±‚å…¬ä¼—å·å¿…é¡»æ³¨å†Œæ”¯ä»˜å‘èµ·é¡µé¢çš„åœ°å€ï¼ˆåˆ°æ”¯ä»˜é¡µé¢çš„ä¸Šçº§ç›®å½•ä¸ºæ­¢ï¼‰ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ·»åŠ åˆ°ç™½åå•çš„åœ°å€ä¸è¶…è¿‡3ä¸ªã€‚ä¹Ÿå°±æ˜¯å¦‚æœåº”ç”¨åœ¨&lt;em>å•†å“è¯¦æƒ…é¡µ&lt;/em>å‘èµ·æ”¯ä»˜è¯·æ±‚ï¼Œé‚£ä¹ˆåœ°å€**&lt;code>http://mysite.com/#/goods/&lt;/code>**å¿…é¡»åœ¨ç™½åå•åˆ—è¡¨ã€‚&lt;/p>
&lt;p>ç›®å‰ä¸ºæ­¢ï¼Œä¸€åˆ‡éƒ½å¾ˆå¥½ç†è§£ï¼ŒæŠŠæ”¯ä»˜é¡µé¢åŠ åˆ°å¾®ä¿¡æ”¯ä»˜ç™½åå•ä¸å°±ä¸‡äº‹å¤§å‰äº†ã€‚å¯ç»è¿‡å®æµ‹ï¼Œäº‹å®ç¡®ä¸æ˜¯è¿™ä¹ˆç®€å•ï¼&lt;/p>
&lt;p>åœ¨å¾®ä¿¡&lt;strong>iOS&lt;/strong>ç‰ˆæœ¬ä¸­ï¼Œå¾®ä¿¡æ”¯ä»˜JSä¼šé”™è¯¯çš„ä½¿ç”¨landingç½‘ç«™é¡µé¢çš„URLï¼Œè€Œä¸æ˜¯å‘èµ·æ”¯ä»˜çš„é¡µé¢URLï¼æ¯”å¦‚ç”¨æˆ·é€šè¿‡ç½‘ç«™é¦–é¡µ**&lt;code>http://mysite.com/#/index&lt;/code>**è¿›å…¥åº”ç”¨ï¼Œé€šè¿‡ç«™å†…é“¾æ¥æµè§ˆåˆ°äº†æŸå•†å“è¯¦æƒ…é¡µ**&lt;code>http://mysite.com/#/goods/skuid&lt;/code>**å¹¶å‘èµ·äº†æ”¯ä»˜ã€‚ä½†å¾®ä¿¡JSä¼šæŠŠlandingé¡µé¢URL**&lt;code>http://mysite.com/#/index&lt;/code>**åˆ¤å®šä¸ºæ”¯ä»˜çš„å‘èµ·é¡µé¢ï¼Œä»è€Œå¯¼è‡´æ”¯ä»˜JSè°ƒç”¨å¤±è´¥ï¼&lt;/p>
&lt;p>å› ä¸ºåº”ç”¨å­˜åœ¨å¤šä¸ªé¡µé¢ï¼Œä¸å¯èƒ½æŠŠæ‰€æœ‰çš„é¡µé¢éƒ½åŠ åˆ°æ”¯ä»˜ç™½åå•ä¸­(æœ‰3ä¸ªæ•°ç›®é™åˆ¶ï¼Œå¹¶ä¸”å·¥ä½œé‡ä¹Ÿå¤§åˆ°ä¸ç°å®)ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåªå¥½å¦è¾Ÿè¹Šå¾„ã€‚æˆ‘ç›®å‰æ‰¾åˆ°çš„æ–¹æ³•æ˜¯ï¼Œå¼ºåˆ¶åˆ·æ–°é¡µé¢å½“æ‰“å¼€å•†å“è¯¦æƒ…é¡µçš„æ—¶å€™ã€‚ç­‰åŒäºç›´æ¥åœ¨å¾®ä¿¡æµè§ˆå™¨ä¸­æ‰“å¼€äº†å•†å“è¯¦æƒ…é¡µã€‚è™½ç„¶å¯¹ç”¨æˆ·ä½“éªŒæœ‰äº›å½±å“ï¼Œä½†æ”¯ä»˜åŠŸèƒ½æ­£å¸¸å·¥ä½œäº†ã€‚&lt;/p></description></item><item><title>æ–‡ä»¶ç³»ç»Ÿçš„Inodeè€—å°½ï¼Œä¼šå¯¼è‡´Dockerç¼–è¯‘é•œåƒå‡ºç°'No space left on device'é”™è¯¯</title><link>https://kane.mx/posts/2016/docker-build-no-space-left-caused-by-inode-exhausted/</link><pubDate>Thu, 21 Jan 2016 00:00:00 +0000</pubDate><guid>https://kane.mx/posts/2016/docker-build-no-space-left-caused-by-inode-exhausted/</guid><description>&lt;p>æœ€è¿‘åœ¨æäº¤å‰ç«¯ä»£ç åï¼Œå‰ç«¯ä»£ç çš„è‡ªåŠ¨å‘å¸ƒè€æ˜¯å¤±è´¥ã€‚å¤±è´¥çš„åŸå› å¤šæ˜¯ç¼–è¯‘Dockeré•œåƒæ—¶åœ¨æ‰§è¡Œ&lt;code>COPY&lt;/code>è¯­å¥æ‹·è´æ–‡ä»¶åˆ°é•œåƒæ–‡ä»¶ç³»ç»Ÿæ—¶ï¼Œæ‰”å‡ºäº†&amp;rsquo;No space left on device&amp;rsquo;è¿™ä¸ªé”™è¯¯ã€‚è¿™ä¸ªé”™è¯¯æ ¹æ®æè¿°éå¸¸å¥½ç†è§£ï¼Œå°±æ˜¯dockeræ–‡ä»¶ç³»ç»Ÿæ‰€åœ¨ç£ç›˜æ²¡æœ‰äº†ç©ºé—´ã€‚&lt;/p>
&lt;p>ä½†æ˜¯é€šè¿‡&lt;code>df -h&lt;/code>å‘½ä»¤ï¼Œè¯¥ç£ç›˜è‡³å°‘è¿˜æœ‰3ï¼Œ4ä¸ªGçš„å‰©ä½™ç©ºé—´ã€‚è€Œå‰ç«¯é•œåƒçš„æ–‡ä»¶å¤§å°æœ€å¤šä¹Ÿä¸è¶…è¿‡300Mã€‚åœ¨è¯¥ç£ç›˜é€šè¿‡&lt;code>touch&lt;/code>,&lt;code>cp&lt;/code>ä»ç„¶å¯ä»¥åˆ›å»ºæ–‡ä»¶ã€‚&lt;/p>
&lt;p>æ‰€ä»¥è¿™ä¸ªé—®é¢˜éå¸¸å¥‡æ€ªï¼Œä¸ºä»€ä¹ˆ&lt;code>docker&lt;/code>æˆ–è€…&lt;code>æ“ä½œç³»ç»Ÿ&lt;/code>æŠ±æ€¨ç£ç›˜æ²¡æœ‰äº†ç©ºé—´ï¼Ÿåœ¨ç£ç›˜ä»ç„¶å‰©ä½™æ•°ä¸ªGçš„æƒ…å†µä¸‹ï¼Ÿ&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;p>å†é€šè¿‡ç›¸å…³çš„æŸ¥æ‰¾åï¼Œdockerçš„è¿™ä¸ª&lt;a href="https://github.com/docker/docker/issues/18144">issue&lt;/a>ç»™äº†æˆ‘å¯å‘ã€‚Linuxæ–‡ä»¶ç³»ç»Ÿçš„&lt;code>inode&lt;/code>åœ¨è€—å°½åï¼Œè¯¥æ–‡ä»¶ç³»ç»Ÿå°†ä¸èƒ½å†åˆ›å»ºæ–°æ–‡ä»¶ã€‚å› ä¸ºå‰ç«¯é¡µé¢æ˜¯åŸºäº&lt;code>nodejs&lt;/code>çš„ç¨‹åºï¼Œå®ƒä¾èµ–çš„packagesäº§ç”Ÿäº†å¤§é‡æ–‡ä»¶ï¼Œåœ¨åå¤åˆ¶ä½œä¸åŒçš„docker imagesæ—¶ï¼Œè¿™äº›ä¾èµ–æ–‡ä»¶åˆè¢«åå¤å¤åˆ¶ï¼Œå¯¼è‡´æ–‡ä»¶æ•°é‡è¿œè¿œè¶…è¿‡äº†é»˜è®¤inodeå’Œç£ç›˜å¤§å°çš„æ¯”ä¾‹ï¼Œæœ€ç»ˆ&lt;code>inode&lt;/code>å…ˆäºç£ç›˜ç©ºé—´è¢«å…¨éƒ¨ä½¿ç”¨ã€‚&lt;/p>
&lt;p>é‡åˆ°ç±»ä¼¼é—®é¢˜çš„åŒå­¦ï¼Œå¯ä»¥é€šè¿‡&lt;code>df -i&lt;/code>æŸ¥çœ‹&lt;code>inode&lt;/code>çš„ä½¿ç”¨æƒ…å†µæ¥æ’æŸ¥é—®é¢˜æ˜¯å¦ç”±äº&lt;code>inode&lt;/code>è€—å°½å¯¼è‡´è¿™ä¸ªé”™è¯¯ã€‚&lt;/p></description></item><item><title>Daemon hell in Jenkins</title><link>https://kane.mx/posts/archive/blogspot/daemon-hell-in-jenkins/</link><pubDate>Tue, 21 Jul 2015 09:32:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/daemon-hell-in-jenkins/</guid><description>&lt;p>Recently I wrote a Linux like &lt;a href="https://gist.github.com/zxkane/b55033bd519334d57c13">initd script&lt;/a> to start/stop my web application.&lt;/p>
&lt;p>The script works well when running it in shell of linux. The web application will run in background by daemon.&lt;/p>
&lt;p>However I found both daemon and web application(java) exited immediately if I started the script in Jenkins as a shell step of build process.&lt;/p>
&lt;p>I put below simple script in &amp;lsquo;Execute shell&amp;rsquo; block,&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">
daemon --name&lt;span style="color:#f92672">=&lt;/span>test-daemon -- sleep 200sleep &lt;span style="color:#ae81ff">60&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;p>The process &amp;lsquo;daemon&amp;rsquo; and &amp;lsquo;sleep 200&amp;rsquo; should exit after 200 seconds the &amp;lsquo;sleep&amp;rsquo; exits. The jenkins job will be finished in 60 secs.&lt;/p>
&lt;pre>&lt;code>jenkins Â  9954 Â 9950 Â 0 21:48 ? Â  Â  Â  Â 00:00:00 sleep 60
jenkins Â  9955 Â  Â  1 Â 0 21:48 ? Â  Â  Â  Â 00:00:00 daemon â€”name=test-daemon â€” sleep 200
jenkins Â  9956 Â 9955 Â 0 21:48 ? Â  Â  Â  Â 00:00:00 sleep 200
&lt;/code>&lt;/pre>
&lt;p>Above is the process info queried via &lt;code>ps&lt;/code> command. The father pid of daemon is 1, not the script generated by Jenkins.&lt;br>
But both the process &amp;lsquo;daemon&amp;rsquo; and &amp;lsquo;sleep 200&amp;rsquo; immediately exited when the script finished. Should be something wrong in Jenkins to cause daemon exited unexpected.&lt;/p>
&lt;p>It&amp;rsquo;s something really frustrating to use daemon to stop/start the web application in Jenkins.&lt;/p>
&lt;p>Finally I used &lt;strong>docker&lt;/strong> container to run my web application, which easily can be stopped/started via script in Jenkins.&lt;/p></description></item><item><title>The symptoms of Java broken in Mac OSX 10.10 and fix solution</title><link>https://kane.mx/posts/archive/blogspot/the-symptoms-of-java-broken-in-mac-osx/</link><pubDate>Mon, 13 Jul 2015 19:11:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/the-symptoms-of-java-broken-in-mac-osx/</guid><description>&lt;p>After uninstalling some applications from my Mac OSX, I found the applications that depends on JRE totally does not work. I noticed below symptoms,&lt;/p>
&lt;ol>
&lt;li>Eclipse Mars can not be launched, even though I specified the launching vm to another one(`java -version` still work). The SWT native library failed to resolve the dependencies to &amp;lsquo;/System/Library/Frameworks/JavaVM.framework/Versions/A/JavaVM&amp;rsquo; which does not exists.&lt;/li>
&lt;li>I tried to reinstall Oracle 1.8.0_u45 via both brew and dmg image downloaded from Oracle website, both ways were failed as well.&lt;/li>
&lt;li>The Mac pkg Installer can not be started due to dylib broken. It means I can&amp;rsquo;t install any pkg via GUI. The command line(such as &lt;code>sudo installer -verboseR -target / -pkg /Volumes/OS\ X\ 10.10.4\ Update\ Combo/OSXUpdCombo10.10.4.pkg&lt;/code>) still works.&lt;/li>
&lt;/ol>
&lt;p>Finally I realized the problem was caused by I uninstalled the out of date Apple Java 6. Looks like all of above failures are required the system built-in Java. It really does not make sense the Oracle 1.8 installer script to depend on the out of date Java.&lt;/p>
&lt;p>Finally I reinstalledÂ &lt;a href="https://support.apple.com/kb/DL1572?locale=en_US">Java for OS X 2014-001&lt;/a> to make everything working again. The GUI installer for pkg still does not work, you need use below command to use the pkg.&lt;/p>
&lt;p>sudo installer -verboseR -target / -pkg /Volumes/Java\ for\ OS\ X\ 2014-001/JavaForOSX.pkg&lt;/p></description></item><item><title>Run groovy script via Jenkins CLI</title><link>https://kane.mx/posts/archive/blogspot/run-groovy-script-via-jenkins-cli/</link><pubDate>Mon, 13 May 2013 13:44:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/run-groovy-script-via-jenkins-cli/</guid><description>&lt;p>Jenkins supports &lt;a href="https://wiki.jenkins-ci.org/display/JENKINS/Jenkins+SSH">ssh authentication&lt;/a> in CLI.&lt;/p>
&lt;p>Below is a command to verify that I am authenticated:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">
java -jar jenkins-cli.jar -sÂ http://myserver/jenkinsÂ who-am-i
Â  Â  Authenticated as: myuser
Â  Â  Authorities:
Â  Â  Â  Â  authenticated&lt;/code>&lt;/pre>&lt;/div>
&lt;p>However you still would meet permission error when running groovy script in CLI.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">
java -jar jenkins-cli.jar -sÂ http://myserver/jenkinsÂ groovysh &lt;span style="color:#e6db74">&amp;#39;jenkins.model.Jenkins.instance.pluginManager.plugins.each { println(&amp;#34;${it.longName} - ${it.version}&amp;#34;) };&amp;#39;&lt;/span>
Exception in thread &lt;span style="color:#e6db74">&amp;#34;main&amp;#34;&lt;/span> java.lang.reflect.UndeclaredThrowableException
at $Proxy2.main&lt;span style="color:#f92672">(&lt;/span>Unknown Source&lt;span style="color:#f92672">)&lt;/span>
at hudson.cli.CLI.execute&lt;span style="color:#f92672">(&lt;/span>CLI.java:271&lt;span style="color:#f92672">)&lt;/span>
at hudson.cli.CLI._main&lt;span style="color:#f92672">(&lt;/span>CLI.java:417&lt;span style="color:#f92672">)&lt;/span>
at hudson.cli.CLI.main&lt;span style="color:#f92672">(&lt;/span>CLI.java:322&lt;span style="color:#f92672">)&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;p>It&amp;rsquo;s a bug of Jenkins. &lt;strong>The workaround is create a groovy script, then run that script via Jenkins CLI&lt;/strong>.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">
java -jar jenkins-cli.jar -sÂ http://myserver/jenkins/Â groovyÂ test_script.gsh&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Solr boost examples</title><link>https://kane.mx/posts/archive/blogspot/solr-boost-examples/</link><pubDate>Sat, 11 May 2013 13:16:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/solr-boost-examples/</guid><description>&lt;p>The index has a field named &amp;lsquo;create_time&amp;rsquo; that is the timestamp of document created time. The query string can boost the latest created document like below,&lt;/p>
&lt;p>{!boost b=recip(ms(NOW,create_time),3.16e-11,0.08,0.05)}name:keyword&lt;/p>
&lt;p>There is another field named &amp;lsquo;important&amp;rsquo; that indicates whether the document is important or not. The query string can boost the document is important like below,&lt;/p>
&lt;p>q={!boost b=$importfunc}name:keyword&amp;amp;importfunc=query({!v=&amp;lsquo;important:true&amp;rsquo;})&lt;/p>
&lt;p>Above query string uses a sub query in boost function.&lt;/p>
&lt;p>Finally I want to boost both above two fields, and &amp;lsquo;important&amp;rsquo; field has higher priority. The query string looks like below,&lt;/p>
&lt;p>defType=edismax&amp;amp;q=name:keyword&amp;amp;bf=query({!v=&amp;lsquo;import:true&amp;rsquo;})^20.0 recip(ms(NOW,create_time),3.16e-11,0.08,0.05)^10.0&amp;quot;)&lt;/p></description></item><item><title>Django's unicdoe encode error</title><link>https://kane.mx/posts/archive/blogspot/djangos-unicdoe-encode-error/</link><pubDate>Thu, 16 Aug 2012 09:11:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/djangos-unicdoe-encode-error/</guid><description>&lt;p>It&amp;rsquo;s a common and ugly problem when using non-ascii characters in Django.&lt;/p>
&lt;p>The general solution is below,&lt;/p>
&lt;ol>
&lt;li>put &lt;strong># -&lt;em>- coding: utf-8 -&lt;/em>-&lt;/strong> at beginning of every python source files that are using utf-8 characters&lt;/li>
&lt;li>declare every string variable as unicode, such as &lt;strong>str_var = u&amp;rsquo;ä¸­æ–‡å­—ç¬¦'&lt;/strong>&lt;/li>
&lt;li>add &lt;a href="https://docs.djangoproject.com/en/1.4/ref/models/instances/#django.db.models.Model.__unicode__">a __unicode__&lt;/a> method in your model classes&lt;/li>
&lt;li>if you are running server on apache/mod_wsgi or ngnix, you need &lt;a href="https://docs.djangoproject.com/en/1.4/howto/deployment/modpython/#if-you-get-a-unicodeencodeerror">configure web server to use utf-8 encoding&lt;/a>&lt;/li>
&lt;/ol></description></item><item><title>The workaround of making Zend CE/Zend debugger work on mountain lion</title><link>https://kane.mx/posts/archive/blogspot/workaround-of-making-zend-ce-mountain-lion/</link><pubDate>Sat, 28 Jul 2012 20:49:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/workaround-of-making-zend-ce-mountain-lion/</guid><description>&lt;p>I installed both Zend CE and zend debugger of Eclipse on my Mac. Both of them work well in Mac lion.Â  However they don&amp;rsquo;t work any more after I upgraded my Mac to mountain lion.Â &lt;/p>
&lt;p>After some investigation I found some extensions of Zend PHP can&amp;rsquo;t be loaded due to shared library dependency can&amp;rsquo;t be found in mountain lion. The &lt;strong>xslt&lt;/strong> module of PHP depends on some system libraries(suc as /usr/local/libxslt-1.1.23/lib/libxslt.1.dylib) that have been removed by mountain lion.&lt;/p>
&lt;p>The temporary solution is disabling &lt;strong>xlst module&lt;/strong> of zend PHP if your application doesn&amp;rsquo;t need them.Â &lt;/p>
&lt;p>The workaround fix of Zend CE on Mac,Â &lt;/p>
&lt;blockquote>
&lt;p>rename &lt;em>&lt;strong>/usr/local/zend/lib/php_extensions/xsl.so&lt;/strong>&lt;/em> to any other name&lt;/p>
&lt;/blockquote>
&lt;p>The workaround fix of zend debugger for Eclipse,Â &lt;/p>
&lt;blockquote>
&lt;p>Delete the line &lt;em>extension=xsl.so&lt;/em> from file &lt;strong>&lt;!-- raw HTML omitted -->/plugins/org.zend.php.debug.debugger.macosx_5.3.18.v20110322/resources/php53/php.ini&lt;/strong>&lt;/p>
&lt;/blockquote></description></item><item><title>Dual monitors on Ubuntu</title><link>https://kane.mx/posts/archive/blogspot/dual-monitors-on-ubuntu/</link><pubDate>Mon, 19 Mar 2012 20:04:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/dual-monitors-on-ubuntu/</guid><description>&lt;p>I had two monitors for my workstation. One is 22' and the another is 17'. I used the small one as a extend desktop.&lt;/p>
&lt;p>Today I get a another 23' monitor to replace the small one. However the resolution of the 23' monitor can&amp;rsquo;t be changed after pluging it in. It always used the resolution matching the 17' one.&lt;/p>
&lt;p>Both &amp;lsquo;Setting - Display&amp;rsquo; and &amp;lsquo;AMD Catalyst control&amp;rsquo; can&amp;rsquo;t adjust it as higher resolution.&lt;/p>
&lt;p>After some tuning, I found a workaround.&lt;/p>
&lt;p>I totally remove all config of small one from &lt;strong>/etc/X11/xorg.conf&lt;/strong>. Then change its resolution in &amp;lsquo;AMD Catalyst control&amp;rsquo;, it works!&lt;/p></description></item><item><title>Embedding an HTTP server in Equinox</title><link>https://kane.mx/posts/archive/blogspot/embedding-http-server-in-equinox/</link><pubDate>Mon, 05 Mar 2012 19:25:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/embedding-http-server-in-equinox/</guid><description>&lt;p>I want to create a test server for my application. Using embedding Http server in equinox is my first option.&lt;/p>
&lt;p>I had experience using simple http service implementation of equinox, however I want to play with Jetty this time.&lt;/p>
&lt;p>Following &lt;a href="http://www.eclipse.org/equinox/server/http_in_equinox.php">the guide&lt;/a> of Equinox server, I can&amp;rsquo;t running a Jetty server with my servlet in Eclipse Indigo. Obviously &lt;a href="http://www.eclipse.org/equinox/server/http_in_equinox.php">the guide&lt;/a> is out of date.&lt;/p>
&lt;p>After tuning it, I found below bundles are minimum collection to run Jetty inside OSGi runtime.&lt;br>
&lt;script type="application/javascript" src="https://gist.github.com/zxkane/1977922.js?file=embedded-jetty-osgi">&lt;/script>
&lt;/p>
&lt;p>You only need create a run configuration of OSGi framework, add your bundles with servlets and above bundles.&lt;/p></description></item><item><title>Acess Intranet without VPN</title><link>https://kane.mx/posts/archive/blogspot/acess-intranet-without-vpn/</link><pubDate>Fri, 17 Feb 2012 17:47:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/acess-intranet-without-vpn/</guid><description>&lt;p>Sometimes I need access the Intranet of company, however I don&amp;rsquo;t like to create VPN connection. The connection is slow, waste time to create the connection and have to change password due to security policy.&lt;/p>
&lt;p>My workstation is Linux, which has a lot of utility tools to help me access Intranet at home without VPN.&lt;/p>
&lt;p>Firstly I set up a ssh server on my personal computer. It&amp;rsquo;s quite easy if you are using Linux, for Windows I installed &lt;a href="https://www.itefix.no/i2/copssh">Copssh&lt;/a>.&lt;br>
Then register a free domain name and configure it in my router. And let router forward port &lt;code>22&lt;/code>(or any port you wan to use) to my personal computer.&lt;br>
In my working Linux machine, create a ssh tunnel to my personal computer. Must use the &lt;a href="https://kane.mx/posts/archive/blogspot/ssh-key/">public/private key for authenticating&lt;/a>. For example,&lt;/p>
&lt;script type="application/javascript" src="https://gist.github.com/zxkane/1876750.js?file=ssh-tunnel0.sh">&lt;/script>
&lt;p>It means remote server can access my workstation&amp;rsquo;s port &lt;code>22&lt;/code> via accessing its port &lt;code>1002&lt;/code> after the ssh tunnel is created successfully. Above command line also forwards the ports &lt;code>5900&lt;/code> and &lt;code>6500&lt;/code>. The default VNC session will listen the port &lt;code>5900&lt;/code>.&lt;br>
But it only works when my personal computer is running. And the connection can&amp;rsquo;t be reconnected after it fails once.&lt;br>
The graceful solution is installing &amp;lsquo;autossh&amp;rsquo; in my Linux, which is an utility to retry the ssh connection with an interval if it&amp;rsquo;s disconnected or failed.&lt;/p>
&lt;script type="application/javascript" src="https://gist.github.com/zxkane/1876750.js?file=ssh-tunnel1.sh">&lt;/script>
&lt;p>Then create a script and running it when OS is booted. The script will be executed by root user, so we need configure it ran by the normal user.&lt;/p>
&lt;script type="application/javascript" src="https://gist.github.com/zxkane/1876750.js?file=ssh-tunnel2.sh">&lt;/script>
&lt;p>After my personal computer is booted a while(&lt;strong>the default interval of autossh is 300 seconds&lt;/strong>), I can use &lt;code>localhost:10002&lt;/code> to login my workstation, &lt;code>localhost:5900&lt;/code> to access my VNC session. Of course you can use &amp;lsquo;froxyproxy&amp;rsquo; of Firefox via a localport to access web page of Intranet.&lt;/p></description></item><item><title>How to reuse the existing OpenID accounts after the host name of Gerrit server is changed</title><link>https://kane.mx/posts/archive/blogspot/how-to-reuse-existing-openid-accounts/</link><pubDate>Wed, 15 Feb 2012 11:36:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/how-to-reuse-existing-openid-accounts/</guid><description>&lt;p>An internal Gerrit server was moved, so the hostname of server is changed. However we are using OpenID for user control, the OpenID provider(such as Google account) will generate a new token for the new server(hostname changing will impact the identity token of Google account) when we login Gerrit with same OpenID account. Gerrit will create a new internal account by default even though my OpenID account has existed in the system and has a lot of activities.&lt;/p>
&lt;p>The solution is updating the &amp;lsquo;ACCOUNT_EXTERNAL_IDS&amp;rsquo; table of Gerrit via gsql. Setting the &amp;lsquo;ACCOUNT_ID&amp;rsquo; to your existing account_id for the new record whose &amp;lsquo;EXTERNAL_ID&amp;rsquo; is the new token gotten from Google.&lt;/p>
&lt;blockquote>
&lt;p>update ACCOUNT_EXTERNAL_IDS set ACCOUNT_ID=&amp;lsquo;1000001&amp;rsquo; where EXTERNAL_ID=&amp;lsquo;&lt;a href="https://www.google.com/accounts/o8/id?id=xxxxxxxxxx';">https://www.google.com/accounts/o8/id?id=xxxxxxxxxx';&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>Then search the documentation of Gerrit, I find a configuration property looks like supporting such a migration for OpenID authentication.&lt;/p>
&lt;blockquote>
&lt;p>auth.allowGoogleAccountUpgrade&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>Allows Google Account users to automatically update their Gerrit account when/if their Google Account OpenID identity token changes. Identity tokens can change if the server changes hostnames, or for other reasons known only to Google. The upgrade path works by matching users by email address if the identity is not present, and then changing the identity.&lt;/p>
&lt;p>This setting also permits old Gerrit 1.x users to seamlessly upgrade from Google Accounts on Google App Engine to OpenID authentication.&lt;/p>
&lt;p>Having this enabled incurs an extra database query when Google Account users register with the Gerrit server.&lt;/p>
&lt;p>By default, unset/false.&lt;/p>
&lt;/blockquote></description></item><item><title>JRE/JDK's certificate issue and solution</title><link>https://kane.mx/posts/archive/blogspot/jrejdks-certificate-issue-and-solution/</link><pubDate>Thu, 24 Nov 2011 15:58:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/jrejdks-certificate-issue-and-solution/</guid><description>&lt;p>The problem came from I tried to set up send mail server(SMTP) for my Gerrit server. My Gerrit server is using OpenID for user authorization, so I registered a new email account to send notification from Gerrit.&lt;/p>
&lt;p>Most of email service providers require the secure authorization when using its SMTP server to send mail. However the root CA of my email provider is not added into the default certificate of JRE. So Gerrit always failed to send email due to ssl verification exception.&lt;/p>
&lt;p>My solution is adding the certificate of SMTP server into the certificate used by JRE.&lt;/p>
&lt;p>The detail steps are below,&lt;/p>
&lt;ol>
&lt;li>
&lt;p>Use &lt;strong>open_ssl&lt;/strong> utility to the certificate of SMTP server or its root CA of email provider. Below command can list the certificate of SMTP and its chain. You can paste any of them into a file.&lt;/p>
&lt;p>openssl s_client -connect smtp.163.com:465&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Then import the certificate saved in previous step into my JRE&amp;rsquo;s key store. The default password of JRE&amp;rsquo;s default keystore is &amp;lsquo;&lt;strong>changeit&lt;/strong>&amp;rsquo;. You can find the &lt;em>cacerts&lt;/em> under jre/lib/security folder.&lt;/p>
&lt;p>sudo keytool -import -keystore cacerts -alias Smtp163com -file /tmp/smtp.163.PEM&lt;/p>
&lt;/li>
&lt;/ol></description></item><item><title>The tips of Maven/Tycho building crossplatform RCP and repository</title><link>https://kane.mx/posts/archive/blogspot/tips-of-maventycho-building/</link><pubDate>Tue, 08 Nov 2011 16:16:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/tips-of-maventycho-building/</guid><description>&lt;p>I successfully converted our product build from PDE build to Maven/Tycho. Something is worth to be documented here.&lt;/p>
&lt;p>There are several examples and posts to demonstrate how using Tycho building your Eclipse plug-ins, features, applications and products. The most helpful example is the &lt;a href="http://git.eclipse.org/c/tycho/org.eclipse.tycho.git/tree/tycho-demo">demo&lt;/a> of Tycho project.&lt;/p>
&lt;p>Below are some traps I met when building my project by Tycho,&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>product build&lt;/strong>&lt;br>
Our product is based on plug-ins, however we added the &amp;lsquo;&lt;strong>featurelist&lt;/strong>&amp;rsquo; in build.properties of PDE build to include some root binary for the product. However Tycho doesn&amp;rsquo;t support this type of build, we create some features as the placeholder of plug-ins. Then change the product as features based. You have to manually remove the &lt;strong>plugins&lt;/strong> tag in .product definition file, otherwise Tycho will fail on strange error if the .produce has both &lt;strong>features&lt;/strong> and &lt;strong>plugins&lt;/strong> tag. Then configure the director plugin as not installing features.&lt;/p>
&lt;p>org.eclipse.tycho&lt;br>
tycho-p2-director-plugin&lt;br>
${tycho-version}&lt;br>
materialize-products&lt;br>
materialize-products&lt;br>
false&lt;br>
myappprofile&lt;br>
archive-products&lt;br>
archive-products&lt;/p>
&lt;p>And I used below way to customize the qualifier string of our build.&lt;/p>
&lt;pre>&lt;code>org.eclipse.tycho
tycho-packaging-plugin
${tycho-version}
'${qualifier-prefix}_'yyyyMMddHHmm
&lt;/code>&lt;/pre>
&lt;p>An limitation of director plugin is that no way using different profile name for the application installed on different hosts. I contributed a patch on &lt;a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=362550">bug 362550&lt;/a> for this enhancement.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>feature build&lt;/strong>&lt;br>
We have some features to pack some binary files as root files. But Tycho doesn&amp;rsquo;t support root folder that is recognized by PDE build. The workaround is creating an additional folder, then put the root files into it.&lt;br>
Meanwhile Tycho doesn&amp;rsquo;t support wildcard to other native touch points, such as changing the files permission. For static file list use comma separated list as workaround.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>eclipse test plug-in&lt;/strong>&lt;br>
I have a plug-in whose scope is &amp;lsquo;test&amp;rsquo;, but it doesn&amp;rsquo;t have test case and no dependency for any test framework, such as junit 3.8 or junit 4. And it&amp;rsquo;s used for mocking test server. Configure surefire plugin to let it build as test plug-in as well.&lt;/p>
&lt;p>org.eclipse.tycho&lt;br>
tycho-surefire-plugin&lt;br>
${tycho-version}&lt;br>
junit&lt;br>
junit&lt;br>
4.1&lt;/p>
&lt;pre>&lt;code> false
&lt;/code>&lt;/pre>
&lt;p>junit&lt;br>
junit&lt;br>
4.1&lt;/p>
&lt;p>And configure the surefire plugin like below to test code in Maven build.&lt;/p>
&lt;p>org.eclipse.tycho&lt;br>
tycho-surefire-plugin&lt;br>
${tycho-version}&lt;br>
my.group&lt;br>
my.feature&lt;br>
${version}&lt;br>
eclipse-feature&lt;br>
my.group&lt;br>
my.testserver&lt;br>
1.0.0&lt;br>
eclipse-plugin&lt;br>
${testSuiteName}&lt;br>
${testClassName} &lt;br>
-Dcom.sun.management.jmxremote&lt;br>
-consoleLog&lt;br>
org.eclipse.equinox.ds&lt;br>
1&lt;br>
true&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>sign jars&lt;/strong>&lt;br>
Add below signjar plugin into parent pom.xml, however I met the md5 error when materializing the repository built on .product. There is a workaround mentioned on &lt;a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=344691#c11">Bug 344691&lt;/a>.&lt;/p>
&lt;pre>&lt;code> org.apache.maven.plugins
maven-jarsigner-plugin
1.2
${keystore}
MyCompany
${storepass}
${keypass}
true
${skip.jar.signing}
-tsa
https://timestamp.geotrust.com/tsa
**/artifacts.jar
**/content.jar
jar
eclipse-plugin
eclipse-feature
eclipse-test-plugin
sign
sign
verify
verify&lt;/code>&lt;/pre>
&lt;/li>
&lt;/ol></description></item><item><title>Migration Clearcase to Git -- part 2</title><link>https://kane.mx/posts/archive/blogspot/migration-clearcase-to-git-part-2/</link><pubDate>Tue, 25 Oct 2011 19:45:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/migration-clearcase-to-git-part-2/</guid><description>&lt;p>Several days ago I had a post to record the unsuccessful experience to migrate source code from Clearcase to Git.&lt;/p>
&lt;p>We have a new way after doing some brain storms. This way still is not a perfect solution, but it&amp;rsquo;s much better than previous trial.&lt;/p>
&lt;ol>
&lt;li>Use &lt;strong>clearexport_ccase&lt;/strong> to export the source folder to intermittent data. See &lt;a href="http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m1/index.jsp?topic=/com.ibm.rational.clearcase.cc_ref.doc/topics/clearexport_ccase.htm">documentation&lt;/a> of Clearcase admin.&lt;/li>
&lt;li>Create a temporary vob for importing the data later. See &lt;a href="http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m1/index.jsp?topic=/com.ibm.rational.clearcase.tutorial.doc/a_cr_storagecomp_fcc_ux.htm">example&lt;/a>.&lt;/li>
&lt;li>Import the data into temporary vob. See &lt;a href="http://www.philforhumanity.com/ClearCase_Support_38.html">example&lt;/a>.&lt;/li>
&lt;li>Repeat step 1 to 3 for importing all necessary data into temporary vob.&lt;/li>
&lt;li>Use the SVN Importer to import the temporary vob as Subversion repository.&lt;/li>
&lt;li>Last steps refer to a documentation of &lt;a href="http://www.winklerweb.net/index.php/blog/4-eclipse/16-migrating-the-cdo-svn-repository-to-git">succeeded migration case&lt;/a> of one of Eclipse project from Subversion to Git.&lt;/li>
&lt;/ol>
&lt;p>Git definitely is greatest SCM tool now. The size of Subversion repository is around 10GB, finally the Git repository is less than 700MB, which saves more than 10 times disk space. It&amp;rsquo;s awesome!&lt;/p>
&lt;p>The flaw of this way is that the removed elements in Clearcase(said using Main/LATEST as cspec of Clearcase vob when exporting) would lose after importing into a temporary vob. So switching to a maintenance branch or tag like 1.0/2.0 in Git, the source code is incomplete. The files existed in that branch or tag, then removed in latest code base are lost. The workaround could be manually checking in GA version to have complete code.&lt;/p>
&lt;p>If anybody have graceful and perfect solution to migrate Clearcase to Git, I think he could start a new business. :)&lt;/p></description></item><item><title>Migrate Clearcase to Git</title><link>https://kane.mx/posts/archive/blogspot/migrate-clearcase-to-git/</link><pubDate>Mon, 17 Oct 2011 19:50:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/migrate-clearcase-to-git/</guid><description>&lt;p>I tried to migrate the source code of project from Clearcase to Git repository. As far as I know there is no elegant solution for such migration. For purpose of this migration, I want to keep the history and label of files in Clearcase after migrating to Git repository.&lt;/p>
&lt;p>There are mature tools to migrate CVS/SVN repository to Git, so I tried to use Subversion as a bridge for my migration.&lt;/p>
&lt;p>I used a free software &amp;lsquo;&lt;a href="http://www.polarion.com/products/svn/svn_importer.php">SVN Importer&lt;/a>&amp;rsquo; to import the Clearcase vobs to Subversion. The tool is great, and it keeps the history of files, labels and branches. The entire size of new Subversion repository has near 50GB which is unacceptable size of Git repository. The subversion repository contains a lot of legacy code and unwanted binaries, so removing those revisions could significantly reduce the size of subversion repository. And subversion provides some admin tools to manipulate the metadata of subversion, it&amp;rsquo;s possible to remove the unnecessary revisions and re-create a subversion repository with refined content. But I don&amp;rsquo;t have any experience to use the admin tool of subversion before, I failed to filter the unwanted data. It&amp;rsquo;s not worthy of costing too much effects on it. Finally I failed to filter the subversion repository.&lt;/p>
&lt;p>Actually the detail history of files is rarely used. If need, we still can find it in Clearcase. At last I manually checked in the released version of our project into Git repository, and tagged them.&lt;/p>
&lt;p>Wrote this unsuccessful idea here for elapsed efforts.&lt;/p></description></item><item><title>p2 query performance</title><link>https://kane.mx/posts/archive/blogspot/p2-query-performance/</link><pubDate>Mon, 17 Oct 2011 19:34:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/p2-query-performance/</guid><description>&lt;p>Our p2 based on installer suffered performance issue when querying IUs from repositories. Though the repositories have a large number of IUs to be queried, but we find the performance of using QL is unacceptable in some special scenarios.&lt;/p>
&lt;p>I &lt;a href="https://docs.google.com/document/d/1wfnr2d2TF4vIYDCMmWPuYd0kQA32WiWaXTiaCoJovho/edit?pli=1">published several different methods&lt;/a> to find the expected IUs. Thomas pointed out the better expression of QL and finally helped us to find out the our repository without &lt;strong>IIndexProvider&lt;/strong> implementation.&lt;/p>
&lt;p>&lt;strong>IIndexProvider&lt;/strong> implementation of a repository is quite important to improve the performance of QL, especially use the &amp;lsquo;traverse&amp;rsquo; clause to query something.&lt;/p>
&lt;p>And Slicer API is an alternative method when querying the complete dependencies.&lt;/p></description></item><item><title>Create an import library for building application in MinGW</title><link>https://kane.mx/posts/archive/blogspot/create-import-library-for-building/</link><pubDate>Fri, 12 Aug 2011 10:51:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/create-import-library-for-building/</guid><description>&lt;p>Yesterday I modified an existing c++ application for Windows. And its default build environment is Makefile and MinGW.&lt;/p>
&lt;p>However I used a newly Windows API that is not included by header files of MinGW.&lt;/p>
&lt;p>First of all, I copied the constant definition from header file of Windows SDK, and defined the Windows API method as a extern C method. So it&amp;rsquo;s no problem to compile the code in MinGW.&lt;/p>
&lt;p>Secondly I have to fix the link issue. Because the symbol of the Windows API also can&amp;rsquo;t be found by gcc link.&lt;/p>
&lt;p>Here great thanks to Google. It&amp;rsquo;s quite easy to get the knowledge from others.&lt;/p>
&lt;p>I found a way to create an library by using dlltool. Dlltool is a utility to create an library with specified methods from existing dll library, which can be used by gcc link later.&lt;/p>
&lt;p>Below are links I referred to create an import library,&lt;/p>
&lt;p>[1] &lt;a href="http://www.emmestech.com/moron_guides/moron1.html">http://www.emmestech.com/moron_guides/moron1.html&lt;/a>&lt;br>
[2] &lt;a href="http://www.mingw.org/wiki/CreateImportLibraries">http://www.mingw.org/wiki/CreateImportLibraries&lt;/a>&lt;br>
[3] &lt;a href="http://lists-archives.org/mingw-users/19461-import-library-for-c.html">http://lists-archives.org/mingw-users/19461-import-library-for-c.html&lt;/a>&lt;/p></description></item><item><title>Customize PDE build</title><link>https://kane.mx/posts/archive/blogspot/customize-pde-build/</link><pubDate>Fri, 22 Jul 2011 13:59:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/customize-pde-build/</guid><description>&lt;p>&lt;a href="http://help.eclipse.org/helios/index.jsp?topic=/org.eclipse.pde.doc.user/tasks/pde_customization.htm">The documentation of PDE&lt;/a> has a chapter for this topic. Basically it&amp;rsquo;s simply. Copy the template scripts what you want from &lt;em>templates/headless-build&lt;/em> folder under &lt;em>org.eclipse.pde.build&lt;/em> plug-in to your build configuration directory that is the folder has &lt;em>build.properties&lt;/em> file.&lt;/p>
&lt;p>However I found the variables listed in template &amp;lsquo;&lt;em>customAssembly.xml&lt;/em>&amp;rsquo; can&amp;rsquo;t be used in the runtime. I filed bug &lt;a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=346370">346370&lt;/a> against it.&lt;/p></description></item><item><title>Using the certificate of Windows code signing to sign jars</title><link>https://kane.mx/posts/archive/blogspot/using-certificate-of-windows-code/</link><pubDate>Mon, 18 Jul 2011 21:03:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/using-certificate-of-windows-code/</guid><description>&lt;p>I did sign the jars via reusing the existing certificate of Windows code signing several months ago. Writing it down for further reference.&lt;/p>
&lt;p>Whatever your purpose of reusing the existing Windows code certificate, I only document the way from technical perspective.&lt;/p>
&lt;p>After buying the certificate of Windows code signing from CA, you will get a .pvk file that stores both the certificate and private key. PVK file is the PKCS12 format[1], however java uses JKS format by default. So you need convert the pvk file to JKS keystore and certificate.&lt;/p>
&lt;p>Since 6.0 JDK supports PKCS12 directly, you can use &amp;lsquo;jarsigner&amp;rsquo; and PVK file to sign jars directly[2].&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">
jarsigner -keystore /working/mystore.pvk -storetype pkcs12 -storepass myspass -keypass j638klm -signedjar sbundle.jar bundle.jar jane &lt;/code>&lt;/pre>&lt;/div>
&lt;p>Or using keytool to convert the PKCS#12 to JKS format[3] if using Eclipse PDE build to sign your jars.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">
keytool -importkeystore -srckeystore KEYSTORE.pvk -destkeystore KEYSTORE.jksÂ  -srcstoretype PKCS12 -deststoretype JKS -srcstorepass mysecret -deststorepass mysecret -srcalias myalias -destalias myalias -srckeypass mykeypass -destkeypass mykeypass -nopromptÂ  &lt;/code>&lt;/pre>&lt;/div>
&lt;p>[1] &lt;a href="http://en.wikipedia.org/wiki/PKCS">http://en.wikipedia.org/wiki/PKCS&lt;/a>&lt;br>
[2] &lt;a href="http://download.oracle.com/javase/6/docs/technotes/tools/solaris/jarsigner.html">http://download.oracle.com/javase/6/docs/technotes/tools/solaris/jarsigner.html&lt;/a>&lt;br>
[3] &lt;a href="http://shib.kuleuven.be/docs/ssl_commands.shtml#keytool">http://shib.kuleuven.be/docs/ssl_commands.shtml#keytool&lt;/a>&lt;/p></description></item><item><title>Unlock the locked profile if firefox/thunderbird crash</title><link>https://kane.mx/posts/archive/blogspot/unlock-locked-profile-if/</link><pubDate>Wed, 11 May 2011 13:19:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/unlock-locked-profile-if/</guid><description>&lt;p>I met that firefox/thunderbird complained another its instance running even if no a running firefox/thunderbird process. Finally let them run again after removing the &amp;lsquo;.parentlock&amp;rsquo; file in their default profile.&lt;/p>
&lt;p>strace utility helps me a lot to find the solution.&lt;/p>
&lt;p>&lt;strong>strace -f -e file firfox&lt;/strong>&lt;/p></description></item><item><title>Eclipse P2's import/export capability</title><link>https://kane.mx/posts/archive/blogspot/eclipse-p2s-importexport-capability/</link><pubDate>Fri, 22 Apr 2011 15:56:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/eclipse-p2s-importexport-capability/</guid><description>&lt;p>I implemented the &lt;a href="https://kane.mx/posts/archive/blogspot/p2-replication-plug-in/">replication tool&lt;/a> at the end of 2009, then published it to &lt;a href="https://kane.mx/posts/archive/blogspot/p2-replication-tool-lives-on-eclipse/">Eclipse Marketplace&lt;/a> in May 2010. However it&amp;rsquo;s not pervasively used due to users have to install that plug-in firstly.&lt;/p>
&lt;p>I searched a similar &lt;a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=282419">request&lt;/a> on bugzilla, then I initialized my contribution in the early of this year. Finally it was accepted and will release as part of eclipse itself since Eclipse 3.7 M7! I hope it would benefit the users of Eclipse more and more.&lt;/p>
&lt;p>And I was nominated and elected as the committer of Equinox p2, it&amp;rsquo;s a great honor for me. :)&lt;/p></description></item><item><title>[vim] delete the lines not contain words</title><link>https://kane.mx/posts/archive/blogspot/vim-delete-lines-not-contain-words/</link><pubDate>Wed, 05 Jan 2011 14:25:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/vim-delete-lines-not-contain-words/</guid><description>&lt;p>:g!/some expression/d&lt;/p></description></item><item><title>Inside P2's profile (2) - the fragment matches all osgi bundles</title><link>https://kane.mx/posts/archive/blogspot/inside-p2s-profile-2-fragment-matches/</link><pubDate>Tue, 28 Dec 2010 11:33:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/inside-p2s-profile-2-fragment-matches/</guid><description>&lt;p>Recently our installer met a strange bug, it didn&amp;rsquo;t uninstall all legacy bundles after updating to new version. Finally I found it&amp;rsquo;s due to a magic fragment is missing in the profile due to some causes.&lt;/p>
&lt;p>Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â Â Â Â Â Â Â  installBundle(bundle:${artifact})&lt;br>
Â Â Â Â Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â Â Â Â Â Â Â  uninstallBundle(bundle:${artifact})&lt;br>
Â Â Â Â Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>Â Â Â Â Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â Â Â Â Â Â Â  setStartLevel(startLevel:4);&lt;br>
Â Â Â Â Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â Â Â  &lt;!-- raw HTML omitted -->&lt;br>
Â Â Â  &lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>It has &amp;lsquo;hostRequirements&amp;rsquo; element that represents it&amp;rsquo;s a fragment IU and match all the eclipse&amp;rsquo;s plug-ins in that profile. And this fragment defines the touch point actions for its hosts that will do installBundle action during &amp;lsquo;install&amp;rsquo; phrase and uninstallBundle action during &amp;lsquo;uninstall&amp;rsquo; phrase. It&amp;rsquo;s a very good way to remove the duplicate touch point definitions for all eclipse&amp;rsquo;s plug-ins in the profile.&lt;/p>
&lt;p>BTW, p2&amp;rsquo;s engine also doesn&amp;rsquo;t attach this fragment to the eclipse&amp;rsquo;s plug-in IU if the top level IU doesn&amp;rsquo;t have the STRICT rule. I&amp;rsquo;m not sure the root cause of designing for it, but it&amp;rsquo;s the fact.&lt;/p></description></item><item><title>Inside P2's profile (1) - inclusion rules</title><link>https://kane.mx/posts/archive/blogspot/inside-p2s-profile-1-inclusion-rules/</link><pubDate>Tue, 28 Dec 2010 11:13:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/inside-p2s-profile-1-inclusion-rules/</guid><description>&lt;p>You would see some interesting properties at the bottom of eclipse&amp;rsquo;s profile.&lt;/p>
&lt;p>For example,&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;p>It attaches a property named &amp;lsquo;org.eclipse.equinox.p2.internal.inclusion.rules&amp;rsquo; with value &amp;lsquo;STRICT&amp;rsquo; on the IU &amp;lsquo;org.eclipse.sdk.ide&amp;rsquo; with version 3.6.1.M20100909-0800.&lt;br>
Â &lt;br>
It&amp;rsquo;s a very important property for the p2 engine. It means the IU &amp;lsquo;org.eclipse.sdk.ide&amp;rsquo; has been explicitly installed into the profile, so it&amp;rsquo;s not allowed be implicitly updated or removed.&lt;/p>
&lt;p>For example,&lt;br>
We have top feature IU &amp;lsquo;org.eclipse.sdk.ide&amp;rsquo; that represents the Eclipse SDK,Â Â  &amp;lsquo;org.eclipse.pde.feature&amp;rsquo; that represents the Plug-in Development Tool and &amp;lsquo;org.eclipse.jdt.feature&amp;rsquo; that represents the Java Development Tool. And both JDT and PDT are part of Eclipse SDK, so &amp;lsquo;org.eclipse.pde.feature&amp;rsquo; and &amp;lsquo;org.eclipse.jdt.feature&amp;rsquo; are required by &amp;lsquo;org.eclipse.sdk.ide&amp;rsquo;.&lt;/p>
&lt;p>If the profile only has the STRICT rule for &amp;lsquo;org.eclipse.sdk.ide&amp;rsquo;, &amp;lsquo;org.eclipse.jdt.feature&amp;rsquo; and &amp;lsquo;org.eclipse.pdt.feature&amp;rsquo; will implicitly be updated to 3.6.2 when updating &amp;lsquo;org.eclipse.sdk.ide&amp;rsquo; from 3.6.1 to 3.6.2.&lt;/p>
&lt;p>However the profile has below STRICT rule for PDT feature,&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;p>The p2 engine will report errors due to &amp;lsquo;org.eclipse.pdt.feature&amp;rsquo; has STRICT rule for updating. Hence third-party must explicitly update both &amp;lsquo;org.eclipse.sdk.ide&amp;rsquo; and &amp;lsquo;org.eclipse.pdt.feature&amp;rsquo; from 3.6.1 to 3.6.2.&lt;/p></description></item><item><title>stack overflow protector</title><link>https://kane.mx/posts/archive/blogspot/stack-overflow-protector/</link><pubDate>Thu, 23 Dec 2010 13:25:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/stack-overflow-protector/</guid><description>&lt;p>Latest gcc compiler enables the stack overflow protector that is since GLIBC 2.4. So the library or executable is compiled by latest gcc could be loaded or executed in RHEL4 or Solaris 9 that only have GLIBC 2.3. Hence using option &amp;lsquo;-fno-stack-protector&amp;rsquo; to compile the library or executable to make sure it could be executed in older linux release.&lt;/p>
&lt;p>g++ -fno-stack-protector -o test.o test&lt;/p></description></item><item><title>the loop name for 'for' clause in java</title><link>https://kane.mx/posts/archive/blogspot/loop-name-for-for-clause-in-java/</link><pubDate>Tue, 21 Sep 2010 10:46:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/loop-name-for-for-clause-in-java/</guid><description>&lt;p>Recently I just know such a useful syntax usage of java.&lt;/p>
&lt;pre>&lt;code>aLoopName: for (;;) { Â  // ...Â  while (someCondition) Â  // ...Â  Â  if (otherCondition) Â  Â  Â  continue aLoopName;&lt;/code>&lt;/pre></description></item><item><title>rename command</title><link>https://kane.mx/posts/archive/blogspot/rename-command/</link><pubDate>Sun, 19 Sep 2010 11:40:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/rename-command/</guid><description>&lt;p>It&amp;rsquo;s a powerful command to rename files in a batch.&lt;/p>
&lt;p>Usage:&lt;/p>
&lt;p>rename &amp;rsquo;s/(\d+)$/$1\.txt/' * rename add &amp;lsquo;.txt&amp;rsquo; extension name for all files that ends with number.&lt;/p></description></item><item><title>applying proxy for the softwares without proxy support in linux</title><link>https://kane.mx/posts/archive/blogspot/applying-proxy-for-softwares-without/</link><pubDate>Mon, 13 Sep 2010 13:14:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/applying-proxy-for-softwares-without/</guid><description>&lt;p>If you have http proxy, set it to system environment,&lt;/p>
&lt;p>export http_proxy=http://&lt;a href="http://127.0.0.1">127.0.0.1&lt;/a>:8000 Then start the application in that same terminal.&lt;/p>
&lt;p>If the proxy is socks proxy, use &amp;lsquo;&lt;a href="http://tsocks.sourceforge.net/about.php">tsocks&lt;/a>&amp;rsquo; to wrap the application in terminal.&lt;/p></description></item><item><title>Food and Drinking</title><link>https://kane.mx/posts/archive/blogspot/food-and-drinking/</link><pubDate>Mon, 30 Aug 2010 15:11:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/food-and-drinking/</guid><description>&lt;p>Honestly speaking, you have eaten the best delicious food if you&amp;rsquo;re living in China. Though we have more and more concerns on the safety of food, we have to recognize that Chinese food is more delicious than others.&lt;/p>
&lt;p>The cuisine is simple in Austria. People always use pork, beef, flour, tomato, potato and few green vegetables. So they surprised Chinese cost several hours to make the food.&lt;/p>
&lt;p>&lt;a href="http://lh4.ggpht.com/_5seoFihTGKg/TGhDMuC9-GI/AAAAAAAAEts/07UdMerwnek/s1600/DSC01486.JPG">&lt;img src="http://lh4.ggpht.com/_5seoFihTGKg/TGhDMuC9-GI/AAAAAAAAEts/07UdMerwnek/s320/DSC01486.JPG" alt="">&lt;/a>&lt;/p>
&lt;p>Gulasch, it&amp;rsquo;s good tasted after eating pizza several times&lt;/p>
&lt;p>&lt;a href="http://lh3.ggpht.com/_5seoFihTGKg/THA4tivsMbI/AAAAAAAAFfM/icqAdSenGh8/s1600/DSC02235.JPG">&lt;img src="http://lh3.ggpht.com/_5seoFihTGKg/THA4tivsMbI/AAAAAAAAFfM/icqAdSenGh8/s320/DSC02235.JPG" alt="">&lt;/a>&lt;/p>
&lt;p>pasta&lt;/p>
&lt;p>About the drinking, most of them directly drink the water from water pipe. And some of them like the special water that mixes water with gas. The coffee and beer are the favorite of local citizens. You can find more than one hundred beer brand in the city, and some of them have been found for centuries. Indeed they&amp;rsquo;re good tasted.&lt;/p>
&lt;p>&lt;a href="http://lh4.ggpht.com/_5seoFihTGKg/TGhDHwbEImI/AAAAAAAAEts/2agQjADYhME/s1600/IMAG0062.jpg">&lt;img src="http://lh4.ggpht.com/_5seoFihTGKg/TGhDHwbEImI/AAAAAAAAEts/2agQjADYhME/s320/IMAG0062.jpg" alt="">&lt;/a>&lt;/p>
&lt;p>special water&lt;/p>
&lt;p>&lt;a href="http://lh5.ggpht.com/_5seoFihTGKg/TGhDLmzGr1I/AAAAAAAAEts/xxBc93WCpjU/s1600/DSC01484.JPG">&lt;img src="http://lh5.ggpht.com/_5seoFihTGKg/TGhDLmzGr1I/AAAAAAAAEts/xxBc93WCpjU/s320/DSC01484.JPG" alt="">&lt;/a>&lt;/p>
&lt;p>Die Weissf&lt;/p>
&lt;p>&lt;a href="http://lh5.ggpht.com/_5seoFihTGKg/TGHFar39TQI/AAAAAAAAEWI/zuSA9t4mxbs/s1600/DSC01410.JPG">&lt;img src="http://lh5.ggpht.com/_5seoFihTGKg/TGHFar39TQI/AAAAAAAAEWI/zuSA9t4mxbs/s320/DSC01410.JPG" alt="">&lt;/a>&lt;/p>
&lt;p>Wieninger, it comes from Vienna&lt;/p>
&lt;p>&lt;a href="http://lh6.ggpht.com/_5seoFihTGKg/TG7mpCBHSbI/AAAAAAAAFYk/csiGmZc-dKY/s1600/DSC02115.JPG">&lt;img src="http://lh6.ggpht.com/_5seoFihTGKg/TG7mpCBHSbI/AAAAAAAAFYk/csiGmZc-dKY/s320/DSC02115.JPG" alt="">&lt;/a>&lt;/p>
&lt;p>Stiegl, local famous brand&lt;/p></description></item><item><title>Working Workspace</title><link>https://kane.mx/posts/archive/blogspot/working-workspace/</link><pubDate>Fri, 27 Aug 2010 17:29:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/working-workspace/</guid><description>&lt;p>Joel posted a &lt;a href="http://www.joelonsoftware.com/articles/fieldguidetodevelopers.html">blog&lt;/a> related to how to hire the great programmers. One of his key points is building comfortable workspaces.&lt;/p>
&lt;p>I believe every programmer loves the workspace like Google and Fog Creek. The workspace of Google has been very famous due to its French chef, gymnasium and big sofas. Why is Fog Creek? It&amp;rsquo;s the company created by Joel, he also practiced his theory on his company. Ruan YiFeng posted a &lt;a href="http://www.ruanyifeng.com/blog/2009/02/fog_creek_s_new_office.html">blog&lt;/a> for it. I bet you would envy the guys working in that office.&lt;/p>
&lt;p>How about the workspace of the office in Salzburg? Let me show some pictures.&lt;/p>
&lt;p>&lt;strong>Space&lt;/strong>&lt;/p>
&lt;p>&lt;a href="http://lh5.ggpht.com/_5seoFihTGKg/TGBWwuo-tHI/AAAAAAAAEMQ/xHxeyT70HXk/s1600/DSC01304.JPG">&lt;img src="http://lh5.ggpht.com/_5seoFihTGKg/TGBWwuo-tHI/AAAAAAAAEMQ/xHxeyT70HXk/s320/DSC01304.JPG" alt="">&lt;/a>&lt;/p>
&lt;p>programmers have two monitors&lt;/p>
&lt;p>&lt;strong>Reading&lt;/strong>&lt;/p>
&lt;p>&lt;a href="http://lh4.ggpht.com/_5seoFihTGKg/TGBWxauiGbI/AAAAAAAAEMQ/vci8KUFBYR8/s1600/DSC01305.JPG">&lt;img src="http://lh4.ggpht.com/_5seoFihTGKg/TGBWxauiGbI/AAAAAAAAEMQ/vci8KUFBYR8/s320/DSC01305.JPG" alt="">&lt;/a>&lt;/p>
&lt;p>non-technique magazines&lt;/p>
&lt;p>&lt;a href="http://lh6.ggpht.com/_5seoFihTGKg/TGhB7aPoeTI/AAAAAAAAEtw/8vwp35gWKDM/s1600/DSC01531.JPG">&lt;img src="http://lh6.ggpht.com/_5seoFihTGKg/TGhB7aPoeTI/AAAAAAAAEtw/8vwp35gWKDM/s320/DSC01531.JPG" alt="">&lt;/a>&lt;/p>
&lt;p>technique books&lt;/p>
&lt;p>&lt;a href="http://lh5.ggpht.com/_5seoFihTGKg/TGhB8dGbfaI/AAAAAAAAEtw/uJi1Th1VRpk/s1600/DSC01532.JPG">&lt;img src="http://lh5.ggpht.com/_5seoFihTGKg/TGhB8dGbfaI/AAAAAAAAEtw/uJi1Th1VRpk/s320/DSC01532.JPG" alt="">&lt;/a>&lt;/p>
&lt;p>&lt;strong>Drinking&lt;/strong>&lt;/p>
&lt;p>&lt;a href="http://lh6.ggpht.com/_5seoFihTGKg/TGBWzSLoSmI/AAAAAAAAEMQ/7HYCatHdGz4/s1600/DSC01308.JPG">&lt;img src="http://lh6.ggpht.com/_5seoFihTGKg/TGBWzSLoSmI/AAAAAAAAEMQ/7HYCatHdGz4/s320/DSC01308.JPG" alt="">&lt;/a>&lt;/p>
&lt;p>coffee machine&lt;/p>
&lt;p>&lt;a href="http://lh3.ggpht.com/_5seoFihTGKg/TGBWyMvCgwI/AAAAAAAAEMQ/fPdMhx7PBHw/s1600/DSC01306.JPG">&lt;img src="http://lh3.ggpht.com/_5seoFihTGKg/TGBWyMvCgwI/AAAAAAAAEMQ/fPdMhx7PBHw/s320/DSC01306.JPG" alt="">&lt;/a>&lt;/p>
&lt;p>&lt;strong>Kitchen&lt;/strong>&lt;/p>
&lt;p>&lt;a href="http://lh4.ggpht.com/_5seoFihTGKg/TGHEaDcOJNI/AAAAAAAAER0/NUTKufmDPAs/s1600/DSC01344.JPG">&lt;img src="http://lh4.ggpht.com/_5seoFihTGKg/TGHEaDcOJNI/AAAAAAAAER0/NUTKufmDPAs/s320/DSC01344.JPG" alt="">&lt;/a>&lt;/p>
&lt;p>freezer for fast food&lt;/p>
&lt;p>&lt;a href="http://lh4.ggpht.com/_5seoFihTGKg/TGBWyoK53jI/AAAAAAAAEMQ/-5oBPlQCxO8/s1600/DSC01307.JPG">&lt;img src="http://lh4.ggpht.com/_5seoFihTGKg/TGBWyoK53jI/AAAAAAAAEMQ/-5oBPlQCxO8/s320/DSC01307.JPG" alt="">&lt;/a>&lt;/p>
&lt;p>&lt;a href="http://lh3.ggpht.com/_5seoFihTGKg/TG7mjY2LsOI/AAAAAAAAFYE/Gjq4G4pjPCk/s1600/DSC02105.JPG">&lt;img src="http://lh3.ggpht.com/_5seoFihTGKg/TG7mjY2LsOI/AAAAAAAAFYE/Gjq4G4pjPCk/s320/DSC02105.JPG" alt="">&lt;/a>&lt;/p>
&lt;p>&lt;strong>Entertainment&lt;/strong>&lt;/p>
&lt;p>&lt;a href="http://lh3.ggpht.com/_5seoFihTGKg/TGhB_OLyyAI/AAAAAAAAEtw/h8kupi6nsPM/s1600/DSC01536.JPG">&lt;img src="http://lh3.ggpht.com/_5seoFihTGKg/TGhB_OLyyAI/AAAAAAAAEtw/h8kupi6nsPM/s320/DSC01536.JPG" alt="">&lt;/a>&lt;/p>
&lt;p>table football game&lt;/p></description></item><item><title>Transportation</title><link>https://kane.mx/posts/archive/blogspot/transportation/</link><pubDate>Fri, 27 Aug 2010 16:20:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/transportation/</guid><description>&lt;p>Salzburg is a small city and is on the banks of the Salzach River. It&amp;rsquo;s easy to go through the city by bus in 30 minutes.&lt;/p>
&lt;p>&lt;a href="http://lh5.ggpht.com/_5seoFihTGKg/TGhDE2zZzpI/AAAAAAAAEts/7yYsaAnjIvg/s1600/IMAG0058.jpg">&lt;img src="http://lh5.ggpht.com/_5seoFihTGKg/TGhDE2zZzpI/AAAAAAAAEts/7yYsaAnjIvg/s320/IMAG0058.jpg" alt="">&lt;/a>&lt;/p>
&lt;p>Salzach River&lt;/p>
&lt;p>&lt;a href="http://lh4.ggpht.com/_5seoFihTGKg/TF7wirfvyNI/AAAAAAAAEJo/Q92doV8uMyU/s1600/DSC01291.JPG">&lt;img src="http://lh4.ggpht.com/_5seoFihTGKg/TF7wirfvyNI/AAAAAAAAEJo/Q92doV8uMyU/s320/DSC01291.JPG" alt="">&lt;/a>&lt;/p>
&lt;p>outline view&lt;/p>
&lt;p>Riding the bicycle is a very good way to enjoy the beautiful sight of the city. You could see many kids with parents riding bicycle in the sunny weekend.&lt;br>
The train station and a major bus transient station are the same one that is called as &amp;lsquo;main station&amp;rsquo; by local residents. it&amp;rsquo;s not far from the office of company, about 20 minutes by foot.&lt;/p>
&lt;p>The ticket system of bus is more complicated than Beijing&amp;rsquo;s. People can buy the ticket for single, 24 hours, 48 hours, a week and even a year. The children can get discount. There&amp;rsquo;s no ticket seller in the bus. Usually nobody checks whether you have valid ticket. Pressing the button to open the door when getting on/off the bus.&lt;/p>
&lt;p>The public transportation is designed well. There are different tickets for different people. For example, tourists would prefer to buy 24 hours ticket or 48 hours tickets. 24 hours ticket means the passengers can take any bus in the 24 hours after it&amp;rsquo;s used first time. So it&amp;rsquo;s very convenient for tourists. 24 hours ticket is 4.2â‚¬ for adults, 2.1â‚¬ for children.Â  The price of train tickets is same. The faster train &amp;ldquo;ICE&amp;rdquo; have higher price. The regular train is much cheaper. And the ticket allows a family not exceed 5 persons to go back and forth another city in a day. It&amp;rsquo;s very cheap for a family to enjoy weekend in another city or town by train. I think it&amp;rsquo;s a good approach to use public transportation more to reduce environment pollution.&lt;/p>
&lt;p>&lt;a href="http://lh3.ggpht.com/_5seoFihTGKg/THA35YLtBII/AAAAAAAAFbk/TSWCuhOVscI/s1600/DSC02175.JPG">&lt;img src="http://lh3.ggpht.com/_5seoFihTGKg/THA35YLtBII/AAAAAAAAFbk/TSWCuhOVscI/s320/DSC02175.JPG" alt="">&lt;/a>&lt;/p>
&lt;p>round-trip ticket&lt;/p>
&lt;p>Taking the train is more convenient than China. There is no security checking, no long distance between gate and platform and even no staffs in the platform. Meanwhile there is no any limitation to travel among the European countries. I went to Munich of Germany by train, I felt it&amp;rsquo;s even more convenient than taking subway in Beijing. Both the train and bus have a lot of humanization design for disability people and people with their bicycles or pets.&lt;/p>
&lt;p>&lt;a href="http://lh5.ggpht.com/_5seoFihTGKg/THA34mgWJ5I/AAAAAAAAFbg/GzdGFOAZtZs/s1600/DSC02174.JPG">&lt;img src="http://lh5.ggpht.com/_5seoFihTGKg/THA34mgWJ5I/AAAAAAAAFbg/GzdGFOAZtZs/s320/DSC02174.JPG" alt="">&lt;/a>&lt;/p></description></item><item><title>Working style</title><link>https://kane.mx/posts/archive/blogspot/working-style/</link><pubDate>Fri, 20 Aug 2010 17:45:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/working-style/</guid><description>&lt;p>There are 20+ staffs in Salzburg office. Most of them are developers, one is administrator of office.&lt;br>
Generally the staffs in Salzburg work more flexible than the staffs working in Beijing.&lt;br>
Some of them live in German. Even though it&amp;rsquo;s not so far as Salzburg, they also need come to Salzburg by train. So sometimes they work at home, use internet and phone as communication tool.&lt;br>
And they have different responsibilities for products. For example, Helmut works on installer, Matthias and Michael are responsibility for QFT testing, Martin N. is focus on license API developing. So everybody has himself schedule, he can decide when he come to office and when leave office based on his working schedule. Nobody cares when you come/leave office or how long you work every day. I believe all of them do well on their jobs.&lt;br>
Furthermore you can work with your dogs together if nobody takes care of them at home.&lt;/p>
&lt;p>&lt;a href="http://lh4.ggpht.com/_5seoFihTGKg/TGMHIzBlXCI/AAAAAAAAEZk/2HQKcFkkRG4/s1600/DSC01434.JPG">&lt;img src="http://lh4.ggpht.com/_5seoFihTGKg/TGMHIzBlXCI/AAAAAAAAEZk/2HQKcFkkRG4/s320/DSC01434.JPG" alt="">&lt;/a>&lt;/p>
&lt;p>Max&amp;rsquo;s dogs&lt;/p>
&lt;p>Most of foreign like coffee, so there is a kitchen with seats in the office. Some of them like to drink a cup of coffee or tea as a break, and it&amp;rsquo;s a good chance to talk with others. It&amp;rsquo;s a relaxing time for changing your mind out of work. Besides drinking some things, there is a room for playing table football game. It&amp;rsquo;s a small amount of exercise, it&amp;rsquo;s good for body.&lt;/p>
&lt;p>&lt;a href="http://lh4.ggpht.com/_5seoFihTGKg/TGhB9Fk32aI/AAAAAAAAEtw/KnBxZafXWjY/s1600/DSC01534.JPG">&lt;img src="http://lh4.ggpht.com/_5seoFihTGKg/TGhB9Fk32aI/AAAAAAAAEtw/KnBxZafXWjY/s320/DSC01534.JPG" alt="">&lt;/a>&lt;/p>
&lt;p>Another thing makes me very impressive is that the team is very stable than any company I know in China. Most of them work in company more than 10 years. So I think I know that&amp;rsquo;s why they know more than us. Everyone could be expert after doing the same thing more than 10 years. They love the work of coding, and they would like to do coding until retiring. That&amp;rsquo;s why I can see some of them are more than 40, even 50 years old.&lt;/p></description></item><item><title>day 1</title><link>https://kane.mx/posts/archive/blogspot/day-1/</link><pubDate>Tue, 10 Aug 2010 19:24:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/day-1/</guid><description>&lt;p>åº¦è¿‡é•¿é€”é£è¡Œçš„æ—…ç¨‹ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹ã€‚è¦åœ¨ç‹­å°çš„ç©ºé—´é‡Œå¾…ä¸Šè¿‘10ä¸ªå°æ—¶ï¼Œå¥½åœ¨æ˜¯ä¸¤äººå‡ºè¡Œï¼ŒåŠç¡åŠèŠçš„æ‰“å‘è¿‡äº†æ—¶é—´ã€‚&lt;br>
åˆ°è¾¾ç»´ä¹Ÿçº³ä¹‹åï¼Œå‡ºäº†ç™»æœºé€šé“çœ‹åˆ°çš„å±…ç„¶æ˜¯ä¸€ä¸ªé…’å§ç±»çš„é¤é¦†ã€‚æ„Ÿè§‰å¾ˆç¨€å¥‡ï¼Œä¹Ÿå¾ˆæœ‰å‘³é“ã€‚&lt;br>
å‘¨å›´å½“ç„¶å°‘ä¸äº†å…ç¨åº—å’Œå•†é“ºï¼Œä½†è¿œæ²¡æœ‰é¦–éƒ½æœºåœºé‚£æ ·çš„è§„æ¨¡ã€‚æ€»ä½“æ„Ÿè§‰å°±åƒå›½å†…å¤§å‹è¶…å¸‚è´­ç‰©å‡ºå£ä¸€æ ·ï¼Œè€Œä¸”äººä¹Ÿä¸å¤šã€‚&lt;/p>
&lt;p>&lt;a href="http://lh3.ggpht.com/_5seoFihTGKg/TGHDEkhP_yI/AAAAAAAAENE/vaUaP6QSc5o/s1600/IMAG0012.jpg">&lt;img src="http://lh3.ggpht.com/_5seoFihTGKg/TGHDEkhP_yI/AAAAAAAAENE/vaUaP6QSc5o/s320/IMAG0012.jpg" alt="">&lt;/a>&lt;/p>
&lt;p>å¦å¤–èµä¸€ä¸‹ç»´ä¹Ÿçº³æœºåœºçš„Wifiï¼Œç®€å•é…ç½®å°±Käº†ï¼Œå“ªåƒå›½å†…çš„ï¼Œåˆè¦ç§»åŠ¨å·ç ï¼Œè¿˜è¦çŸ­ä¿¡è·å–ï¼ŒæåŠå¤©ä¹Ÿæ²¡å¼„å®šã€‚&lt;br>
è½¬æœºä¹‹å‰è¿˜æœ‰æ®µæ—¶é—´ï¼Œå°±åœ¨æœºåœºé‡Œåˆ°å¤„é€›äº†é€›ã€‚é¡ºä¾¿åœ¨ä¸€ä¸ªå§è§£å†³äº†æ™šé¤ï¼ŒåŒæ—¶ä¹Ÿå°äº†æ¯å½“åœ°å•¤é…’ã€‚&lt;/p>
&lt;p>&lt;a href="http://lh3.ggpht.com/_5seoFihTGKg/TGHDGKzhOgI/AAAAAAAAENI/SyDJegD6gsU/s1600/IMAG0013.jpg">&lt;img src="http://lh3.ggpht.com/_5seoFihTGKg/TGHDGKzhOgI/AAAAAAAAENI/SyDJegD6gsU/s320/IMAG0013.jpg" alt="">&lt;/a>&lt;/p>
&lt;p>å»è¨å°”èŒ¨å ¡çš„é£æœºè¿˜æ˜¯å¸¦èºæ—‹æ¡¨çš„ï¼Œå¤´æ¬¡åè¿™æ ·çš„è€å¼é£æœºã€‚&lt;/p>
&lt;p>&lt;a href="http://lh5.ggpht.com/_5seoFihTGKg/TF7tgvXQbhI/AAAAAAAAECI/AgjugZ-dPW0/s1600/DSC01197.JPG">&lt;img src="http://lh5.ggpht.com/_5seoFihTGKg/TF7tgvXQbhI/AAAAAAAAECI/AgjugZ-dPW0/s320/DSC01197.JPG" alt="">&lt;/a>&lt;/p></description></item><item><title>Discovering the p2 API</title><link>https://kane.mx/posts/archive/blogspot/discovering-p2-api/</link><pubDate>Mon, 17 May 2010 22:35:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/discovering-p2-api/</guid><description>&lt;p>Check out this SlideShare Presentation:&lt;/p>
&lt;p>&lt;strong>&lt;a href="http://www.slideshare.net/PascalRapicault/discovering-the-p2-api" title="Discovering the p2 API">Discovering the p2 API&lt;/a>&lt;/strong>&lt;/p>
&lt;p>View more &lt;a href="http://www.slideshare.net/">presentations&lt;/a> from &lt;a href="http://www.slideshare.net/PascalRapicault">Sonatype&lt;/a>.&lt;/p></description></item><item><title>P2 replication tool lives on Eclipse Marketplace</title><link>https://kane.mx/posts/archive/blogspot/p2-replication-tool-lives-on-eclipse/</link><pubDate>Mon, 17 May 2010 15:41:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/p2-replication-tool-lives-on-eclipse/</guid><description>&lt;p>Days ago I updated my p2 replication tool. It&amp;rsquo;s easier to install it in your Eclipse.&lt;br>
A new component named &amp;lsquo;Eclipse marketplace&amp;rsquo; is added into Eclipse SDK since Helios, which is an application store for Eclipse. People could be easy to install third party plug-ins into their Eclipse.&lt;/p>
&lt;p>You can launch marketplace via &amp;lsquo;Help&amp;rsquo; - &amp;lsquo;Eclipse Marketplace&amp;hellip;&amp;rsquo;, then search key word &amp;lsquo;p2&amp;rsquo; or &amp;lsquo;replication&amp;rsquo; to find the tool. Finally click next to install it.&lt;/p>
&lt;p>It&amp;rsquo;s a very graceful workflow to install some add-ons like firefox.&lt;/p>
&lt;p>And then p2 replication tool could help you replicate your environment. This tool supports install components from another existing Eclipse instance to save the time cost on downloading them from Internet now! Enjoy it.&lt;/p></description></item><item><title>useful network utility tools</title><link>https://kane.mx/posts/archive/blogspot/useful-network-utility-tools/</link><pubDate>Thu, 11 Mar 2010 14:53:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/useful-network-utility-tools/</guid><description>&lt;p>1. tcpdump&lt;br>
tcpdump -n port 80 -i eth0|lo&lt;br>
monitor all package transferred on 80 port on the network interface eth0/lo&lt;br>
2. netstat&lt;br>
netstat -anp|grep java&lt;br>
trace all network traffic on the process named java&lt;br>
netstat -anp|grep 128.224.159.xxx&lt;br>
trace all network traffic on the host whose ip address is 128.224.159.xxx&lt;br>
3. nslookup&lt;br>
nslookup 206.191.52.46&lt;br>
look up the domain name whose ip address is 206.191.52.46&lt;/p></description></item><item><title>[tip]Find -exec tip</title><link>https://kane.mx/posts/archive/blogspot/find-exec-tip/</link><pubDate>Wed, 24 Feb 2010 13:46:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/find-exec-tip/</guid><description>&lt;p>Using -exec command like below, need add escape character for semicolon that separated two commands in shell&lt;/p>
&lt;p>find directory/ -type d -exec chmod a+x {} \;&lt;/p>
&lt;p>Feb 24, 2010 - update:&lt;br>
find . -maxdepth 4 -type dÂ  -name &amp;lsquo;g-vxworks&amp;rsquo; 2&amp;gt;/dev/null -print&lt;/p></description></item><item><title>special characters in p2 touchpoint instruction</title><link>https://kane.mx/posts/archive/blogspot/special-characters-in-p2-touchpoint/</link><pubDate>Fri, 05 Feb 2010 16:15:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/special-characters-in-p2-touchpoint/</guid><description>&lt;p>I suffered p2 installation failed on the configure parse. Becase I try to add vm arguments for my application.&lt;br>
For example, I added &amp;lsquo;-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=8272&amp;rsquo; in the product configuration.&lt;br>
P2 will fail when parsing the argument, because it contains &amp;lsquo;:&amp;rsquo; and &amp;lsquo;,&amp;rsquo; that should be escaped.&lt;br>
It works again after replacing it to &amp;lsquo;-agentlib${#58}jdwp=transport=dt_socket${#44}server=y${#44}suspend=n${#44}address=8272&amp;rsquo;.&lt;br>
The more detail note could be found in &lt;a href="http://wiki.eclipse.org/Equinox/p2/Engine/Touchpoint_Instructions#Variables_Available_in_all_phases">p2 touchpoint wiki&lt;/a>.&lt;br>
And I also opened &lt;a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=301927">bug&lt;/a> to request improving it.&lt;/p></description></item><item><title>mount windows share folder</title><link>https://kane.mx/posts/archive/blogspot/mount-windows-share-folder/</link><pubDate>Fri, 29 Jan 2010 13:22:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/mount-windows-share-folder/</guid><description>&lt;p>mount -t cifs -o username=xxx,password=xxx,workgroup=xx,iocharset=utf8 //share.domain/folder /localfolder&lt;/p></description></item><item><title>the way to dump hex file</title><link>https://kane.mx/posts/archive/blogspot/way-to-dump-hex-file/</link><pubDate>Wed, 27 Jan 2010 17:27:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/way-to-dump-hex-file/</guid><description>&lt;p>1. open the file in vim, :%!xxd&lt;br>
2. hexdump&lt;/p></description></item><item><title>How to get the name of running test case in JUnit4</title><link>https://kane.mx/posts/archive/blogspot/how-to-get-name-of-running-test-case-in/</link><pubDate>Mon, 11 Jan 2010 14:57:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/how-to-get-name-of-running-test-case-in/</guid><description>&lt;pre>&lt;code>public class NameRuleTest { Â  Â  @Rule public TestName name = new TestName(); Â  Â  Â  Â  @Test public void testA() { Â  Â  Â  Â  Â  Â  Â  Â  assertEquals(&amp;quot;testA&amp;quot;, name.getMethodName()); Â  Â  Â  Â  }Â  Â  Â  Â  @Test public void testB() { Â  Â  Â  Â  Â  Â  Â  Â  assertEquals(&amp;quot;testB&amp;quot;, name.getMethodName()); Â  Â  Â  Â  }}&lt;/code>&lt;/pre></description></item><item><title>How p2 UI handles with license agreements</title><link>https://kane.mx/posts/archive/blogspot/how-p2-ui-handles-with-license/</link><pubDate>Wed, 30 Dec 2009 16:56:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/how-p2-ui-handles-with-license/</guid><description>&lt;p>P2 install wizard firstly query the repository to find out the root installable unit(as well as top installable). Then p2 recalculate the dependency and try to search the requirements in all available repositories after user submits their installation request. Go to the license agreement page if all the dependencies are satisfied.&lt;/p>
&lt;p>P2 agreement page obtains all the units to be installed from the operands of provision plan. The number always is much greater than the number submitted by user. Because the submitted IUs only are the root IUs.&lt;/p>
&lt;p>P2 UI would check the unaccepted licenses comparing to before records. The policy class of p2 UI provides the license manager to record the even accepted license. It traverses all the installable units, querying its license whether it has already been accepted if it has. If the license agreement has been accepted, it would be ignored, won&amp;rsquo;t be shown in the agreement page. Otherwise, new record is created to mark it as accepted by the license manager and display it in the agreement wizard page.&lt;/p>
&lt;p>The default implementation of license manager would persist the accepted information in the file &amp;ndash; &lt;!-- raw HTML omitted -->/.metadata/.plugins/org.eclipse.equinox.p2.ui.sdk/license.xml.&lt;/p></description></item><item><title>[tip]ssh key</title><link>https://kane.mx/posts/archive/blogspot/ssh-key/</link><pubDate>Tue, 29 Dec 2009 11:33:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/ssh-key/</guid><description>&lt;p>Setup SSH without password.&lt;br>
a) execute &amp;ldquo;ssh-keygen -t rsa&amp;rdquo; under your linux/unix login to get the RSA keys.&lt;br>
(press Enter for all)&lt;br>
You will get 2 files uner ~/.ssh/, id_rsa and id_rsa.pub&lt;br>
b) Put the public key id_rsa.pub to your remote host: ~/.ssh/authorized_keys If the remote host share the same nfs, just try &amp;quot; cat id_rsa.pub &amp;raquo; ~/.ssh/authorized_keys&amp;quot;&lt;br>
* Remember to modify hostname or ip info in ~/.ssh/authorized_keys to &amp;ldquo;&lt;em>&amp;rdquo;, so that you can login from any host without password in your NIS domain.&lt;br>
For example:&lt;br>
ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA4Ri5J0s1BL/+mR7RfAuDW6FY2P6ILc61Zvw1BdDkvHMFrTzaC/AUMw33H7biAMCXuCleakCuSoV8ZDiGHYs4wOVvet5sDmphkwdiC4xTekdl3dRNvGjMVbvFUta/Y5CiayL6YIu47Ro6Vvu4Mutsrv/13pTlifrEz+NTR/+bzMb9nTniCwiryMyYod3E46b8WvS8yE3WK+tH4BZE8bjiCwdvAzSdPyk/OFNrlBNuF1yewwnxv1roRD3UalT2+7O4kfEG9sMvvBHjuX2l7xlUe3stBftYpigBbwGmmadxjRpNIlk88t5xKcQX6nSu7V8HI3GWPHI0D+ISIlbfU5Sunw== kzhu0@&lt;/em>&lt;/p></description></item><item><title>[Eclipse][P2]P2 replication plug-in</title><link>https://kane.mx/posts/archive/blogspot/p2-replication-plug-in/</link><pubDate>Fri, 25 Dec 2009 16:43:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/p2-replication-plug-in/</guid><description>&lt;p>I wrote a plug-in to simplify the process to install the same plug-ins in different platform or different workstation.&lt;br>
Anyone is interested in it, pls follow below guide to freely use it.&lt;br>
&lt;a href="http://code.google.com/p/kane-toolkit/wiki/P2Replication">http://code.google.com/p/kane-toolkit/wiki/P2Replication&lt;/a>&lt;/p>
&lt;p>Enjoy it.&lt;/p></description></item><item><title>[eclipse]How Equinox load bundles</title><link>https://kane.mx/posts/archive/blogspot/how-equinox-load-bundles/</link><pubDate>Wed, 02 Dec 2009 14:58:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/how-equinox-load-bundles/</guid><description>&lt;h1 id="how-equinox-load-bundles">How Equinox load bundles&lt;/h1>
&lt;p>Equinox launcher is responsible to start OSGi framework. The system bundle would be created and marked as installed when initializing the framework. Equinox also tries to install the installed bundles if finding them in persistence data during the initializing period. Of course there is no extra bundles would be installed when launching Equinox first time.&lt;br>
&lt;img src="http://docs.google.com/drawings/image?id=sNT8DMKTCXXaH4PoaQOafoA&amp;amp;w=400&amp;amp;h=400&amp;amp;rev=109&amp;amp;ac=1" alt="">&lt;/p>
&lt;p>Then Equinox launcher would install the bundles specified by vm&amp;rsquo;s system property &amp;lsquo;osgi.bundles&amp;rsquo;. And start the initial bundles that are marked as early start. For example, let&amp;rsquo;s have a look at the configuration/config.ini of Eclipse, you would find a line similar as below,&lt;br>
osgi.bundles=reference\:file\:org.eclipse.equinox.simpleconfigurator_1.0.200.v20090831.jar@1\:start&lt;br>
It means the start level of bundle &amp;lsquo;org.eclipse.equinox.simpleconfigurator_1.0.200.v20090831.jar&amp;rsquo; is 1, and it would be started after installing it.&lt;/p>
&lt;p>Here you would ask there are only two bundles are installed(one is system bundle &amp;lsquo;org.eclipse.osgi&amp;rsquo;, the other is &amp;lsquo;org.eclipse.equinox.simpleconfigurator&amp;rsquo;) when launching Equinox, how the other bundles are installed? It&amp;rsquo;s done by the activate method of &amp;lsquo;simpleconfigurator&amp;rsquo; bundle. The available bundles are recorded in plain text file configuration/org.eclipse.equinox.simpleconfigurator/bundles.info, simpleconfigurator read the file then install those bundles.&lt;/p>
&lt;p>It&amp;rsquo;s a new bundle management introduced by p2. P2 also supports the traditional way to install extensions, such as link file, .eclipseproduct file and directly copying features/plugins.&lt;br>
Below table lists the p2 bundles to implement the compatibility installation feature,&lt;/p>
&lt;p>Bundle&lt;/p>
&lt;p>Usage&lt;/p>
&lt;p>org.eclipse.equinox.p2.directorywatcher&lt;/p>
&lt;p>the definition and implementation of directory watcher API&lt;/p>
&lt;p>org.eclipse.equinox.p2.updatesite&lt;/p>
&lt;p>the implementation of updatesite repository&lt;/p>
&lt;p>org.eclipse.equinox.p2.extensionlocation&lt;/p>
&lt;p>the implementation of extension repository&lt;/p>
&lt;p>org.eclipse.equinox.p2.reconciler.dropins&lt;/p>
&lt;p>scan dropin folder and link files; watch the traditional configuration file used by update manager&lt;/p>
&lt;p>P2 reconciler would scan the dropin, link folder and legacy configuration file in every Equinox launching. You can disable the capability by marking it not be early start.&lt;br>
org.eclipse.equinox.p2.reconciler.dropins,1.0.100.v20091010,plugins/org.eclipse.equinox.p2.reconciler.dropins_1.0.100.v20091010.jar,4,false&lt;/p>
&lt;p>If finding some new bundles in dorpin folder, the reconciler would add the new bundles into a local metadata repository that is stored as OSGi data of Equinox. Then synchronize the bundles into the current p2 profile, then add the new bundles into bundles.info file.&lt;/p></description></item><item><title>[Eclipse][P2]Learn p2 step by step</title><link>https://kane.mx/posts/archive/blogspot/learn-p2-step-by-step/</link><pubDate>Thu, 12 Nov 2009 17:48:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/learn-p2-step-by-step/</guid><description>&lt;h1 id="learn-p2-step-by-step">Learn p2 step by step&lt;/h1>
&lt;p>&lt;a href="mailto:kane.mx@gmail.com" title="Kane">Kane&lt;/a> Â Â Â  Â Â Â  Â Â Â  Â Â &lt;/p>
&lt;p>Â Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â Â &lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;a href="http://www.blogger.com/post-edit.g?blogID=8314384370778429245&amp;amp;postID=6549693887265291061#Learn_P2_step_by_step">Learn P2 step by step&lt;/a>&lt;/p>
&lt;ol>
&lt;li>&lt;a href="http://www.blogger.com/post-edit.g?blogID=8314384370778429245&amp;amp;postID=6549693887265291061#p2_concept">p2 concept&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.blogger.com/post-edit.g?blogID=8314384370778429245&amp;amp;postID=6549693887265291061#p2_install">p2 install&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.blogger.com/post-edit.g?blogID=8314384370778429245&amp;amp;postID=6549693887265291061#p2_install_practice">p2 install practice&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.blogger.com/post-edit.g?blogID=8314384370778429245&amp;amp;postID=6549693887265291061#p2_repository_publish">p2 repository publish&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.blogger.com/post-edit.g?blogID=8314384370778429245&amp;amp;postID=6549693887265291061#customized_p2_touchpoint">customized p2 touchpoint&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.blogger.com/post-edit.g?blogID=8314384370778429245&amp;amp;postID=6549693887265291061#p2_repository_publish_practice">p2 repository publish practice&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.blogger.com/post-edit.g?blogID=8314384370778429245&amp;amp;postID=6549693887265291061#Example_Code">Example Code&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.blogger.com/post-edit.g?blogID=8314384370778429245&amp;amp;postID=6549693887265291061#Reference">Reference&lt;/a>&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol>
&lt;h3 id="p2-concept">p2 concept&lt;/h3>
&lt;p>é¦–å…ˆæ¥ç†è§£p2å¼•å…¥çš„å‡ ä¸ªæ¦‚å¿µ[1]&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>p2 / Agent&lt;/strong>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>The provisioning infrastructure on client machines&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Installable Unit (IU)&lt;/strong>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Metadata&lt;/strong> that describes things that can be installed/configured&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Artifact&lt;/strong>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>The actual content being installed/configured(e.g., bundle JARs)&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Repository&lt;/strong>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>A store of metadata or artifacts&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Profile&lt;/strong>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>The target of install/management operations&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Planner&lt;/strong>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>The decision-making entity in the provisioning system&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Engine&lt;/strong>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>The mechanism for executing provisioning requests&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Touchpoint&lt;/strong>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>The part of the engine responsible for integrating the provisioning&lt;br>
system to a particular runtime or management system&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>IUæ¯”è¾ƒå¥½ç†è§£ï¼Œå°±æ˜¯å¯¹å¯å®‰è£…æˆ–é…ç½®çš„éƒ¨åˆ†ä¸€ç§æè¿°ï¼Œå¹¶ä¸å¯¹åº”å®é™…è¦å®‰è£…çš„æ–‡ä»¶ã€‚&lt;br>
Arifactå°±æ˜¯æ¥æè¿°å®é™…è¦å®‰è£…çš„æ–‡ä»¶ï¼Œbundleç±»å‹çš„jarï¼Œfeatureï¼Œbinaryæ–‡ä»¶ã€‚&lt;br>
è¿™æ—¶å°±æœ‰äº†Repositoryï¼ˆä»“åº“ï¼‰è¿™ä¸ªæ¦‚å¿µï¼Œæ˜¯ç”¨æ¥ä¿å­˜artifactsä¿¡æ¯ï¼Œä»¥åŠartifactsçš„å…ƒæ•°æ®ã€‚å…ƒæ•°æ®åŒ…æ‹¬äº†å¯¹artifactçš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç‰ˆæœ¬ï¼Œå¯¹å¤–æš´éœ²çš„æ¥å£ä¿¡æ¯ï¼Œä»¥åŠå®ƒä¾èµ–çš„æ¥å£åŠå…¶ç‰ˆæœ¬ä¿¡æ¯ï¼Œå„ä¸ªå®‰è£…é˜¶æ®µéœ€è¦æ‰§è¡Œçš„é…ç½®ã€‚åœ¨p2é»˜è®¤çš„å®ç°é‡Œé¢ï¼Œè¿™ä¸¤ä¸ªrepositoryç”¨xmlæ–‡ä»¶æ¥æè¿°ï¼ŒåŒæ—¶è¢«å‹ç¼©ä¸ºartifacts.jar, content.jaræ¥å‡å°æ–‡ä»¶å¤§å°ï¼Œç¼©çŸ­ä¼ è¾“æ—¶é—´ã€‚&lt;br>
ä»Eclipse 3.4èµ·ï¼Œå½“ä»è¿œç¨‹siteå®‰è£…æ–°çš„è½¯ä»¶æ—¶ï¼Œå°±ä¼šçœ‹åˆ°æœ‰ä¸ªwork threadåœ¨åå°ä¸‹è½½content.jaræ–‡ä»¶ã€‚p2åœ¨å®‰è£…æ—¶å€™ï¼Œé¦–å…ˆä¼šæ ¹æ®content.xmlï¼ˆmetadata repositoryï¼‰æ¥è§£ææ­£åœ¨å®‰è£…è½¯ä»¶çš„ä¾èµ–ã€‚åœ¨å½“å‰runtimeé‡Œé¢æŸ¥æ‰¾metadataä¸­æŒ‡å®šçš„ä¾èµ–ï¼Œå¦‚æœæ»¡è¶³æ‰ç»§ç»­å®‰è£…ã€‚æ®æˆ‘ä¸ªäººç»éªŒï¼Œå¦‚æœå®‰è£…çš„è½¯ä»¶æ¯”è¾ƒå¤æ‚ï¼Œé‚£å®ƒäº§ç”Ÿçš„metadataæ–‡ä»¶å°±ä¼šæ¯”è¾ƒå¤§ï¼ˆå¾ˆå®¹æ˜“ä¸Šå…†ï¼‰ï¼Œä¸‹è½½è¿™ä¸ªæ–‡ä»¶ä»¥åŠè§£æå®ƒçš„å†…å®¹éƒ½ä¼šæ¯”è¾ƒæ…¢ï¼Œä»è€Œå½±å“ç”¨æˆ·ä½“éªŒã€‚&lt;br>
æ¯”è¾ƒçµæ´»çš„æ˜¯ï¼Œç”¨æˆ·å¯ä»¥å®ç°è‡ªå·±çš„ArtifactRepositoryå’ŒMetadataRepositoryï¼Œæ³¨å†Œåˆ°å®ƒä»¬å„è‡ªçš„Manageré‡Œé¢å°±å¯ä»¥äº†ã€‚æ‰€æœ‰è¿™äº›æœåŠ¡éƒ½è¢«å®ç°ä¸ºOSGi Service.&lt;br>
ä¸‹ä¸€ä¸ªProfileï¼Œæ˜¯ç”¨æ¥ç®¡ç†å®‰è£…ç›®æ ‡é‡Œçš„è½¯ä»¶ä¿¡æ¯ã€‚p2åœ¨è¢«è®¾è®¡çš„æ—¶å€™ï¼Œå¸Œæœ›è§£å†³å¤šä¸ªeclipseå®ä¾‹å…±äº«ä¸€ä»½å®‰è£…çš„æŸè½¯ä»¶ã€‚æ¯”å¦‚ä¸ºäº†æŸç§ç›®çš„æˆ‘æœºå™¨ä¸Šæœ‰å¥½å‡ ä¸ªEclipseï¼ŒåŒæ—¶å®ƒä»¬éƒ½éœ€è¦CDTï¼Œå…å»ä¸ºé‡å¤å®‰è£…çš„éº»çƒ¦ã€‚profileå°±ä¼šè®°å½•æ¯æ¬¡å®‰è£…çš„å†…å®¹ï¼Œè®©æ•´ä¸ªåº”ç”¨ç¨‹åºè¢«ç®¡ç†èµ·æ¥ã€‚åœ¨Galileoé‡Œå®‰è£…çš„è½¯ä»¶éƒ½å¯ä»¥è½¯ä»¶ç®¡ç†é‡Œé¢æŸ¥æ‰¾åˆ°ã€‚&lt;br>
Plannerå’ŒEngineå®Œå…¨å°±æ˜¯p2å†…éƒ¨çš„ä¸œè¥¿ã€‚ä»»ä½•p2çš„æ“ä½œï¼ˆå®‰è£…ï¼Œåˆ é™¤ï¼Œé…ç½®ï¼‰éƒ½éœ€è¦Plannerå®ä¾‹æ¥æè¿°ã€‚æœ‰äº†Plannerä»¥åï¼Œè¿˜éœ€è¦åˆ›å»ºä¸€ä¸ªEngineå¯¹è±¡ï¼Œé€šè¿‡engineæ¥æ‰§è¡Œå¯¹åº”çš„planã€‚è¿™å°±æ˜¯ç›®å‰è°ƒç”¨p2 APIæ¥å®Œæˆå®‰è£…çš„ä¸€ä¸ªè¿‡ç¨‹ã€‚&lt;br>
æœ€åä¸€ä¸ªTouchpointã€‚ç¨‹åºåœ¨å®‰è£…çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šæ ¹æ®runtime(os, ws, archç­‰ï¼‰æˆ–é˜¶æ®µ(å®‰è£…ï¼Œå¸è½½ï¼Œé…ç½®ç­‰)æ‰§è¡ŒæŸäº›é…ç½®ï¼Œtouchpointå°±æ˜¯å¸®åŠ©å®ç°è¿™äº›é…ç½®ã€‚å…·ä½“æ“ä½œæ˜¯ä»¥IUä¸ºå•ä½è®°å½•åœ¨metadata repositoryé‡Œçš„ã€‚p2é»˜è®¤å®ç°äº†ä¸€äº›Eclipse touchpointï¼Œæ¯”å¦‚æ‹·è´ï¼Œåˆ é™¤æ–‡ä»¶ï¼Œæ‰§è¡Œå¤–éƒ¨ç¨‹åºç­‰ã€‚å¦‚æœç”¨æˆ·æœ‰è‡ªå·±ç‰¹æ®Šçš„nativeæ“ä½œéœ€è¦æ‰§è¡Œï¼Œå¯ä»¥è‡ªå·±å®ç°è‡ªå®šä¹‰çš„touchpointã€‚&lt;/p>
&lt;h3 id="p2-install">p2 install&lt;/h3>
&lt;p>æœ‰äº†è¿™äº›æ¦‚å¿µä»¥åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨p2 APIã€‚ä»¥å®‰è£…ä¸ºä¾‹ï¼Œ&lt;/p>
&lt;p>é¦–å…ˆéœ€è¦å¾—åˆ°å½“å‰å®‰è£…çš„profileã€‚å¦‚æœæ˜¯å…¨æ–°å®‰è£…ï¼Œé€šè¿‡IProfileRegistry.addProfileåˆ›å»ºä¸€ä¸ªæ–°profileã€‚æ˜¯æ›´æ–°å®‰è£…çš„è¯ï¼Œå¯ä»¥é€šè¿‡IProfileRegistryæŸ¥è¯¢åˆ°æœŸæœ›æ›´æ–°çš„profileã€‚åˆ›å»ºprofileçš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„è®¾ç½®profileçš„å±æ€§ï¼Œ&lt;/p>
&lt;p>Map&amp;lt;String, String&amp;gt; profileProperties = new HashMap&amp;lt;String, String&amp;gt;();&lt;/p>
&lt;p>profileProperties.put(IProfile.PROP_INSTALL_FOLDER, installLocation.getAbsolutePath());&lt;/p>
&lt;p>profileProperties.put(IProfile.PROP_FLAVOR, &amp;ldquo;tooling&amp;rdquo;); //$NON-NLS-1$&lt;/p>
&lt;p>profileProperties.put(IProfile.PROP_ENVIRONMENTS, &amp;ldquo;osgi.os=&amp;rdquo; + Platform.getOS() + &amp;ldquo;,osgi.ws=&amp;rdquo; + Platform.getWS() + &amp;ldquo;,osgi.arch=&amp;rdquo; + Platform.getOSArch()); //$NON-NLS-1$;&lt;/p>
&lt;p>profileProperties.put(IProfile.PROP_NL, &amp;ldquo;en_US&amp;rdquo;); //$NON-NLS-1$&lt;/p>
&lt;p>profileProperties.put(IProfile.PROP_INSTALL_FEATURES, &amp;ldquo;true&amp;rdquo;);&lt;/p>
&lt;p>profileProperties.put(IProfile.PROP_CONFIGURATION_FOLDER, new File(installLocation, &amp;ldquo;configuration&amp;rdquo;).getAbsolutePath());&lt;/p>
&lt;p>profileProperties.put(IProfile.PROP_ROAMING, &amp;ldquo;true&amp;rdquo;);&lt;/p>
&lt;p>profileProperties.put(IProfile.PROP_CACHE, installLocation.getAbsolutePath());&lt;/p>
&lt;p>currentProfile = registry.addProfile(PROFILE_ID, profileProperties);&lt;/p>
&lt;p>PROP_INSTALL_FOLDERè®¾ç½®å®‰è£…çš„ç›®å½•ï¼ŒPROP_CACHEè®¾ç½®ä¿å­˜ä¸‹è½½æ¥çš„Eclipse IU(features/plugins)çš„ç›®å½•ï¼Œå¦‚æœrepositoryæ˜¯ä»¥featureä¸ºå•ä½æ¥å‘å¸ƒçš„è¯ï¼Œéœ€è¦è®¾ç½®PROP_INSTALL_FEATURESä¸ºtrueã€‚å¦‚æœrepositoryåŒ…æ‹¬nativeçš„binaryï¼ˆæ¯”å¦‚launcherï¼‰ä¹Ÿéœ€è¦æŒ‡å®šæ­£ç¡®çš„PROP_ENVIROMENTSï¼ŒåŒ…æ‹¬OS,WS,ARCHæˆ–PROCESSORã€‚&lt;/p>
&lt;p>ç„¶åéœ€è¦è·å¾—å°†è¦å®‰è£…çš„IMetadataRepositoryé›†åˆã€‚æ¯”å¦‚ï¼š&lt;/p>
&lt;p>ArrayList&lt;!-- raw HTML omitted --> ius = new ArrayList&lt;!-- raw HTML omitted -->();&lt;/p>
&lt;p>IMetadataRepositoryManager repositoryManager = (IMetadataRepositoryManager) ServiceHelper.getService(Activator.getDefault().getBundle().getBundleContext(),&lt;/p>
&lt;p>IMetadataRepositoryManager.class.getName());Â &lt;/p>
&lt;p>if (repositoryManager == null)Â &lt;/p>
&lt;p>Â Â  Â  Â  throw new InterruptedException(&amp;ldquo;Failed to get IMetadataRepositoryManager.&amp;quot;);&lt;/p>
&lt;p>try {&lt;/p>
&lt;p>Â Â for (URI uri : uris) {&lt;/p>
&lt;p>Â Â  Â IMetadataRepository metaRepo = repositoryManager.loadRepository(uri, progress.newChild(50/uris.length));&lt;/p>
&lt;p>Â Â  Â Collector collector = metaRepo.query(new AccpetQuery(), new LatestNoninstalledIUCollector(currentProfile), progress.newChild(50/uris.length));&lt;/p>
&lt;p>Â Â  Â  ius.addAll(collector.toCollection());&lt;/p>
&lt;p>Â Â }&lt;/p>
&lt;p>} catch (ProvisionException e) {&lt;/p>
&lt;p>Â Â  Â throw new InterruptedException(&amp;ldquo;Failed to get IMetadataRepository.&amp;quot;);&lt;/p>
&lt;p>}&lt;br>
Â Â  Â  -åŒæ—¶è¿™é‡Œä¹ŸæŸ¥æ‰¾å‡ºIMetaRepositoryä¸­æ²¡å®‰è£…è¿‡çš„IUsã€‚è¿™å°±éœ€è¦åŒå½“å‰å®‰è£…çš„profileä¸­å·²ç»å®‰è£…è¿‡çš„å†…å®¹æ¥æ¯”è¾ƒï¼Œ&lt;/p>
&lt;p>Â Â  Â Collector collector = metaRepo.query(new AccpetQuery(), new LatestNoninstalledIUCollector(currentProfile), progress.newChild(50/uris.length));&lt;/p>
&lt;p>Â Â  Â Â è¿™é‡Œéœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼ŒIMetadataRepositoryå®ç°äº†IQueryableæ¥å£ã€‚IQueryableæ˜¯p2å¼•å…¥çš„æŸ¥æ‰¾æ¥å£ï¼Œè¿”å›æ»¡è¶³ç‰¹æ®ŠæŸ¥è¯¢æ¡ä»¶çš„é›†åˆï¼ŒåŒæ—¶ä¼ å…¥äº†ä¸€ä¸ªIProgressMonitorå¯¹è±¡ï¼Œå¯ä»¥ååº”æŸ¥æ‰¾è¿›åº¦ã€‚è¿™é‡Œçš„AcceptQueryï¼ŒLatestNoninstalledIUCollectoræ˜¯è‡ªå®šä¹‰çš„Queryå’ŒCollectorå¯¹è±¡ã€‚p2å·²ç»å®ç°äº†è®¸å¤šæœ‰ç”¨çš„Queryï¼Œç»å¸¸ç”¨åˆ°çš„æœ‰InstallableUnitQueryï¼ŒIUPropertyQueryï¼ŒRangeQueryã€‚&lt;/p>
&lt;p>Â Â  Â -æ¥ä¸‹æ¥ç”ŸæˆIEngineæ‰€éœ€çš„ProvisionPlanã€‚é¦–å…ˆåˆ›å»ºProfileChangeRequestå¯¹è±¡ï¼Œå°†å…ˆå‰æŸ¥æ‰¾å‡ºçš„è¦å®‰è£…çš„IUsæ·»åŠ è¿›å»ã€‚&lt;/p>
&lt;p>Â Â  Â Â request.addInstallableUnits(ius);&lt;/p>
&lt;p>Â Â  Â Â åˆ é™¤çš„è¯åˆ™ä¸ä¹‹ç›¸åã€‚æ›´æ–°çš„è¯ä¹Ÿéœ€è¦é€šè¿‡ProfileChangeRequest.removeInstallableUnits()å»æ‰æ—§ç‰ˆæœ¬çš„IUsã€‚&lt;/p>
&lt;p>Â Â  Â Â è°ƒç”¨IPlanner serviceçš„getProvisioningPlan(ProfileChangeRequest, ProvisioningContext, IProgressMonitor)å¾—åˆ°å¯¹åº”äºå½“å‰requestçš„planã€‚&lt;/p>
&lt;p>Â Â  Â -æœ€åå°±æ˜¯è°ƒç”¨IEngine.perform(IProfile, PhaseSet, Operand[], ProvisioningContext, IProgressMonitor)æ¥æ‰§è¡Œprovisioningæ“ä½œã€‚è¿™é‡Œçš„PhaseSetæ˜¯ç”¨æ¥æŒ‡å®šEngineå°†è¦æ‰§è¡Œçš„å‡ ä¸ªé˜¶æ®µï¼Œä»¥åŠæ¯ä¸ªé˜¶æ®µçš„æ‰§è¡Œæ—¶é—´æƒé‡ã€‚è¿™äº›é˜¶æ®µåŒ…æ‹¬äº†Collect, Unconfigure, Uninstall, Property, CheckTrust, Install, Configure. å¦‚æœç†Ÿæ‚‰Eclipseä¹‹å‰çš„Installer Handlerï¼Œå¯¹Unconfigure/Uninstall/Install/Configureåº”è¯¥éƒ½å¾ˆç†Ÿæ‚‰ã€‚ åœ¨p2é‡Œï¼Œæ›´æ˜¯å°†Collect, CheckTrustè¿™äº›è¿‡ç¨‹ä¹Ÿæš´éœ²äº†å‡ºæ¥ã€‚ä¸‹é¢æ˜¯p2é‡Œé»˜è®¤PhaseSetçš„å®ç°ï¼Œ&lt;/p>
&lt;p>Â Â  Â Â Â  Â public DefaultPhaseSet() {&lt;/p>
&lt;p>Â Â  Â Â Â  Â Â Â  Â this(new Phase[] {new Collect(100), new Unconfigure(10, forcedUninstall), new Uninstall(50, forcedUninstall), new Property(1), new CheckTrust(10), new Install(50), new Configure(10)});&lt;/p>
&lt;p>Â Â  Â Â Â  Â }&lt;/p>
&lt;p>Â Â  Â  Operand[]é€šè¿‡ProvisionPlan.getOperands()è·å¾—ã€‚&lt;/p>
&lt;h3 id="p2-install-practice">p2 install practice&lt;/h3>
&lt;p>å…ˆåˆ¶ä½œä¸€ä¸ªå¯å®‰è£…çš„repositoryï¼Œè¿™é‡Œçš„æ–¹æ³•æ˜¯åŸºäºEclipseæä¾›çš„æ¨¡ç‰ˆåˆ›å»ºä¸€ä¸ªRCPç¨‹åºï¼Œæ¯”å¦‚mail template,&lt;/p>
&lt;p>&lt;a href="http://docs.google.com/File?id=ddqccrw2_871xs75p2fh_b">&lt;img src="http://docs.google.com/File?id=ddqccrw2_871xs75p2fh_b" alt="">&lt;/a>&lt;/p>
&lt;p>&lt;a href="http://docs.google.com/File?id=ddqccrw2_872fzbmznfm_b">&lt;img src="http://docs.google.com/File?id=ddqccrw2_872fzbmznfm_b" alt="">&lt;/a>&lt;/p>
&lt;p>ç„¶ååˆ›å»ºä¸€ä¸ªfeatureåŒ…å«åˆšæ‰åˆ›å»ºå‡ºæ¥çš„plug-in &amp;lsquo;com.example.mail&amp;rsquo;ã€‚&lt;/p>
&lt;p>åŸºäºå­˜åœ¨çš„â€˜com.example.mail.productâ€™åˆ›å»ºproduct configurationï¼Œå°†å…¶è®¾ç½®ä¸ºbase on features, åŒæ—¶åœ¨dependenciesé¡µé¢æ·»åŠ ä»¥ä¸‹featureã€‚featureçš„qaulifier idä¾èµ–äºç”¨åˆ°çš„Eclipsseç‰ˆæœ¬ï¼Œä»ä¸‹å›¾çœ‹åˆ°æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯Eclipse 3.5.1ã€‚å¦‚æœè¦è®©RCPç¨‹åºå…·æœ‰å®‰è£…æ’ä»¶çš„èƒ½åŠ›ï¼ˆåŒ…å«p2å’Œp2 UIï¼‰ï¼Œå°±éœ€è¦ä¾èµ–æ›´å¤šçš„featureã€‚åé¢çš„exampleé‡Œé¢ä¼šå®ç°è¿™éƒ¨åˆ†åŠŸèƒ½ã€‚å¦å¤–æ³¨æ„ï¼š&lt;a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=291872" title="IDä¸èƒ½åŒ…æ‹¬ç©ºæ ¼å­—ç¬¦">IDä¸èƒ½åŒ…æ‹¬ç©ºæ ¼å­—ç¬¦&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;a href="http://docs.google.com/File?id=ddqccrw2_873fx44c3ff_b">&lt;img src="http://docs.google.com/File?id=ddqccrw2_873fx44c3ff_b" alt="">&lt;/a>&lt;/p>
&lt;p>æ¥ä¸‹æ¥ä½¿ç”¨Eclipse Product Export Wizardç”Ÿæˆrepositoryã€‚è®°å¾—è¦å‹¾é€‰ä¸Šgenerate metadata repositoryã€‚&lt;/p>
&lt;p>&lt;a href="http://docs.google.com/File?id=ddqccrw2_874qnh7n3gc_b">&lt;/a>&lt;/p>
&lt;p>&lt;a href="http://docs.google.com/File?id=ddqccrw2_875gfs4p3d2_b">&lt;img src="http://docs.google.com/File?id=ddqccrw2_875gfs4p3d2_b" alt="">&lt;/a>&lt;/p>
&lt;p>åœ¨æˆåŠŸåˆ›å»ºäº†Mail Applicationçš„repositoryåï¼Œè¯•ç”¨æˆ‘ä»¬è‡ªå·±çš„p2 installeræ¥å®‰è£…è¿™ä¸ªåº”ç”¨ç¨‹åºã€‚å®‰è£…è¿‡ç¨‹ç±»ä¼¼ä¸‹é¢çš„æˆªå›¾ã€‚ç„¶åæ‰§è¡Œ/folk/kzhu0/tmp/mailrcp/mailæ¥è¿è¡ŒMail Application.&lt;/p>
&lt;p>&lt;a href="http://docs.google.com/File?id=ddqccrw2_877cm6fxcc6_b">&lt;img src="http://docs.google.com/File?id=ddqccrw2_877cm6fxcc6_b" alt="">&lt;/a>&lt;/p>
&lt;p>&lt;a href="http://docs.google.com/File?id=ddqccrw2_878dg9g8kf4_b">&lt;img src="http://docs.google.com/File?id=ddqccrw2_878dg9g8kf4_b" alt="">&lt;/a>&lt;/p>
&lt;h3 id="p2-repository-publish">p2 repository publish&lt;/h3>
&lt;p>è¿™ä¸€èŠ‚å°†ä¼šå±•ç¤ºå¦‚ä½•å‘å¸ƒ/äº§ç”ŸåŸºäºp2çš„repositoryã€‚åœ¨p2æœ€æ—©çš„ç‰ˆæœ¬Eclipse 3.4ä¸­å°†ç”Ÿæˆrepositoryè¿™ä¸ªç¨‹åºç§°ä¸ºgeneratorï¼Œè€Œ3.5å¯¹æ­¤é‡æ„åå‘½åä¸ºpublisherã€‚é‡æ„åçš„publishè¿‡ç¨‹ç®€å•æ˜äº†ã€‚é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªIPublishInfoå¯¹è±¡ï¼Œå®ƒè´Ÿè´£æä¾›å°†è¦ç”Ÿæˆçš„repositoryçš„æƒ…å†µã€‚åŒ…æ‹¬äº†meta repository, artifact repositoryçš„ä¿¡æ¯ï¼Œå±æ€§ï¼Œä»¥åŠæä¾›è¾…åŠ©ä¿¡æ¯çš„adviceå¯¹è±¡ã€‚IPublisherAdviceå¯ä»¥çœ‹ä½œç±»ä¼¼åˆ›å»ºRCPçª—å£æ—¶å€™çš„WorkbenchAdviceå’ŒWorkbenchWindowAdviceç­‰è¾…åŠ©ç±»ã€‚å®ƒç”¨æ¥æä¾›éœ€è¦è®°å½•åœ¨repositoryä¸­çš„IUç‰¹æ®Šä¿¡æ¯ã€‚æ¯”å¦‚IUçš„å±æ€§ï¼Œtouchpointçš„ç±»å‹åŠå„ä¸ªé˜¶æ®µæ‰§è¡Œçš„actionï¼Œå¯¹å¯æ‰§è¡Œæ–‡ä»¶æˆ–é…ç½®æ–‡ä»¶IUçš„å¤„ç†ã€‚&lt;br>
æ­¤å¤–è¿˜éœ€è¦åˆ›å»ºIPublisherActionæ¥å¤„ç†ä¸åŒç±»å‹çš„IUå‘å¸ƒè¿‡ç¨‹ã€‚ä¾‹å¦‚BundlesActionæ¥å®ç°å‘å¸ƒbundlesåˆ°repositoryï¼ŒFeaturesActionåˆ™æ˜¯å¤„ç†featureã€‚æ­¤å¤–p2å·²æä¾›çš„IPublisherActionè¿˜åŒ…æ‹¬product action, config action, launcher actionå’Œjre actionç­‰ç­‰[2]ã€‚&lt;br>
æœ‰äº†æè¿°repositoryæƒ…å†µçš„publishinfoå’Œå‘å¸ƒå„ç§IUsçš„actionåï¼Œè°ƒç”¨Publisher.publishæ–¹æ³•å®Œæˆrepositoryçš„å‘å¸ƒã€‚&lt;br>
Â Â  Â Â Â Â  IPublisherInfo info = createPublisherInfo();&lt;br>
Â Â  Â Â Â  Â IPublisherAction[] actions = createActions();&lt;br>
Â Â  Â Â Â  Â Publisher publisher = new Publisher(info);&lt;br>
Â Â  Â Â Â  Â publisher.publish(actions, new NullProgressMonitor());&lt;br>
è¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œpublishåªæ˜¯æŠŠå°†è¦ç”¨äºéƒ¨ç½²çš„features/plugins/binaryå‘å¸ƒåˆ°repositoryï¼Œå¹¶ä¸è´Ÿè´£ç¼–è¯‘æ‰“åŒ…å®ƒä»¬ã€‚å…ˆå‰æˆ‘ä»¬ä½¿ç”¨è¿‡Eclipse ExportåŠŸèƒ½æ—¢ç¼–è¯‘æ‰“åŒ…features/pluginsåŒæ—¶åˆç”Ÿæˆrepositoryã€‚Exportå®ç°çš„è¿‡ç¨‹é¦–å…ˆæ˜¯è°ƒç”¨PDEæ¥ç¼–è¯‘æ‰“åŒ…features/pluginsï¼Œå†è°ƒç”¨å¯¹åº”çš„publisheråº”ç”¨ç¨‹åºå°†ç¼–è¯‘åçš„features/plugins/productå‘å¸ƒä¸ºrepositoryã€‚&lt;/p>
&lt;h3 id="customized-p2-touchpoint">customized p2 touchpoint&lt;/h3>
&lt;p>å‰é¢ä¸€èŠ‚å·²ç»æè¿‡IPublishInfoé€šè¿‡é¢å¤–çš„IPublisherAdviseæ¥å®šåˆ¶å‘å¸ƒåˆ°repositoryçš„IUä¿¡æ¯ã€‚è¿™é‡Œä»‹ç»ä¸ºè‡ªå·±çš„IUå®šåˆ¶æ–°çš„touchpointç±»å‹ï¼Œå¹¶ä¸”è¦æ±‚åœ¨é…ç½®é˜¶æ®µåœ¨æ“ä½œç³»ç»Ÿæ¡Œé¢åˆ›å»ºåº”ç”¨ç¨‹åºçš„å¯åŠ¨å¿«æ·æ–¹å¼ã€‚é¦–å…ˆä¸ºæˆ‘ä»¬çš„PublisherInfoæ·»åŠ å¤„ç†touchpoint dataçš„adviceï¼ŒNativeLauncherTouchPointå®ç°äº†ITouchpointAdviceæ¥å£ï¼Œpublisheråœ¨å‘å¸ƒçš„æ—¶å€™å½“å¤„ç†åˆ°touchpoint dataéƒ¨åˆ†ï¼Œä¼šæŸ¥æ‰¾å®ç°äº†ITouchpointAdviceæ¥å£çš„adviceã€‚å¦‚æœæœ‰adviceå¯ç”¨ï¼Œå°†ä¼šè®©è¿™äº›adviceå¤„ç†ç°æœ‰çš„touchpoint dataï¼Œå¹¶ä¸”å¾—åˆ°æ–°çš„touchpoint dataï¼Œå¹¶æŠŠç»“æœä¿å­˜åˆ°metadata repositoryå½“ä¸­ã€‚&lt;/p>
&lt;p>Â Â  Â Â Â Â  PublisherInfo result = new PublisherInfo();&lt;br>
Â Â  Â Â Â  Â result.addAdvice(new NativeLauncherTouchPoint());&lt;/p>
&lt;p>NativeLauncherTouchPointå°†æŒ‡å®šä¸ºç‰¹å®šçš„IUåœ¨configureé˜¶æ®µæ‰§è¡ŒcreateDesktopæ“ä½œï¼Œä»¥åŠç›¸åçš„æ“ä½œï¼Œunconfigureé˜¶æ®µæ‰§è¡ŒdeleteDesktopæ“ä½œã€‚&lt;/p>
&lt;p>æ›´æ”¹touchpoint typeçš„æ–¹æ³•å¦‚ä¸‹ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ä¸ºç°æœ‰çš„touchpoint typeæ‰©å±•actionã€‚å†…ç½®çš„touchpointç±»å‹å’Œactionçš„å…·ä½“å‘½ä»¤ç”¨æ³•ï¼Œè¯·å‚è€ƒp2 wiki[3]ã€‚&lt;br>
iu.setTouchpointType(DesktopTouchpoint.TOUCHPOINT_TYPE);&lt;br>
touchpointç±»å‹å’Œactionéƒ½æ˜¯é€šè¿‡extension pointæ¥æ‰©å±•çš„ã€‚é€šè¿‡æ‰©å±•â€œorg.eclipse.equinox.p2.engine.touchpointsâ€æ¥æ·»åŠ æ–°çš„touchpointç±»å‹ï¼Œæ‰©å±•â€org.eclipse.equinox.p2.engine.actionsâ€œå°†æ–°çš„actionåŒæŸä¸ªç±»å‹å…³è”èµ·æ¥ã€‚&lt;/p>
&lt;h3 id="p2-repository-publish-practice">p2 repository publish practice&lt;/h3>
&lt;p>æˆ‘ä»¬åˆ›å»ºplug-in &amp;lsquo;com.example.p2.touchpoint&amp;rsquo;æ¥å®ç°æ¡Œé¢å¿«æ·æ–¹å¼çš„æ‰©å±•ï¼Œå¹¶ä¸”åˆ›å»º&amp;rsquo;com.example.p2.feature&amp;rsquo;åŒ…å«touchpointå®ç°çš„plug-inã€‚å…·ä½“å®ç°è¯·å‚è€ƒp2 exampleæºç ã€‚&lt;br>
ç„¶åä¸ºMail Applicationæ·»åŠ p2ç›¸å…³featureçš„ä¾èµ–ï¼Œé‡æ–°å‘å¸ƒå¾—åˆ°æ”¯æŒå®‰è£…è½¯ä»¶çš„æ–°ç‰ˆæœ¬ã€‚å¹¶ä¸”ç”¨p2 example installerå®‰è£…å®ƒã€‚p.s: ä¸ªäººæ„Ÿè§‰Eclipseåœ¨åŒ…å«ç¬¬ä¸‰æ–¹plug-inæ—¶ï¼Œå±‚æ¬¡æœ‰äº›é—®é¢˜ã€‚p2ä½œä¸ºä¸€ä¸ªruntimeçš„projectï¼ˆè·Ÿequinox, ECFåŒçº§ï¼‰ï¼Œå±…ç„¶éœ€è¦ç›´æ¥æˆ–é—´æ¥ä¾èµ–help, rcp.platformè¿™æ ·çš„ä¸Šå±‚æ¨¡å—ã€‚&lt;/p>
&lt;p>&lt;a href="http://docs.google.com/File?id=ddqccrw2_879cjg6wrgg_b">&lt;img src="http://docs.google.com/File?id=ddqccrw2_879cjg6wrgg_b" alt="">&lt;/a>&lt;/p>
&lt;p>æ¥ä¸‹æ¥åˆ›å»ºplug-in &amp;lsquo;com.example.mail.desktop&amp;rsquo; å’Œ feature &amp;lsquo;com.example.mail.desktop.feature&amp;rsquo;ï¼Œä½œä¸ºæä¾›æ¡Œé¢å¿«æ·æ–¹å¼çš„IUã€‚ç”¨Eclipse Export Featureå°†&amp;rsquo;com.example.mail.desktop.feature&amp;rsquo;å¯¼å‡ºï¼Œå®é™…å°±æ˜¯ç”¨PDEæ›¿æˆ‘ä»¬ç¼–è¯‘æ‰“åŒ…:)ã€‚&lt;br>
è¿è¡Œâ€˜com.example.p2.generator&amp;rsquo;æä¾›çš„headless publisheræ¥ç”Ÿæˆæˆ‘ä»¬å®šåˆ¶çš„repositoryã€‚â€™/folk/kzhu0/tmp/mail/desktop-deploy&amp;rsquo;æ˜¯å…ˆå‰desktop featureå¯¼å‡ºåçš„è·¯å¾„ï¼Œè€Œ&amp;rsquo;/folk/kzhu0/tmp/mail/desktop&amp;rsquo;æ˜¯ç”Ÿæˆrepositoryçš„è·¯å¾„ã€‚&lt;/p>
&lt;p>&lt;a href="http://docs.google.com/File?id=ddqccrw2_880tk4fk8wd_b">&lt;img src="http://docs.google.com/File?id=ddqccrw2_880tk4fk8wd_b" alt="">&lt;/a>&lt;/p>
&lt;p>è¿è¡Œæ–°ç‰ˆæœ¬çš„Mail Applicationï¼Œåœ¨Helpèœå•ä¸‹é¢ä¼šå¤šå‡ºInstall New Softwareé€‰é¡¹ã€‚å°†è‡ªå®šä¹‰publisherç”Ÿæˆçš„Desktop feature repositoryæ·»åŠ ä¸ºæ–°çš„è½¯ä»¶æºï¼Œå®‰è£…Mail Desktop Featureã€‚å®‰è£…å®Œæˆåï¼Œå°†åœ¨æ¡Œé¢æ‰¾åˆ°Mail Applicationçš„å¿«æ·æ–¹å¼ã€‚åœ¨Installation Detailé‡Œé¢å°†ä¼šå‡ºç°è¿™æ¬¡å®‰è£…çš„å†…å®¹ã€‚é€‰ä¸­Desktop Featureåé€‰æ‹©å¸è½½ï¼Œæ¡Œé¢çš„å¿«æ·æ–¹å¼æ–‡ä»¶å°†ä¼šè¢«åˆ é™¤æ‰ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨p2 example installeræ¥ä¸ºMail Applicationå®‰è£…desktop featureã€‚p.s: exampleä»£ç é‡Œåªå®ç°äº†åˆ›å»ºlinux/unixæ¡Œé¢å¿«æ·æ–¹å¼ã€‚&lt;/p>
&lt;p>&lt;a href="http://docs.google.com/File?id=ddqccrw2_8814qg7wvhs_b">&lt;img src="http://docs.google.com/File?id=ddqccrw2_8814qg7wvhs_b" alt="">&lt;/a>&lt;/p>
&lt;h3 id="example-code">Example Code&lt;/h3>
&lt;p>Example Codeåº”è¯¥åªèƒ½ç¼–è¯‘è¿è¡Œåœ¨Eclipse 3.5.xã€‚Example Codeä½¿ç”¨çš„éƒ½æ˜¯p2 internal API, è€Œp2 public APIå°†ä¼šéšEclipse 3.6é¦–æ¬¡å‘å¸ƒã€‚è¿™äº›ç±»å’Œæ–¹æ³•åŸºæœ¬éƒ½ä¼šä¿ç•™ï¼Œä½†å‘½åï¼ŒåŒ…ä¸€å®šä¼šæœ‰é‡æ„ã€‚&lt;br>
&lt;a href="http://code.google.com/p/kane-toolkit/source/browse/#svn/trunk/p2-example">http://code.google.com/p/kane-toolkit/source/browse/#svn/trunk/p2-example&lt;/a>&lt;/p>
&lt;h3 id="reference">Reference&lt;/h3>
&lt;p>[1] &lt;a href="http://wiki.eclipse.org/Equinox/p2/Concepts">http://wiki.eclipse.org/Equinox/p2/Concepts&lt;/a>&lt;br>
[2] &lt;a href="http://wiki.eclipse.org/Equinox/p2/Publisher">http://wiki.eclipse.org/Equinox/p2/Publisher&lt;/a>&lt;br>
[3] &lt;a href="http://wiki.eclipse.org/Equinox/p2/Engine/Touchpoint_Instructions">http://wiki.eclipse.org/Equinox/p2/Engine/Touchpoint_Instructions&lt;/a>&lt;/p></description></item><item><title>[tip]ssh forward</title><link>https://kane.mx/posts/archive/blogspot/ssh-forward/</link><pubDate>Wed, 28 Oct 2009 15:29:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/ssh-forward/</guid><description>&lt;p>ssh -qTfnN -D LocalPort remotehost&lt;/p>
&lt;p>All the added options are for a ssh session that&amp;rsquo;s used for tunneling.&lt;/p>
&lt;p>-q :- be very quite, we are acting only as a tunnel.&lt;br>
-T :- Do not allocate a pseudo tty, we are only acting a tunnel.&lt;br>
-f :- move the ssh process to background, as we don&amp;rsquo;t want to interact with this ssh session directly.&lt;br>
-N :- Do not execute remote command.&lt;br>
-n :- redirect standard input to /dev/null.&lt;/p>
&lt;p>In addition on a slow line you can gain performance by enabling compression with the -C option.&lt;/p></description></item><item><title>Simulate p2 self host in Eclipse run</title><link>https://kane.mx/posts/archive/blogspot/simulate-p2-self-host-in-eclipse-run/</link><pubDate>Tue, 27 Oct 2009 16:12:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/simulate-p2-self-host-in-eclipse-run/</guid><description>&lt;p>-Dosgi.install.area=&amp;lt;launcher&amp;rsquo;s folder&amp;gt;&lt;br>
-Declipse.p2.profile=&lt;!-- raw HTML omitted -->&lt;/p></description></item><item><title>Eclipse/OSGi preference</title><link>https://kane.mx/posts/archive/blogspot/eclipseosgi-preference/</link><pubDate>Thu, 22 Oct 2009 15:29:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/eclipseosgi-preference/</guid><description>&lt;p>The IPreferenceStore API of Eclipse is based on OSGi&amp;rsquo;s preferences service.Â Equinox implementsÂ several scope context for different preferences, such DefaultScope, InstanceScope and ConfigurationScope. The IPreferenceStore is the wrapper of instance scope for back-compatibility. It stored the data in workspace(osgi.data.area).&lt;/p>
&lt;p>The workspace folder would be created when launching RCP application if it doesn&amp;rsquo;t exist. But we can use argument &amp;lsquo;-data @none&amp;rsquo; to suppress the creation of workspace. If that, the instance scope/IPreferenceStore can&amp;rsquo;t store any value any more.&lt;/p>
&lt;p>There is a workaround to resolve such issue. Use ConfigurationScope instead of InstanceScope. Both of them are implemented the same interface, so it&amp;rsquo;s easy to migrate to use ConfigurationScope. The data of configuration scope would be stored in @config.dir/.setting folder.&lt;/p></description></item><item><title>The usage of Eclipse's Proxy API</title><link>https://kane.mx/posts/archive/blogspot/usage-of-eclipses-proxy-api/</link><pubDate>Wed, 21 Oct 2009 16:53:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/usage-of-eclipses-proxy-api/</guid><description>&lt;p>Eclipse platform register an OSGi service &amp;lsquo;IProxyService&amp;rsquo; to manage network connection, which has capability to set proxy setting. There are three types of proxy working mode,&lt;/p>
&lt;ul>
&lt;li>Direct(no proxy),&lt;/li>
&lt;li>Manual(specified by user),&lt;/li>
&lt;li>Native(using OS&amp;rsquo;s proxy setting, such as gnome-proxy, IE).&lt;/li>
&lt;/ul>
&lt;p>There are three types of proxy supported by IProxyService. They&amp;rsquo;re http, https and socks.&lt;/p>
&lt;p>It also allows to add/remove ip address from white list, which are accessed without connecting proxy.&lt;/p>
&lt;p>End users can manage the proxy setting of Eclipse via Preference - General - Network Connections. Eclipse would do persistence of user&amp;rsquo;s setting. Other components of Eclipse also use those proxy settings to access network, such as ECF.&lt;/p>
&lt;p>Below code snippet shows how to use proxy API to manually specify proxy server,&lt;/p>
&lt;p>proxyService.setProxiesEnabled(true);&lt;br>
proxyService.setSystemProxiesEnabled(false); &lt;br>
IProxyData[] datas = proxyService.getProxyData(); &lt;br>
IProxyData proxyData = null; &lt;br>
for(IProxyData data : datas) { &lt;br>
// clean old data &lt;br>
((ProxyData)data).setSource(&amp;ldquo;Manual&amp;rdquo;); //$NON-NLS-1$ &lt;br>
data.setUserid(null); //$NON-NLS-1$ &lt;br>
data.setPassword(null); //$NON-NLS-1$ &lt;br>
if(proxyType == SOCKSPROXY &amp;amp;&amp;amp; IProxyData.SOCKS_PROXY_TYPE.equals(data.getType())) {&lt;br>
proxyData = data; &lt;br>
continue; &lt;br>
}else if(proxyType == WEBPROXY &amp;amp;&amp;amp; IProxyData.HTTP_PROXY_TYPE.equals(data.getType())){&lt;br>
proxyData = data; &lt;br>
continue; &lt;br>
} &lt;br>
data.setHost(null); //$NON-NLS-1$ &lt;br>
data.setPort(0); &lt;br>
} &lt;br>
if(proxyData != null){ &lt;br>
proxyData.setHost(proxyServer); &lt;br>
proxyData.setPort(proxyPort); &lt;br>
} &lt;br>
try { &lt;br>
proxyService.setProxyData(datas); &lt;br>
} catch (CoreException e) { &lt;br>
proxyService.setProxiesEnabled(false); &lt;br>
proxyService.setSystemProxiesEnabled(false); &lt;br>
return false; &lt;br>
}&lt;/p>
&lt;p>&lt;a href="http://help.eclipse.org/galileo/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/core/net/proxy/IProxyService.html">Official API Reference&lt;/a>&lt;/p></description></item><item><title>[tip]Turn off automatically scanning disk when reboot</title><link>https://kane.mx/posts/archive/blogspot/turnoff-automatically-scanning-disk/</link><pubDate>Wed, 11 Feb 2009 17:40:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/turnoff-automatically-scanning-disk/</guid><description>&lt;p>tune2fs -i 0 -c 0 /dev/sdx&lt;/p></description></item><item><title>How to set default input method for GNOME</title><link>https://kane.mx/posts/archive/blogspot/how-to-set-default-input-method-for/</link><pubDate>Mon, 09 Feb 2009 11:24:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/how-to-set-default-input-method-for/</guid><description>&lt;p>add below lines in ~/.gnomerc&lt;/p>
&lt;p>export XMODIFIERS=&amp;quot;@im=fcitx&amp;quot;&lt;br>
export GTK_IM_MODULE=&amp;ldquo;xim&amp;rdquo;&lt;/p></description></item><item><title>[HowTo]How to set up jre environment in firefox</title><link>https://kane.mx/posts/archive/blogspot/how-to-set-up-jre-environment-in/</link><pubDate>Mon, 29 Dec 2008 12:52:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/how-to-set-up-jre-environment-in/</guid><description>&lt;p>create symbol link under lib/plugins of firefox to link jre/plugins/i386/ns**/libjavaplugin_oji.so&lt;/p></description></item><item><title>[Debug][tip]How to ignore specified signal when debugging program via gdb</title><link>https://kane.mx/posts/archive/blogspot/how-to-ignore-specified-signal-when/</link><pubDate>Wed, 10 Dec 2008 15:02:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/how-to-ignore-specified-signal-when/</guid><description>&lt;p>Such as,&lt;br>
(gdb) handle SIGPIPE nostop noprint pass&lt;/p></description></item><item><title>[HowTo][tip]How to adjust the font size of Notes editor</title><link>https://kane.mx/posts/archive/blogspot/how-to-adjust-font-size-of-notes-editor/</link><pubDate>Thu, 04 Dec 2008 13:11:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/how-to-adjust-font-size-of-notes-editor/</guid><description>&lt;p>Close Notes&lt;br>
Double click c:\notes\notes.ini to open it.&lt;br>
Add one new line &amp;ldquo;Display_font_adjustment=n&amp;rdquo; after the third line in notes.ini file. &amp;ldquo;n&amp;rdquo; is the number.It can be 1or 2 or 3&amp;hellip;.and the font will be larger with the number increasing.&lt;br>
Launch note&lt;/p></description></item><item><title>[OSGi][Eclipse]Add custom jar or path into Equinox Framework</title><link>https://kane.mx/posts/archive/blogspot/add-custom-jar-or-path-into-equinox/</link><pubDate>Sun, 28 Sep 2008 13:23:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/add-custom-jar-or-path-into-equinox/</guid><description>&lt;p>Set vm arguments &amp;lsquo;osgi.framework.extensions&amp;rsquo; and &amp;lsquo;osgi.frameworkClassPath&amp;rsquo; when vm starts. If those value are set, those jar or path would be added into the classloader when starting EclipseStarter.&lt;/p>
&lt;p>See org.eclipse.equinox.launcher.Main for more details in the source code of Eclipse 3.4.&lt;br>
Best Regards&lt;br>
Kane&lt;/p></description></item><item><title>[OSGi]How to acquire the fragments of specified bundle</title><link>https://kane.mx/posts/archive/blogspot/osgihow-to-acquire-fragments-of/</link><pubDate>Fri, 01 Aug 2008 16:22:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/osgihow-to-acquire-fragments-of/</guid><description>&lt;p>The answer is very simple, using the service &amp;lsquo;org.eclipse.service.PackageAdmin&amp;rsquo;.&lt;/p></description></item><item><title>[Eclipse]Equinox's classloader and its URL schema</title><link>https://kane.mx/posts/archive/blogspot/eclipseequinoxs-classloader-and-its-url/</link><pubDate>Thu, 17 Jul 2008 17:42:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/eclipseequinoxs-classloader-and-its-url/</guid><description>&lt;p>Equinox uses the adaptor hooks to implement the class loader.&lt;br>
See &lt;a href="http://wiki.eclipse.org/Adaptor_Hooks">http://wiki.eclipse.org/Adaptor_Hooks&lt;/a> for more detail&lt;/p>
&lt;p>BaseClassLoadingHook would search the native code on itself. If it find the file in that jar file, it would extract the native library into its storage folder.&lt;/p>
&lt;p>EclipseClassLoadingHook defines some variables to search the native library. Belows are built-in variables:&lt;/p>
&lt;p>result.add(&amp;ldquo;ws/&amp;rdquo; + info.getWS() + &amp;ldquo;/&amp;quot;); //$NON-NLS-1$ //$NON-NLS-2$&lt;br>
result.add(&amp;ldquo;os/&amp;rdquo; + info.getOS() + &amp;ldquo;/&amp;rdquo; + info.getOSArch() + &amp;ldquo;/&amp;quot;); //$NON-NLS-1$ //$NON-NLS-2$ //$NON-NLS-3$&lt;br>
result.add(&amp;ldquo;os/&amp;rdquo; + info.getOS() + &amp;ldquo;/&amp;quot;); //$NON-NLS-1$ //$NON-NLS-2$&lt;/p>
&lt;p>So the classloader can find your native library that under those path. If your bundle is jar file, equinox would extract your native library into its storage folder.&lt;/p>
&lt;p>I prefer to use OSGi header(Bundle-NativeCode) defining the path of native code, which still works on other OSGi implementations.&lt;/p>
&lt;p>Equinox defines its url schema, one of them is named as &amp;lsquo;BundleURLConnection&amp;rsquo;. From its name, we know it&amp;rsquo;s used for describing the files of bundle. You can obtain the url of file that is located on bundle by Bundle.getResource()/Bundle.getEntry()/Bundle.findEntries()/Bundle.getResources(). The return value of those functions are an object of BundleURLConnection. Once it&amp;rsquo;s used as the argument of FileLocator.toFileURL(URL), the jar bundle would be unpacked into its storage folder recursively.&lt;/p></description></item><item><title>[tip][vim]æ’ç‰ˆå°æŠ€å·§</title><link>https://kane.mx/posts/archive/blogspot/tipvim/</link><pubDate>Tue, 15 Jul 2008 11:00:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/tipvim/</guid><description>&lt;p>Â  Â  1. å°†è¦æ’ç‰ˆçš„æ–‡å­—è´´åˆ°vimäº†&lt;br>
Â  Â  2. Â set textwidth=70&lt;br>
Â  Â  3. visualæ¨¡å¼ä¸‹é€‰æ‹©è¦æ’ç‰ˆçš„æ–‡å­—,æŒ‰gq, å°±å˜æˆ70å­—æ¯1è¡Œçš„æ ¼å¼äº†&lt;/p></description></item><item><title>[tip]convert dos format to unix</title><link>https://kane.mx/posts/archive/blogspot/tipconvert-dos-format-to-unix/</link><pubDate>Fri, 23 May 2008 18:03:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/tipconvert-dos-format-to-unix/</guid><description>&lt;p>In vi/vim,&lt;/p>
&lt;p>ï»¿set file format=unix&lt;/p>
&lt;p>or dos2unix, unix2dos&lt;/p></description></item><item><title>[tip]Makefile</title><link>https://kane.mx/posts/archive/blogspot/makefile-tip/</link><pubDate>Thu, 22 May 2008 20:37:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/makefile-tip/</guid><description>&lt;p>Build c/c++ project always need third party library on linux, such as gtk+, glib. Writing their absolute path in Makefile is not flexible way. You can use pkg-config instead of the absolute path. Below is code snippet:&lt;/p>
&lt;p>GTK_LIB=$(shell pkg-config &amp;ndash;libs gtk+-2.0)&lt;br>
GTK_INC=$(shell pkg-config &amp;ndash;cflags gtk+-2.0)&lt;/p>
&lt;p>gcc -o yourlibrary.so $(GTK_INC) $(GTK_LIB)&lt;/p></description></item><item><title>[OSGi][Equinox]URL Handlers Service</title><link>https://kane.mx/posts/archive/blogspot/url-handlers-service/</link><pubDate>Wed, 16 Apr 2008 14:20:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/url-handlers-service/</guid><description>&lt;p>OSGi provides a mechanism to let user contribute custom schemes automatically. It avoid some restriction with Java facilities for extending the handlers. The more detail could be found from OSGi specification R4, which has description how OSGi implements URL Handler Service.&lt;/p>
&lt;p>Use a sample to illustrate how to contribute your scheme(protocol):&lt;/p>
&lt;p>1. register your URLStreamHandlerService implementation, which must contain a property named &amp;ldquo;url.handler.protocol&amp;rdquo;. below register my scheme &amp;lsquo;smb&amp;rsquo;&lt;br>
public void start(BundleContext context) throws Exception {&lt;br>
Hashtable properties = new Hashtable();&lt;br>
properties.put( URLConstants.URL_HANDLER_PROTOCOL, new String[] { &amp;ldquo;smb&amp;rdquo; } );&lt;br>
context.registerService(URLStreamHandlerService.class.getName(), new SmbURLHandler(), properties );&lt;br>
}&lt;br>
2. your URL Handler extends AbstractURLStreamHandlerService, and implements abstract function &amp;lsquo;openConnection(URL)&amp;rsquo;&lt;br>
public class SmbURLHandler extends AbstractURLStreamHandlerService {&lt;/p>
&lt;p>public URLConnection openConnection(URL url) throws IOException {&lt;br>
return new SmbURLConnection(url);&lt;br>
}&lt;/p>
&lt;p>}&lt;br>
3. your URL Connection extends java.net.URLConnection&lt;br>
public class SmbURLConnection extends URLConnection {&lt;/p>
&lt;p>protected SmbURLConnection(URL url) {&lt;br>
super(url);&lt;br>
}&lt;/p>
&lt;p>public void connect() throws IOException {&lt;br>
}&lt;br>
}&lt;/p></description></item><item><title>[OSGi][Equinox]the Bundle-NativeCode implementation in Equinox</title><link>https://kane.mx/posts/archive/blogspot/bundle-nativecode-implementation-in/</link><pubDate>Mon, 31 Mar 2008 17:36:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/bundle-nativecode-implementation-in/</guid><description>&lt;p>OSGi Spec defines Bundle-NativeCode header to contain a specification of native code libraries contained in that bundle. All magic things are initialized by org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.findLibrary(String) and org.eclipse.osgi.framework.internal.core.BundleLoader.findLibrary(String). Then BundleLoader uses the org.eclipse.osgi.baseadaptor.BaseData(an implementation of BundleData) to find the library path, if the bundle is NOT a jar file, it would directly get the absolute path of library. Otherwise, the BaseData would extract the library file if it could NOT find it in OSGi bundle storage(located in ${data}/org.eclipse.osgi/bundles/[bundle_id]/.cp/). Refer to org.eclipse.osgi.baseadaptor.BaseData.findLibrary(String) for more detail.&lt;/p></description></item><item><title>[shell]Learning Note - 3/19/08</title><link>https://kane.mx/posts/archive/blogspot/linux-shelllearning-note-31908/</link><pubDate>Wed, 19 Mar 2008 14:35:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/linux-shelllearning-note-31908/</guid><description>&lt;p>1&amp;gt; æ˜¯è¾“å‡ºæ­£ç¡®æ•°æ®ï¼Œ 2&amp;gt; åˆ™æ˜¯é”™è¯¯æ•°æ®è¾“å‡ºé¡¹ç›®, è‹¥è¦åŒæ—¶å†™å…¥åŒä¸€ä¸ªæ¡£æ¡ˆéœ€è¦ä½¿ç”¨ 2&amp;gt;&amp;amp;1 /dev/null æ˜¯ä»€ä¹ˆå‘¢ï¼ŸåŸºæœ¬ä¸Šï¼Œé‚£å°±æœ‰ç‚¹åƒæ˜¯ä¸€ä¸ªã€é»‘æ´ã€çš„åƒåœ¾æ¡¶åŠŸèƒ½ï¼å½“ä½ è¾“å…¥çš„ä»»ä½•ä¸œè¥¿å¯¼å‘åˆ°è¿™ä¸ªè™šæ‹Ÿçš„åƒåœ¾æ¡¶è£…ç½®æ—¶ï¼Œã€ä»–å°±ä¼šå‡­ç©ºæ¶ˆå¤±ä¸è§äº†ï½ï½ã€&lt;/p></description></item><item><title>[Eclipse]How to use qualifier string when exporting features and plug-ins</title><link>https://kane.mx/posts/archive/blogspot/how-to-use-qualifier-string-when/</link><pubDate>Tue, 11 Mar 2008 13:30:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/how-to-use-qualifier-string-when/</guid><description>&lt;p>You must see the qualifier string property when exporting your features and plug-ins by Eclipse pde. But specified qualifier string won&amp;rsquo;t appear after you export the features successfully.&lt;/p>
&lt;p>If you want to use the qualifier string, you must define your feature and plug-in version like below:&lt;br>
1.0.0.qualifier, 2.2.2.qaulifier&lt;/p>
&lt;p>:)&lt;/p></description></item><item><title>ä¸‡æ¶çš„æ³¨å†Œè¡¨</title><link>https://kane.mx/posts/archive/blogspot/suck-windows-registry/</link><pubDate>Tue, 03 Apr 2007 13:16:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/suck-windows-registry/</guid><description>&lt;p>æœ€è¿‘å‡ å¤©è¢«ä¸€ä¸ªæ³¨å†Œè¡¨ç›¸å…³çš„defectæçš„ç„¦å¤´çƒ‚é¢ã€‚&lt;/p>
&lt;p>èƒŒæ™¯æ˜¯è¿™æ ·çš„ï¼Œäº§å“åœ¨å®‰è£…çš„æ—¶å€™éœ€è¦é€šè¿‡ä¿®æ”¹æ³¨å†Œè¡¨æ³¨å†Œæ–‡ä»¶å…³è”ç­‰ä¿¡æ¯ã€‚åœ¨å…ˆå‰å®‰è£…ç¨‹åºåŸºäºInstallShieldæ—¶å·¥ä½œæ­£ç¡®ï¼Œä½†åœ¨æœ€è¿‘å®‰è£…ç¨‹åºæ”¹ç”¨MSIåï¼Œæˆ‘ä»¬å†™å…¥æ³¨å†Œè¡¨çš„ä¿¡æ¯æ²¡æœ‰è¢«å†™åˆ°æ‰€æœŸæœ›çš„ä½ç½®ã€‚&lt;/p>
&lt;p>é€šè¿‡å„ç§è¯•éªŒï¼ŒæŸ¥æ‰¾èµ„æ–™ï¼Œç»ˆäºææ˜ç™½åŸå› ã€‚æˆ‘ä»¬ä¿®æ”¹æ³¨å†Œè¡¨çš„è¿›ç¨‹ä¸æ˜¯å½“å‰ç”¨æˆ·è¿›ç¨‹ï¼Œè€Œæ˜¯ç³»ç»Ÿè¿›ç¨‹ï¼Œå› æ­¤å†™å…¥åˆ°HKEY_CURRENT_USERä¸‹çš„æ•°æ®ä¸èƒ½è¢«å†™å…¥åˆ°å½“å‰ç™»é™†ç”¨æˆ·ä¸‹ã€‚&lt;/p>
&lt;p>We should not use &amp;ldquo;&lt;strong>HKEY_CURRENT_USER&amp;rdquo;&lt;/strong> to retrival current user&amp;rsquo;s registry key value. Because Windows Services always startup before user login. It may happen some error or loading the wrong setting profile. If you still insist on using the current user registry key setting, please refer &amp;ldquo;&lt;em>&lt;a href="http://msdn.microsoft.com/library/default.asp?url=https://kane.mx/library/en-us/sysinfo/base/regopencurrentuser.asp">RegOpenCurrentUser&lt;/a>&lt;/em>&amp;rdquo;.&lt;/p>
&lt;p>æœ€ååªå¥½å°†è¿™äº›æ•°æ®å†™åˆ°äº†Local Machineé”®å€¼ä¸‹ã€‚&lt;/p></description></item><item><title>[Eclipse]get rid of the menus of eclipse platform</title><link>https://kane.mx/posts/archive/blogspot/get-rid-of-menus-of-eclipse-platform/</link><pubDate>Fri, 09 Mar 2007 13:46:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/get-rid-of-menus-of-eclipse-platform/</guid><description>&lt;p>When you develop a rich client application base on eclipse framework, and your application require eclipse platform feature, you would find that your application has some menu items contributed by eclipse platform. Those menu items are defined by several plug-ins' implementation of actionSet extention point. In fact Eclipse provides an activity mechanism to suppress the extension points which you don&amp;rsquo;t want to use. However, you must know the identification name of extension points which you want to suppress. It&amp;rsquo;s a hard work to find out all of them from dozens of plugins. so, I wrote a utility function to list all the extension points of specified name.&lt;/p>
&lt;pre>&lt;code> IExtensionRegistry registry = Platform.getExtensionRegistry();
IExtensionPoint extensionPoint = registry.getExtensionPoint(&amp;quot;org.eclipse.ui.actionSets&amp;quot;);
IExtension\[\] extensions = extensionPoint.getExtensions();
for(int i = 0; i &amp;lt; extensions.length; i++){
IConfigurationElement elements\[\] = extensions\[i \].getConfigurationElements();
for(int j = 0; j &amp;lt; elements.length; j++){
String pluginId = elements\[j\].getNamespaceIdentifier();
if(pluginId.indexOf(&amp;quot;org.eclipse&amp;quot;) &amp;gt; -1){ //$NON-NLS-1$
IConfigurationElement\[\] subElements = elements\[j\].getChildren(&amp;quot;action&amp;quot;);
for(int m = 0; m &amp;lt; subElements.length; m++){
System.out.println(&amp;quot;Plugin: &amp;quot; + pluginId + &amp;quot; Id: &amp;quot; +
subElements\[m\].getAttribute(&amp;quot;id&amp;quot;));
}
}
}
}
&lt;/code>&lt;/pre>
&lt;p>and the follow snippet is about the activities of menus of eclipse platform:&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;!-- raw HTML omitted --></description></item><item><title>åŠ è½½jaræ–‡ä»¶é‡Œçš„æœ¬åœ°åº“</title><link>https://kane.mx/posts/archive/blogspot/jar/</link><pubDate>Wed, 24 Jan 2007 14:19:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/jar/</guid><description>&lt;p>javaç¨‹åºå¼€å‘ä¸­ç»å¸¸ç”¨åˆ°JNIè°ƒç”¨æœ¬åœ°library, åŒæ—¶åˆå¸Œæœ›å°†libraryåŒclassæ–‡ä»¶ç¼–è¯‘æˆä¸€ä¸ªjaræ–‡ä»¶ä»¥æ–¹ä¾¿deploy.&lt;/p>
&lt;p>ä½†æ˜¯JDKçš„classloaderä¸æ”¯æŒä»jaræ–‡ä»¶ä¸­åŠ è½½library, ä¸€ä¸ªå˜é€šçš„æ–¹æ³•å°±æ˜¯jaré‡Œçš„libraryä»¥ä¸´æ—¶æ–‡ä»¶çš„æ–¹å¼å†™åˆ°ä¸´æ—¶ç›®å½•æˆ–java.libraryç›®å½•.&lt;/p>
&lt;p>é™„ä¸Šä¸¤ç¯‡æ–‡æ¡£é“¾æ¥ :&lt;/p>
&lt;p>&lt;a href="http://www.javaworld.com.tw/jute/post/view?bid=29&amp;amp;id=173624&amp;amp;tpg=1&amp;amp;ppg=1&amp;amp;sty=1&amp;amp;age=0#173624">&lt;/a>**&lt;a href="http://www.javaworld.com.tw/jute/post/view?bid=29&amp;amp;id=173624&amp;amp;tpg=1&amp;amp;ppg=1&amp;amp;sty=1&amp;amp;age=0#173624">Load Library inside a jar file&lt;/a>&lt;br>
**&lt;/p>
&lt;p>&lt;a href="http://www.javaeye.com/topic/17713" title="å›ºå®šé“¾æ¥ï¼šä½¿ç”¨JNIæ—¶ï¼Œè£…è½½æœ¬åœ°åº“çš„å°æŠ€å·§">ä½¿ç”¨JNIæ—¶ï¼Œè£…è½½æœ¬åœ°åº“çš„å°æŠ€å·§&lt;/a>&lt;/p></description></item><item><title>[Eclipse]Eclipse update support</title><link>https://kane.mx/posts/archive/blogspot/eclipse-update-support/</link><pubDate>Wed, 17 Jan 2007 13:51:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/eclipse-update-support/</guid><description>&lt;p>Those days my work is focus on eclipse&amp;rsquo;s update. Now I understand the general mechanism and meet some issues when using it in development work.&lt;/p>
&lt;p>The update mechanism includes four major types: install, enable, disable and uninstall. And all of those operations can be executed by command line, such as installing a feature can use following line:&lt;br>
-application org.eclipse.update.core.standaloneUpdate -command install -featureId my.feature -version 1.0.0 -from file:/v:/local_updateSite/ -to file:/v:/eclipse/.&lt;br>
The installation process would copy the feature and plugins which are included by the feature to the local site from the update site, then execute the feature&amp;rsquo;s global install handler if it has one.&lt;/p>
&lt;p>Some strange issue occurs when I want to disable a feature.Then I try to disable the feature with command,&lt;br>
-command disable -featureId my.feature -version 1.0.0 -to file:/v:/eclipse/&lt;br>
The output of command means that the command is executed successfully.&lt;br>
But I list the status of features with command line &amp;ldquo;-command listFeatures&amp;rdquo;, the status of my.feature is still enable.&lt;br>
Then I try to uninstall my.feature with command,&lt;br>
-command uninstall -featureId my.feature -version 1.0.0 -to file:/v:/eclipse/&lt;br>
It fails, and the following is the root cause found in log file.&lt;br>
!MESSAGE [Cannot find unconfigured feature my.feature with version 1.0.0]&lt;br>
unconfigured feature means the feature is disabled.&lt;/p>
&lt;p>I posted my question in forum, and one guy told me that it might be a bug of eclipse and advised me to fire a bug for it.&lt;/p></description></item><item><title>[Eclipse]The call sequence between partActivated and menu update</title><link>https://kane.mx/posts/archive/blogspot/call-sequence-between-partactivated-and/</link><pubDate>Thu, 19 Oct 2006 12:42:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/call-sequence-between-partactivated-and/</guid><description>&lt;p>I met a defect that dynamically created menu items disappear after creating a new viewPart. It caused me overtime last Friday. Today I find the root cause.&lt;/p>
&lt;p>The scenario is:&lt;/p>
&lt;ol>
&lt;li>
&lt;p>open first document, the items are shown well&lt;/p>
&lt;/li>
&lt;li>
&lt;p>open another document, the items disappear&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>The requirement is that showing the menu items while current part is document, otherwise hide them.&lt;/p>
&lt;p>So our implementation is:&lt;/p>
&lt;ol>
&lt;li>
&lt;p>when current document part is deactivated, set menu items invisible&lt;/p>
&lt;/li>
&lt;li>
&lt;p>when document part is activated, set menu items visible&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>After debugging, I found that menu items was updated before the part activated listener was notified. Hence the menu is invisible while the parent menu is updated. The resolved solution is that setting menu items visible while part opened listener is notified.&lt;/p></description></item><item><title>[debug][java]Remote debug in Eclipse</title><link>https://kane.mx/posts/archive/blogspot/remote-debug-in-eclipse/</link><pubDate>Wed, 18 Oct 2006 12:53:00 +0800</pubDate><guid>https://kane.mx/posts/archive/blogspot/remote-debug-in-eclipse/</guid><description>&lt;p>I need use remote debug in our project, however just some experience in Weblogic were found from internet. After my investigation, I got some experience about using Eclipse remote debug RCP.&lt;br>
There are two important parameters for jvm. And we must launch remote java app with those two parameters.&lt;br>
-Xdebug //tells jvm starting with debug mode&lt;br>
-Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=1044 //transport=dt_socket represents communication with socket, address=1044 represents that the port number is 1044&lt;br>
Then there are 3 steps in local env:&lt;br>
1.import source code into eclipse&amp;rsquo;s project&lt;br>
2.Debug-Remote Java Application, see attachement as a sample&lt;br>
3.insert breakpoint,&lt;/p>
&lt;p>update:&lt;br>
a simpler way:&lt;br>
-agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=8000&lt;/p></description></item><item><title/><link>https://kane.mx/about/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://kane.mx/about/</guid><description>&lt;h1 id="so-who-am-i">So, Who Am I?&lt;/h1>
&lt;hr>
&lt;p>Iâ€™m the father of three boys. Live in Beijing. Also I&amp;rsquo;m the *uix user, a full stack software engineer, devops and cloud native evangelist.&lt;/p>
&lt;p>Curious about me? Use the social links above to check out my profiles.&lt;/p></description></item></channel></rss>